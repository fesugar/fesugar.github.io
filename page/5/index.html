<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/pace-js@1/themes/blue/pace-theme-minimal.css">
  <script src="//cdn.jsdelivr.net/npm/pace-js@1/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"www.fesugar.com","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"always","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":true,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="个人博客，分享自己的实践脚印的互联网技术以及实际应用的日志|非专业人士；|三线小城市普通打工仔一名；|养家糊口不易~~~~~~">
<meta property="og:type" content="website">
<meta property="og:title" content="佛系糖果的博客">
<meta property="og:url" content="https://www.fesugar.com/page/5/index.html">
<meta property="og:site_name" content="佛系糖果的博客">
<meta property="og:description" content="个人博客，分享自己的实践脚印的互联网技术以及实际应用的日志|非专业人士；|三线小城市普通打工仔一名；|养家糊口不易~~~~~~">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="fesugar">
<meta property="article:tag" content="fesugar">
<meta property="article:tag" content="甜甜糖">
<meta property="article:tag" content="甜甜糖个人博客">
<meta property="article:tag" content="甜甜糖博客">
<meta property="article:tag" content="如何做个人博客网站">
<meta property="article:tag" content="严圣川">
<meta property="article:tag" content="严圣川个人网站">
<meta property="article:tag" content="佛系糖果">
<meta property="article:tag" content="小程序">
<meta property="article:tag" content="多线程c#">
<meta property="article:tag" content=".net">
<meta property="article:tag" content="c语言">
<meta property="article:tag" content="vb">
<meta property="article:tag" content="php">
<meta property="article:tag" content="小程序radio样式">
<meta property="article:tag" content="小程序开发">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://www.fesugar.com/page/5/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>佛系糖果的博客</title>
  


  <script data-pjax>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?c708aaffb3b844ecd872db5ea0e68d8f";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="佛系糖果的博客" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">佛系糖果的博客</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">行到水穷处，坐看云起时</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-knowledge">

    <a href="/categories/%E4%B9%A6%E7%B1%8D%E6%96%87%E6%A1%A3/" rel="section"><i class="fa fa-book fa-fw"></i>知识</a>

  </li>
        <li class="menu-item menu-item-study">

    <a href="/categories/%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/" rel="section"><i class="fa fa-edit fa-fw"></i>学习</a>

  </li>
        <li class="menu-item menu-item-guestbook">

    <a href="/guestbook/" rel="section"><i class="fa fa-comment fa-fw"></i>留言簿</a>

  </li>
        <li class="menu-item menu-item-weiyu">

    <a href="/weiyu/" rel="section"><i class="fa fa-eye fa-fw"></i>微语</a>

  </li>
        <li class="menu-item menu-item-disclaimer">

    <a href="/disclaimer/" rel="section"><i class="fa fa-bell fa-fw"></i>条款声明</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-coffee fa-fw"></i>关于</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <a href="https://github.com/fesugar" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.fesugar.com/zh-CN/2019/08/25/e5-9c-a8word-e6-96-87-e6-a1-a3-e4-b8-ad-e5-bb-ba-e7-ab-8b-e5-b0-8f-e5-9e-8b-e5-ba-94-e7-94-a8-e7-a8-8b-e5-ba-8f.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//cdn.fesugar.com/2019/04/2019-04-04-16060550-150x150.jpg">
      <meta itemprop="name" content="fesugar">
      <meta itemprop="description" content="个人博客，分享自己的实践脚印的互联网技术以及实际应用的日志<br/>|非专业人士；<br/>|三线小城市普通打工仔一名；<br/>|养家糊口不易~<br/>~~~~~">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="佛系糖果的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/zh-CN/2019/08/25/e5-9c-a8word-e6-96-87-e6-a1-a3-e4-b8-ad-e5-bb-ba-e7-ab-8b-e5-b0-8f-e5-9e-8b-e5-ba-94-e7-94-a8-e7-a8-8b-e5-ba-8f.html" class="post-title-link" itemprop="url">在Word文档中建立小型应用程序</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-08-25 09:27:42" itemprop="dateCreated datePublished" datetime="2019-08-25T09:27:42+08:00">2019-08-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-05-10 03:27:05" itemprop="dateModified" datetime="2020-05-10T03:27:05+08:00">2020-05-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%B9%A6%E7%B1%8D%E6%96%87%E6%A1%A3/" itemprop="url" rel="index"><span itemprop="name">书籍文档</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan：</span>
    
    
      <a title="changyan" href="/zh-CN/2019/08/25/e5-9c-a8word-e6-96-87-e6-a1-a3-e4-b8-ad-e5-bb-ba-e7-ab-8b-e5-b0-8f-e5-9e-8b-e5-ba-94-e7-94-a8-e7-a8-8b-e5-ba-8f.html#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://www.fesugar.com/zh-CN/2019/08/25/e5-9c-a8word-e6-96-87-e6-a1-a3-e4-b8-ad-e5-bb-ba-e7-ab-8b-e5-b0-8f-e5-9e-8b-e5-ba-94-e7-94-a8-e7-a8-8b-e5-ba-8f.html" class="cy_cmt_count" data-xid="zh-CN/2019/08/25/e5-9c-a8word-e6-96-87-e6-a1-a3-e4-b8-ad-e5-bb-ba-e7-ab-8b-e5-b0-8f-e5-9e-8b-e5-ba-94-e7-94-a8-e7-a8-8b-e5-ba-8f.html" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>2.6k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>2 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="在Word文档中建立小型应用程序"><a href="#在Word文档中建立小型应用程序" class="headerlink" title="在Word文档中建立小型应用程序"></a>在Word文档中建立小型应用程序</h2><h3 id="实例说明"><a href="#实例说明" class="headerlink" title="实例说明"></a>实例说明</h3><p>使用C#可以向Word文档中添加文本、图片等信息，也可以向Word文档中添加窗体控件，在下面的实例中将会使用C#向Word文档中添加多个窗体控件，从而组合成为一个小型应用程序。实例运行效果如图1所示。</p>
<p><img data-src="https://cdn.fesugar.com/2019/08/082519_0126_Word1.png" alt=""></p>
<p>图1 在Word文档中建立小型应用程序</p>
<h3 id="关键技术"><a href="#关键技术" class="headerlink" title="关键技术"></a>关键技术</h3><p>本实例重点在于向读者介绍使用Controls集合的多个方法，方便的向Word文档中插入Windows控件，在Word文档中建立一个小型的应用程序，下面对本实例用到的关键技术进行详细讲解。 （1）向Word文档中添加TextBox控件 使用Controls集合的AddTextBox方法可以方便的向Word文档中插入文本框控件。AddTextBox的语法格式如下：</p>
<p>public TextBox AddTextBox(Range range, float width, float height, string name);</p>
<p>AddTextBox方法中的参数说明如表1所示。 表1 AddTextBox方法中的参数说明</p>
<p>参数</p>
<p>描述</p>
<p>range</p>
<p>将要插入Windows控件所在的范围</p>
<p>width</p>
<p>插入Windows控件的宽度</p>
<p>height</p>
<p>插入Windows控件的高度</p>
<p>name</p>
<p>插入Windows控件的名称</p>
<p>从AddTextBox的语法格式中可以看到，AddTextBox方法执行后将会向Word文档中添加一个TextBox文本框并返回此TextBox对象的引用。  （2）向Word文档中添加Button按钮 使用Controls集合的AddButton方法可以方便的向Word文档中插入按钮控件。AddButton的语法格式如下：</p>
<p>public Button AddButton(Range range, float width, float height, string name);</p>
<p>AddButton方法中的参数说明如表2所示。 表2 AddButton方法中的参数说明</p>
<p>参数</p>
<p>描述</p>
<p>range</p>
<p>将要插入Windows控件所在的范围</p>
<p>width</p>
<p>插入Windows控件的宽度</p>
<p>height</p>
<p>插入Windows控件的高度</p>
<p>name</p>
<p>插入Windows控件的名称</p>
<p>从AddButton的语法格式中可以看到，AddButton方法执行后将会向Word文档中添加一个Button按钮并返回此Button对象的引用。  （3）向Word文档中添加DataGridView控件 使用Controls集合的AddDataGridView方法可以方便的向Word文档中插入DataGridView控件。AddDataGridView的语法格式如下：</p>
<p>public DataGridView AddDataGridView(Range range, float width, float height, string name);</p>
<p>AddDataGridView方法中的参数说明如表3所示。 表3 AddDataGridView方法中的参数说明</p>
<p>参数</p>
<p>描述</p>
<p>range</p>
<p>将要插入Windows控件所在的范围</p>
<p>width</p>
<p>插入Windows控件的宽度</p>
<p>height</p>
<p>插入Windows控件的高度</p>
<p>name</p>
<p>插入Windows控件的名称</p>
<p>说明：Controls集合中的多个添加控件的方法都会向Word文档中添加控件并返回相应控件对象的引用，通过方法返回的控件对象可以轻松的控制Word文档中的Windows控件。实例中向Word文档添加了多个Windows控件，并在Word文档中创建了一个小型应用程序。</p>
<h3 id="设计过程"><a href="#设计过程" class="headerlink" title="设计过程"></a>设计过程</h3><p>（1）打开Visual Studio 2008开发环境，选择文件菜单中的”新建”/“项目”，此时会弹出”新建项目”窗口，在”新建项目”窗口的”项目类型”中选择”Visual C#”/“Office”，在右侧模板中选择”Word 2003 文档”，并在名称中添写”ApplicationInWord”，并选择项目保存位置，单击确定按钮新建项目。如图2所示。</p>
<p><img data-src="https://cdn.fesugar.com/2019/08/082519_0126_Word2.png" alt="">)<img data-src="https://cdn.fesugar.com/2019/08/082519_0126_Word3.png" alt="">)<img data-src="https://cdn.fesugar.com/2019/08/082519_0126_Word4.png" alt="">)<img data-src="https://cdn.fesugar.com/2019/08/082519_0126_Word5.png" alt="">)<img data-src="https://cdn.fesugar.com/2019/08/082519_0126_Word6.png" alt="">)<img data-src="https://cdn.fesugar.com/2019/08/082519_0126_Word7.png" alt="">)<img data-src="https://cdn.fesugar.com/2019/08/082519_0126_Word8.png" alt="">)<img data-src="https://cdn.fesugar.com/2019/08/082519_0126_Word9.png" alt="">)<img data-src="https://cdn.fesugar.com/2019/08/082519_0126_Word10.png" alt="">)<img data-src="https://cdn.fesugar.com/2019/08/082519_0126_Word11.png" alt="">)<img data-src="https://cdn.fesugar.com/2019/08/082519_0126_Word12.png" alt="">)<img data-src="https://cdn.fesugar.com/2019/08/082519_0126_Word13.png" alt="">)<img data-src="https://cdn.fesugar.com/2019/08/082519_0126_Word14.png" alt=""></p>
<p>图2 在VS2008中创建Word 2003 文档 （2）在打开的Word文档中单击鼠标右键选择”查看代码”，在Startup事件中写入代码如下：</p>
<p>private void ThisDocument_Startup(object sender, System.EventArgs e)<br>{<br>    Word.Range P_Range =                                             //得到文档区域<br>        this.ActiveWindow.Document.Range(ref G_Missing, ref G_Missing);<br>    P_Range.Text = “姓名：    “;                                        //添加文本内容<br>    object P_Range_O = Word.WdCollapseDirection.wdCollapseEnd;                    //创建折叠参数对象<br>    P_Range.Collapse(ref P_Range_O);                                        //折叠Range<br>    G_Txt_Name = this.Controls.AddTextBox(P_Range, 100, 20, “P_Txt_Name”);            //添加控件<br>    P_Range = this.Paragraphs.Add(ref G_Missing).Range;                            //添加段落<br>    P_Range = this.Paragraphs.Add(ref G_Missing).Range;                            //添加段落<br>    P_Range = this.Paragraphs[this.Paragraphs.Count - 1].Range;                        //得到最后一个段落<br>    G_Txt_Age = this.Controls.AddTextBox(P_Range, 100, 20, “P_Txt_Age”);                //添加控件<br>    P_Range = this.Paragraphs[this.Paragraphs.Count - 1].Range;                        //得到最后一个段落<br>    object P_Range_O2 = Word.WdCollapseDirection.wdCollapseStart;                    //创建折叠参数对象<br>    P_Range.Collapse(ref P_Range_O2);                                    //折叠Range<br>    P_Range.Text = “年龄：    “;                                        //添加文本<br>    AddControl();                                                    //向文档中添加控件<br>}</p>
<h3 id="秘笈心法"><a href="#秘笈心法" class="headerlink" title="秘笈心法"></a>秘笈心法</h3><p>心法领悟026：怎样理解折叠Range的概念？ 向Word文档中添加Windows控件或文本内容时，经常会使用Collapse方法折叠Range并向Range中继续添加信息，所谓的折叠Range是指起始位置和结束位置相同的Range对象。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.fesugar.com/zh-CN/2019/08/25/e5-b0-86excel-e6-96-87-e4-bb-b6-e5-b5-8c-e5-85-a5-e5-88-b0winform-e7-aa-97-e4-bd-93-e4-b8-ad.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//cdn.fesugar.com/2019/04/2019-04-04-16060550-150x150.jpg">
      <meta itemprop="name" content="fesugar">
      <meta itemprop="description" content="个人博客，分享自己的实践脚印的互联网技术以及实际应用的日志<br/>|非专业人士；<br/>|三线小城市普通打工仔一名；<br/>|养家糊口不易~<br/>~~~~~">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="佛系糖果的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/zh-CN/2019/08/25/e5-b0-86excel-e6-96-87-e4-bb-b6-e5-b5-8c-e5-85-a5-e5-88-b0winform-e7-aa-97-e4-bd-93-e4-b8-ad.html" class="post-title-link" itemprop="url">将Excel文件嵌入到WinForm窗体中</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-08-25 09:22:39" itemprop="dateCreated datePublished" datetime="2019-08-25T09:22:39+08:00">2019-08-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-05-10 03:27:05" itemprop="dateModified" datetime="2020-05-10T03:27:05+08:00">2020-05-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%B9%A6%E7%B1%8D%E6%96%87%E6%A1%A3/" itemprop="url" rel="index"><span itemprop="name">书籍文档</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan：</span>
    
    
      <a title="changyan" href="/zh-CN/2019/08/25/e5-b0-86excel-e6-96-87-e4-bb-b6-e5-b5-8c-e5-85-a5-e5-88-b0winform-e7-aa-97-e4-bd-93-e4-b8-ad.html#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://www.fesugar.com/zh-CN/2019/08/25/e5-b0-86excel-e6-96-87-e4-bb-b6-e5-b5-8c-e5-85-a5-e5-88-b0winform-e7-aa-97-e4-bd-93-e4-b8-ad.html" class="cy_cmt_count" data-xid="zh-CN/2019/08/25/e5-b0-86excel-e6-96-87-e4-bb-b6-e5-b5-8c-e5-85-a5-e5-88-b0winform-e7-aa-97-e4-bd-93-e4-b8-ad.html" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.1k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="将Excel文件嵌入到WinForm窗体中"><a href="#将Excel文件嵌入到WinForm窗体中" class="headerlink" title="将Excel文件嵌入到WinForm窗体中"></a>将Excel文件嵌入到WinForm窗体中</h2><h3 id="实例说明"><a href="#实例说明" class="headerlink" title="实例说明"></a>实例说明</h3><p>Excel是微软公司提供的用于办公管理的应用软件，它在人们的日常办公应用中经常用到，本实例使用C#代码将Excel文件嵌入到了Windows窗体中，运行本实例，选择菜单栏中的“打开Excel文件”选项，即可将选择的Excel文件显示在Windows窗体中。实例运行效果如图1所示。 <img data-src="https://cdn.fesugar.com/2019/08/2019-08-25-01222150.png" alt=""> 图1 将Excel文件嵌入到WinForm窗体中</p>
<h3 id="关键技术"><a href="#关键技术" class="headerlink" title="关键技术"></a>关键技术</h3><p>本实例实现在Windows窗体中显示Excel文件时，主要用到了WebBrowser控件的Navigate方法，下面对其进行详细讲解。 WebBrowser控件是Windows应用程序中的一种标准控件，它为WebBrowser ActiveX控件提供了托管包装，该托管包装可以使用户在Windows窗体客户端应用程序中显示网页等文件，其Navigate方法用来将指定位置的文档加载到WebBrowser控件中，该方法常用的语法格式如下： public void Navigate(string urlString) 参数说明 urlString：要加载的文档的URL地址。</p>
<h3 id="设计过程"><a href="#设计过程" class="headerlink" title="设计过程"></a>设计过程</h3><p>（1）打开Visual Studio 2008开发环境，新建一个Windows窗体应用程序，命名为ExcelToWinForm。 （2）更改默认窗体Form1的Name属性为Frm_Main，在该窗体中添加一个MenuStrip控件，用来作为窗体的菜单栏；添加一个OpenFileDialog组件，用来显示“打开文件”对话框；添加一个WebBrowser控件，用来显示打开的Excel文件。 （3）程序主要代码如下：</p>
<p>private void 打开Excel文件ToolStripMenuItem_Click(object sender, EventArgs e)<br>{<br>    OpenFileDialog.Filter=”Excel文件|*.xls”;                        //设置打开文件筛选器<br>    OpenFileDialog.Title = “打开Excel文件”;                        //设置打开对话框标题<br>    if (OpenFileDialog.ShowDialog() == DialogResult.OK)                //判断是否选择了文件<br>    {<br>        WBrowser_Excel.Navigate(OpenFileDialog.FileName);            //在窗体中显示Excel文件内容<br>    }<br>}</p>
<h3 id="秘笈心法"><a href="#秘笈心法" class="headerlink" title="秘笈心法"></a>秘笈心法</h3><p>心法领悟027：使用WebBrowser控件轻松的在窗体中浏览网页信息！ WebBrowser控件可以在Windows窗体客户端应用程序中显示网页，使用WebBrowser控件显示网页信息非常方便，只需执行Navigate方法，并在方法参数中加入网址信息字符串即可。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.fesugar.com/zh-CN/2019/08/25/e5-88-9b-e5-bb-baexcel-e6-96-87-e4-bb-b6-e5-b9-b6-e4-bf-9d-e5-ad-98.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//cdn.fesugar.com/2019/04/2019-04-04-16060550-150x150.jpg">
      <meta itemprop="name" content="fesugar">
      <meta itemprop="description" content="个人博客，分享自己的实践脚印的互联网技术以及实际应用的日志<br/>|非专业人士；<br/>|三线小城市普通打工仔一名；<br/>|养家糊口不易~<br/>~~~~~">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="佛系糖果的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/zh-CN/2019/08/25/e5-88-9b-e5-bb-baexcel-e6-96-87-e4-bb-b6-e5-b9-b6-e4-bf-9d-e5-ad-98.html" class="post-title-link" itemprop="url">创建Excel文件并保存</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-08-25 09:21:16" itemprop="dateCreated datePublished" datetime="2019-08-25T09:21:16+08:00">2019-08-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-05-10 03:27:05" itemprop="dateModified" datetime="2020-05-10T03:27:05+08:00">2020-05-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%B9%A6%E7%B1%8D%E6%96%87%E6%A1%A3/" itemprop="url" rel="index"><span itemprop="name">书籍文档</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan：</span>
    
    
      <a title="changyan" href="/zh-CN/2019/08/25/e5-88-9b-e5-bb-baexcel-e6-96-87-e4-bb-b6-e5-b9-b6-e4-bf-9d-e5-ad-98.html#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://www.fesugar.com/zh-CN/2019/08/25/e5-88-9b-e5-bb-baexcel-e6-96-87-e4-bb-b6-e5-b9-b6-e4-bf-9d-e5-ad-98.html" class="cy_cmt_count" data-xid="zh-CN/2019/08/25/e5-88-9b-e5-bb-baexcel-e6-96-87-e4-bb-b6-e5-b9-b6-e4-bf-9d-e5-ad-98.html" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>2.1k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>2 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="创建Excel文件并保存"><a href="#创建Excel文件并保存" class="headerlink" title="创建Excel文件并保存"></a>创建Excel文件并保存</h2><h3 id="实例说明"><a href="#实例说明" class="headerlink" title="实例说明"></a>实例说明</h3><p>本实例通过使用C#语言来实现Excel文件的创建与保存功能，运行本实例，如图1所示，单击“选择”按钮，在弹出的对话框中选择Excel文件的保存位置，然后单击“创建”按钮，即可在计算机的指定位置创建一个Excel文件，如图2所示。 <img data-src="https://cdn.fesugar.com/2019/08/2019-08-25-01205056.png" alt=""> 图1 创建Excel文件并保存 图2 创建完的Excel文件</p>
<h3 id="关键技术"><a href="#关键技术" class="headerlink" title="关键技术"></a>关键技术</h3><p>本实例在创建和保存Excel文件时，分别用到了Excel自动化对象模型的Workbooks对象的Add方法及Workbook对象的SaveCopyAs方法，下面对本实例用到的关键技术进行详细讲解。 （1）Workbooks对象的Add方法 该方法主要用来创建一个新的工作簿，其语法格式如下： Workbook Add([In, Optional] object Template); 参数说明 Template：指定是否添加工作簿，如果为true，表示添加；否则，表示不添加。 返回值：返回Workbook类型，表示一个Excel工作簿。 （2）Workbook对象的SaveCopyAs方法 该方法主要用来将工作簿的副本保存到文件中，但不修改内存中打开的工作簿，其语法格式如下： public virtual void SaveCopyAs(Object Filename) 参数说明 Filename：指定要保存的Excel副本的文件名。</p>
<h3 id="设计过程"><a href="#设计过程" class="headerlink" title="设计过程"></a>设计过程</h3><p>（1）打开Visual Studio 2008开发环境，新建一个Windows窗体应用程序，命名为CreateExcel。 （2）更改默认窗体Form1的Name属性为Frm_Main，在该窗体中添加一个TextBox控件，用来显示选择的Excel文件保存路径；添加两个Button控件，分别用来执行选择Excel文件保存路径操作和创建Excel文件操作。 （3）程序主要代码如下：</p>
<p>private void btn_Create_Click(object sender, EventArgs e)<br>{<br>string P_str_path = txt_Path.Text;                                    //记录路径<br>//创建Excel对象<br>Microsoft.Office.Interop.Excel.Application excel = new Microsoft.Office.Interop.Excel.Application();<br>//添加新工作簿<br>    Microsoft.Office.Interop.Excel.Workbook newWorkBook = excel.Application.Workbooks.Add(true);<br>    object missing = System.Reflection.Missing.Value;                        //获取缺少的object类型值<br>    newWorkBook.Worksheets.Add(missing, missing, missing, missing);                //向Excel文件中增加工作表<br>if (P_str_path.EndsWith(“\&quot;))                                        //判断路径是否\结尾<br>//保存Excel文件<br>        newWorkBook.SaveCopyAs(P_str_path + DateTime.Now.ToString(“yyyyMMddhhmmss”) + “.xls”);<br>else<br>//保存Excel文件<br>        newWorkBook.SaveCopyAs(P_str_path + “\&quot; + DateTime.Now.ToString(“yyyyMMddhhmmss”) + “.xls”);<br>//弹出提示信息<br>MessageBox.Show(“Excel文件创建成功”, “提示”, MessageBoxButtons.OK, MessageBoxIcon.Information);<br>//创建进程对象<br>    System.Diagnostics.Process[] excelProcess = System.Diagnostics.Process.GetProcessesByName(“EXCEL”);<br>    foreach (System.Diagnostics.Process p in excelProcess)<br>        p.Kill();                                                //关闭进程<br>}</p>
<p>说明：（1）本实例在使用Excel对象时，首先需要添加该对象的引用，具体步骤为：选中当前项目，单击鼠标右键，在弹出的快捷菜单中选择“添加引用”选项，弹出“添加引用”对话框，如图3所示，该对话框中选中要引用的Excel动态链接库，这里选择“Microsoft.Office.Interop.Excel 11.0.0.0”，单击“确定”按钮，即可将Excel对象引用添加到程序中。 <img data-src="https://cdn.fesugar.com/2019/08/2019-08-25-0120546.png" alt=""> 图3 “添加引用”对话框 （2在后面的实例中，如果需要对Excel进行操作，则都需要按（1）所讲的步骤添加Excel对象引用，由于添加的步骤是一样的，所以在后面涉及到时将不再赘述。</p>
<h3 id="秘笈心法"><a href="#秘笈心法" class="headerlink" title="秘笈心法"></a>秘笈心法</h3><p>心法领悟028：使用Process类杀死进程。 Process类用来提供对本地和远程进程的访问并使用户能够启动和停止本地系统进程，其Kill方法用来立即停止关联的进程。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.fesugar.com/zh-CN/2019/08/25/e4-b8-baexcel-e5-b7-a5-e4-bd-9c-e7-b0-bf-e8-ae-be-e7-bd-ae-e5-92-8c-e6-b8-85-e9-99-a4-e5-af-86-e7-a0-81.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//cdn.fesugar.com/2019/04/2019-04-04-16060550-150x150.jpg">
      <meta itemprop="name" content="fesugar">
      <meta itemprop="description" content="个人博客，分享自己的实践脚印的互联网技术以及实际应用的日志<br/>|非专业人士；<br/>|三线小城市普通打工仔一名；<br/>|养家糊口不易~<br/>~~~~~">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="佛系糖果的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/zh-CN/2019/08/25/e4-b8-baexcel-e5-b7-a5-e4-bd-9c-e7-b0-bf-e8-ae-be-e7-bd-ae-e5-92-8c-e6-b8-85-e9-99-a4-e5-af-86-e7-a0-81.html" class="post-title-link" itemprop="url">为Excel工作簿设置和清除密码</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-08-25 09:19:40" itemprop="dateCreated datePublished" datetime="2019-08-25T09:19:40+08:00">2019-08-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-05-10 03:27:05" itemprop="dateModified" datetime="2020-05-10T03:27:05+08:00">2020-05-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%B9%A6%E7%B1%8D%E6%96%87%E6%A1%A3/" itemprop="url" rel="index"><span itemprop="name">书籍文档</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan：</span>
    
    
      <a title="changyan" href="/zh-CN/2019/08/25/e4-b8-baexcel-e5-b7-a5-e4-bd-9c-e7-b0-bf-e8-ae-be-e7-bd-ae-e5-92-8c-e6-b8-85-e9-99-a4-e5-af-86-e7-a0-81.html#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://www.fesugar.com/zh-CN/2019/08/25/e4-b8-baexcel-e5-b7-a5-e4-bd-9c-e7-b0-bf-e8-ae-be-e7-bd-ae-e5-92-8c-e6-b8-85-e9-99-a4-e5-af-86-e7-a0-81.html" class="cy_cmt_count" data-xid="zh-CN/2019/08/25/e4-b8-baexcel-e5-b7-a5-e4-bd-9c-e7-b0-bf-e8-ae-be-e7-bd-ae-e5-92-8c-e6-b8-85-e9-99-a4-e5-af-86-e7-a0-81.html" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>2.7k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>2 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="为Excel工作簿设置和清除密码"><a href="#为Excel工作簿设置和清除密码" class="headerlink" title="为Excel工作簿设置和清除密码"></a>为Excel工作簿设置和清除密码</h2><h3 id="实例说明"><a href="#实例说明" class="headerlink" title="实例说明"></a>实例说明</h3><p>本实例通过使用C#语言实现为指定的Excel工作簿设置和清除密码的功能，运行本实例，如图1所示，单击“选择”按钮，在弹出的对话框中选择Excel文件的保存位置，然后单击“设置密码”按钮，弹出“输入——输入密码”对话框，如图2所示，在其中输入密码，单击“确定”按钮，弹出“输入——确认密码”对话框，如图3所示，在其中输入确认密码，单击“确定”按钮，即可为选择的Excel工作簿设置密码；单击“清除密码”按钮，如果Excel工作簿本身没有密码，则自动清除；否则，如果有密码，则弹出如图4所示的“密码”对话框，在其中输入正确的密码，单击“确定”按钮，即可清除该Excel工作簿的密码。 <img data-src="https://cdn.fesugar.com/2019/08/2019-08-25-01183274.png" alt=""> 图1 为Excel工作簿设置和清除密码 <img data-src="https://cdn.fesugar.com/2019/08/2019-08-25-01183637.png" alt=""> 图2 “输入——输入密码”对话框 <img data-src="https://cdn.fesugar.com/2019/08/2019-08-25-01183977.png" alt=""> 图3 “输入——确认密码”对话框 <img data-src="https://cdn.fesugar.com/2019/08/2019-08-25-01184282.png" alt="无标题"> 图4 “密码”对话框</p>
<h3 id="关键技术"><a href="#关键技术" class="headerlink" title="关键技术"></a>关键技术</h3><p>本实例在为Excel工作簿设置和清除密码时，主要用到了Excel自动化对象模型的Workbook对象的Password属性，下面对其进行详细讲解。 Workbook对象的Password属性主要用来获取或设置打开工作簿时必须提供的密码，其语法格式如下： [BrowsableAttribute(false)] public virtual string Password { get; set; } 参数说明 属性值：打开工作簿时必须提供的密码。</p>
<h3 id="设计过程"><a href="#设计过程" class="headerlink" title="设计过程"></a>设计过程</h3><p>（1）打开Visual Studio 2008开发环境，新建一个Windows窗体应用程序，命名为SetAndClearPWD。 （2）更改默认窗体Form1的Name属性为Frm_Main，在该窗体中添加一个TextBox控件，用来显示选择的Excel文件路径；添加3个Button控件，分别用来执行选择Excel文件、为Excel文件设置密码和清除密码操作。 （3）程序主要代码如下： 单击“设置密码”按钮，首先使用Excel对象的Open方法打开Excel工作簿，然后使用Excel对象的InptuBox方法为打开的Excel工作簿输入密码和确认密码，最后通过指定WorkBook对象的Password属性为Excel工作簿设置密码。“设置密码”按钮的Click事件代码如下：</p>
<p>private void btn_Set_Click(object sender, EventArgs e)<br>{<br>//创建Excel对象<br>    Microsoft.Office.Interop.Excel.Application excel = new Microsoft.Office.Interop.Excel.ApplicationClass();<br>    object missing = Missing.Value;                            //获取缺少的object类型值<br>    //打开指定的Excel文件<br>Microsoft.Office.Interop.Excel.Workbook workbook=excel.Application.Workbooks.Open(txt_Path.Text, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing);<br>//记录用户输入的密码<br>string P_str_password = excel.Application.InputBox(“输入密码：”,missing, missing, missing, missing, missing, missing, missing).ToString();<br>//记录用户输入的确认密码<br>    string P_str_confirmPassword = excel.Application.InputBox(“确认密码：”, missing, missing, missing, missing, missing, missing, missing).ToString();<br>    if (P_str_password != P_str_confirmPassword)                    //判断密码与确认密码是否一致<br>    {<br>        MessageBox.Show(“输入的密码不一致！”);<br>    }<br>    else<br>    {<br>        workbook.Password = P_str_password;                    //设置Excel密码<br>        MessageBox.Show(“密码设置成功！”);<br>    }<br>    excel.Application.DisplayAlerts = false;                        //不显示提示对话框<br>    workbook.Save();                                    //保存工作表<br>    workbook.Close(false, missing, missing);                        //关闭工作表<br>}</p>
<p>单击“清除密码”按钮，首先使用Excel对象的Open方法打开Excel工作簿，然后通过指定WorkBook对象的Password属性为空来清除Excel工作簿的密码。“清除密码”按钮的Click事件代码如下：</p>
<p>private void btn_Clear_Click(object sender, EventArgs e)<br>{<br>//创建Excel对象<br>    Microsoft.Office.Interop.Excel.Application excel = new Microsoft.Office.Interop.Excel.ApplicationClass();<br>    object missing = Missing.Value;                            //获取缺少的object类型值<br>    //打开指定的Excel文件<br>    Microsoft.Office.Interop.Excel.Workbook workbook = excel.Application.Workbooks.Open(txt_Path.Text, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing);<br>    workbook.Password = “”;                                //设置Excel密码为空<br>    MessageBox.Show(“密码清除成功！”);<br>    excel.Application.DisplayAlerts = false;                        //不显示提示对话框<br>    workbook.Save();                                    //保存工作表<br>    workbook.Close(false, missing, missing);                        //关闭工作表<br>}</p>
<h3 id="秘笈心法"><a href="#秘笈心法" class="headerlink" title="秘笈心法"></a>秘笈心法</h3><p>心法领悟029：为Excel工作簿设置密码时的注意事项！ 本实例使用了Excel对象的InputBox方法来为Excel工作簿设置密码，如果键入的密码相同，则认为键入的密码正确并更改原来的密码；如果键入的两个密码不同，则认为输入的密码不正确。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.fesugar.com/zh-CN/2019/08/25/e4-b8-ba-e4-b8-80-e4-b8-aaexcel-e6-96-87-e4-bb-b6-e5-88-9b-e5-bb-ba-e5-a4-9a-e4-b8-aa-e5-b7-a5-e4-bd-9c-e8-a1-a8.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//cdn.fesugar.com/2019/04/2019-04-04-16060550-150x150.jpg">
      <meta itemprop="name" content="fesugar">
      <meta itemprop="description" content="个人博客，分享自己的实践脚印的互联网技术以及实际应用的日志<br/>|非专业人士；<br/>|三线小城市普通打工仔一名；<br/>|养家糊口不易~<br/>~~~~~">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="佛系糖果的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/zh-CN/2019/08/25/e4-b8-ba-e4-b8-80-e4-b8-aaexcel-e6-96-87-e4-bb-b6-e5-88-9b-e5-bb-ba-e5-a4-9a-e4-b8-aa-e5-b7-a5-e4-bd-9c-e8-a1-a8.html" class="post-title-link" itemprop="url">为一个Excel文件创建多个工作表</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-08-25 09:17:17" itemprop="dateCreated datePublished" datetime="2019-08-25T09:17:17+08:00">2019-08-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-05-10 03:27:05" itemprop="dateModified" datetime="2020-05-10T03:27:05+08:00">2020-05-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%B9%A6%E7%B1%8D%E6%96%87%E6%A1%A3/" itemprop="url" rel="index"><span itemprop="name">书籍文档</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan：</span>
    
    
      <a title="changyan" href="/zh-CN/2019/08/25/e4-b8-ba-e4-b8-80-e4-b8-aaexcel-e6-96-87-e4-bb-b6-e5-88-9b-e5-bb-ba-e5-a4-9a-e4-b8-aa-e5-b7-a5-e4-bd-9c-e8-a1-a8.html#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://www.fesugar.com/zh-CN/2019/08/25/e4-b8-ba-e4-b8-80-e4-b8-aaexcel-e6-96-87-e4-bb-b6-e5-88-9b-e5-bb-ba-e5-a4-9a-e4-b8-aa-e5-b7-a5-e4-bd-9c-e8-a1-a8.html" class="cy_cmt_count" data-xid="zh-CN/2019/08/25/e4-b8-ba-e4-b8-80-e4-b8-aaexcel-e6-96-87-e4-bb-b6-e5-88-9b-e5-bb-ba-e5-a4-9a-e4-b8-aa-e5-b7-a5-e4-bd-9c-e8-a1-a8.html" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.7k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>2 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="为一个Excel文件创建多个工作表"><a href="#为一个Excel文件创建多个工作表" class="headerlink" title="为一个Excel文件创建多个工作表"></a>为一个Excel文件创建多个工作表</h2><h3 id="实例说明"><a href="#实例说明" class="headerlink" title="实例说明"></a>实例说明</h3><p>本实例演示如何使用C#语言为一个Excel文件创建多个工作表。运行本实例，在窗体的菜单栏中选择“打开Excel文件”选项，即可打开一个Excel文件，并显示在窗体中，如图1所示；选择“创建工作表”选项，即可在指定的Excel文件中创建新的工作表，如图2所示。 <img data-src="https://cdn.fesugar.com/2019/08/2019-08-25-01163624.png" alt=""> 图1 创建工作表前的Excel文件 图2 创建完工作表后的Excel文件</p>
<h3 id="关键技术"><a href="#关键技术" class="headerlink" title="关键技术"></a>关键技术</h3><p>本实例在为一个Excel文件创建多个工作表时，主要用到了Excel自动化对象模型的Worksheets对象的Add方法，下面对其进行详细讲解。 Worksheets对象的Add方法主要用来为指定的工作簿添加工作表，其语法格式如下： object Add([In, Optional] object Before, [In, Optional] object After, [In, Optional] object Count, [In, Optional] object Type); 参数说明 Before：要在其前面添加的工作表。 After：要在其后面添加的工作表。 Count：要添加的工作表数量。 Type：工作表类型。</p>
<h3 id="设计过程"><a href="#设计过程" class="headerlink" title="设计过程"></a>设计过程</h3><p>（1）打开Visual Studio 2008开发环境，新建一个Windows窗体应用程序，命名为CreateMultiSheet。 （2）更改默认窗体Form1的Name属性为Frm_Main，在该窗体中添加一个MenuStrip控件，用来作为窗体的菜单栏，该菜单栏中添加两个子菜单项，分别用来执行打开Excel文件和为Excel文件创建工作表操作。 （3）程序主要代码如下：</p>
<p>private void 创建工作表ToolStripMenuItem_Click(object sender, EventArgs e)<br>{<br>CloseProcess();                                    //关闭Excel进程<br>//创建Excel对象<br>    Microsoft.Office.Interop.Excel.Application excel = new Microsoft.Office.Interop.Excel.Application();<br>    object missing = Missing.Value;                        //获取缺少的object类型值<br>    //打开指定的Excel文件<br>    Microsoft.Office.Interop.Excel.Workbook workbook = excel.Application.Workbooks.Open(M_str_Name, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing);<br>    Microsoft.Office.Interop.Excel.Worksheet newWorksheet = (Microsoft.Office.Interop.Excel.Worksheet)workbook.Worksheets.Add(missing, missing, 1, missing);<br>    MessageBox.Show(“添加工作表成功”, “提示”, MessageBoxButtons.OK, MessageBoxIcon.Information);<br>    excel.Application.DisplayAlerts = false;                    //不显示提示对话框<br>    workbook.Save();                                //保存工作表<br>    workbook.Close(false, missing, missing);                    //关闭工作表<br>    WBrowser_Excel.Navigate(M_str_Name);                    //在窗体中显示Excel文件内容<br>}</p>
<h3 id="秘笈心法"><a href="#秘笈心法" class="headerlink" title="秘笈心法"></a>秘笈心法</h3><p>心法领悟030：如何在程序中打开Excel文件？ 打开Excel文件时，可以使用Workbooks对象的Open方法来实现，该方法的第一个参数为要打开的Excel文件，其他的参数表示Excel的相关设置，实际使用时，直接用Missing.Value的值来表示即可。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.fesugar.com/zh-CN/2019/08/25/e5-88-a0-e9-99-a4excel-e6-96-87-e4-bb-b6-e4-b8-ad-e6-8c-87-e5-ae-9a-e7-9a-84-e5-b7-a5-e4-bd-9c-e8-a1-a8.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//cdn.fesugar.com/2019/04/2019-04-04-16060550-150x150.jpg">
      <meta itemprop="name" content="fesugar">
      <meta itemprop="description" content="个人博客，分享自己的实践脚印的互联网技术以及实际应用的日志<br/>|非专业人士；<br/>|三线小城市普通打工仔一名；<br/>|养家糊口不易~<br/>~~~~~">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="佛系糖果的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/zh-CN/2019/08/25/e5-88-a0-e9-99-a4excel-e6-96-87-e4-bb-b6-e4-b8-ad-e6-8c-87-e5-ae-9a-e7-9a-84-e5-b7-a5-e4-bd-9c-e8-a1-a8.html" class="post-title-link" itemprop="url">删除Excel文件中指定的工作表</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-08-25 09:13:16" itemprop="dateCreated datePublished" datetime="2019-08-25T09:13:16+08:00">2019-08-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-05-10 03:27:05" itemprop="dateModified" datetime="2020-05-10T03:27:05+08:00">2020-05-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%B9%A6%E7%B1%8D%E6%96%87%E6%A1%A3/" itemprop="url" rel="index"><span itemprop="name">书籍文档</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan：</span>
    
    
      <a title="changyan" href="/zh-CN/2019/08/25/e5-88-a0-e9-99-a4excel-e6-96-87-e4-bb-b6-e4-b8-ad-e6-8c-87-e5-ae-9a-e7-9a-84-e5-b7-a5-e4-bd-9c-e8-a1-a8.html#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://www.fesugar.com/zh-CN/2019/08/25/e5-88-a0-e9-99-a4excel-e6-96-87-e4-bb-b6-e4-b8-ad-e6-8c-87-e5-ae-9a-e7-9a-84-e5-b7-a5-e4-bd-9c-e8-a1-a8.html" class="cy_cmt_count" data-xid="zh-CN/2019/08/25/e5-88-a0-e9-99-a4excel-e6-96-87-e4-bb-b6-e4-b8-ad-e6-8c-87-e5-ae-9a-e7-9a-84-e5-b7-a5-e4-bd-9c-e8-a1-a8.html" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>3.2k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>3 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="删除Excel文件中指定的工作表"><a href="#删除Excel文件中指定的工作表" class="headerlink" title="删除Excel文件中指定的工作表"></a>删除Excel文件中指定的工作表</h2><h3 id="实例说明"><a href="#实例说明" class="headerlink" title="实例说明"></a>实例说明</h3><p>本实例演示如何使用C#语言实现删除Excel文件中指定工作表的功能。运行本实例，如图1所示，首先单击“选择”按钮，选择指定的Excel文件，这时程序自动将选中Excel文件所包含的所有工作表名称添加到一个下拉列表中，选择一个工作表名称，单击“删除”按钮，即可删除Excel文件中指定的工作表。 <img data-src="https://cdn.fesugar.com/2019/08/2019-08-25-01123879.png" alt="{1228CA3D-FE68-4BB8-911B-8D6A8AE9C6FB}"> 图1 删除Excel文件中指定的工作表 例如，删除“Book1.xls”工作簿中的Sheet2工作表，其删除前后的效果分别如图2和图3所示。。 <img data-src="https://cdn.fesugar.com/2019/08/2019-08-25-01124465-1.png" alt=""> 图2 删除前的Excel文件 <img data-src="https://cdn.fesugar.com/2019/08/2019-08-25-01124779.png" alt=""> 图3 删除后的Excel文件</p>
<h3 id="关键技术"><a href="#关键技术" class="headerlink" title="关键技术"></a>关键技术</h3><p>本实例在删除Excel文件中指定的工作表时，主要用到了Excel自动化对象模型的Workbook对象的Sheets属性的Delete方法，下面对其进行详细讲解。 Workbook对象的Sheets属性用来获取一个Microsoft.Office.Interop.Excel.Sheets集合，该集合表示工作簿中的所有工作表，该属性的Delete方法用来删除指定的工作表其语法格式如下： void Delete();</p>
<h3 id="设计过程"><a href="#设计过程" class="headerlink" title="设计过程"></a>设计过程</h3><p>（1）打开Visual Studio 2008开发环境，新建一个Windows窗体应用程序，命名为DeleteSheet。 （2）更改默认窗体Form1的Name属性为Frm_Main，在该窗体中添加一个TextBox控件，用来显示选择的Excel文件路径；添加一个ComboBox控件，用来显示指定Excel文件中的所有工作表名称；添加两个Button控件，分别用来执行打开Excel文件和删除Excel文件中指定工作表的操作。 （3）程序主要代码如下： private void btn_Delete_Click(object sender, EventArgs e) { //创建Excel对象 Microsoft.Office.Interop.Excel.Application excel = new Microsoft.Office.Interop.Excel.ApplicationClass(); object missing = Missing.Value; //获取缺少的object类型值 //打开指定的Excel文件 Microsoft.Office.Interop.Excel.Workbook workbook = excel.Application.Workbooks.Open(txt_Path.Text, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing); //删除选择的工作表 ((Microsoft.Office.Interop.Excel.Worksheet)workbook.Sheets[cbox_SheetName.Text]).Delete(); MessageBox.Show(“工作表删除成功！”); excel.Application.DisplayAlerts = false; //不显示提示对话框 workbook.Save(); //保存工作表 CBoxBind(); //对下拉列表进行数据绑定 //创建进程对象 System.Diagnostics.Process[] excelProcess = System.Diagnostics.Process.GetProcessesByName(“EXCEL”); foreach (System.Diagnostics.Process p in excelProcess) p.Kill(); //关闭进程 }</p>
<h3 id="秘笈心法"><a href="#秘笈心法" class="headerlink" title="秘笈心法"></a>秘笈心法</h3><p>心法领悟031：如何在保存Excel时不显示提示对话框？ 如果要在保存Excel时不显示提示对话框，可以通过设置Excel对象的DisplayAlerts属性为false来实现。</p>
<h2 id="删除Excel文件中指定的工作表-1"><a href="#删除Excel文件中指定的工作表-1" class="headerlink" title="删除Excel文件中指定的工作表"></a>删除Excel文件中指定的工作表</h2><h3 id="实例说明-1"><a href="#实例说明-1" class="headerlink" title="实例说明"></a>实例说明</h3><p>本实例演示如何使用C#语言实现删除Excel文件中指定工作表的功能。运行本实例，如图1所示，首先单击“选择”按钮，选择指定的Excel文件，这时程序自动将选中Excel文件所包含的所有工作表名称添加到一个下拉列表中，选择一个工作表名称，单击“删除”按钮，即可删除Excel文件中指定的工作表。 <img data-src="https://cdn.fesugar.com/2019/08/2019-08-25-01123884.png" alt="{1228CA3D-FE68-4BB8-911B-8D6A8AE9C6FB}"> 图1 删除Excel文件中指定的工作表 例如，删除“Book1.xls”工作簿中的Sheet2工作表，其删除前后的效果分别如图2和图3所示。。 <img data-src="https://cdn.fesugar.com/2019/08/2019-08-25-01124465.png" alt=""> 图2 删除前的Excel文件 <img data-src="https://cdn.fesugar.com/2019/08/2019-08-25-01124884.png" alt=""> 图3 删除后的Excel文件</p>
<h3 id="关键技术-1"><a href="#关键技术-1" class="headerlink" title="关键技术"></a>关键技术</h3><p>本实例在删除Excel文件中指定的工作表时，主要用到了Excel自动化对象模型的Workbook对象的Sheets属性的Delete方法，下面对其进行详细讲解。 Workbook对象的Sheets属性用来获取一个Microsoft.Office.Interop.Excel.Sheets集合，该集合表示工作簿中的所有工作表，该属性的Delete方法用来删除指定的工作表其语法格式如下： void Delete();</p>
<h3 id="设计过程-1"><a href="#设计过程-1" class="headerlink" title="设计过程"></a>设计过程</h3><p>（1）打开Visual Studio 2008开发环境，新建一个Windows窗体应用程序，命名为DeleteSheet。 （2）更改默认窗体Form1的Name属性为Frm_Main，在该窗体中添加一个TextBox控件，用来显示选择的Excel文件路径；添加一个ComboBox控件，用来显示指定Excel文件中的所有工作表名称；添加两个Button控件，分别用来执行打开Excel文件和删除Excel文件中指定工作表的操作。 （3）程序主要代码如下：</p>
<p>private void btn_Delete_Click(object sender, EventArgs e)<br>{<br>//创建Excel对象<br>    Microsoft.Office.Interop.Excel.Application excel = new Microsoft.Office.Interop.Excel.ApplicationClass();<br>    object missing = Missing.Value;                        //获取缺少的object类型值<br>    //打开指定的Excel文件<br>Microsoft.Office.Interop.Excel.Workbook workbook = excel.Application.Workbooks.Open(txt_Path.Text, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing);<br>//删除选择的工作表<br>    ((Microsoft.Office.Interop.Excel.Worksheet)workbook.Sheets[cbox_SheetName.Text]).Delete();<br>    MessageBox.Show(“工作表删除成功！”);<br>    excel.Application.DisplayAlerts = false;                    //不显示提示对话框<br>    workbook.Save();                                //保存工作表<br>CBoxBind();                                    //对下拉列表进行数据绑定<br>//创建进程对象<br>    System.Diagnostics.Process[] excelProcess = System.Diagnostics.Process.GetProcessesByName(“EXCEL”);<br>    foreach (System.Diagnostics.Process p in excelProcess)<br>        p.Kill();                                    //关闭进程<br>}</p>
<h3 id="秘笈心法-1"><a href="#秘笈心法-1" class="headerlink" title="秘笈心法"></a>秘笈心法</h3><p>心法领悟031：如何在保存Excel时不显示提示对话框？ 如果要在保存Excel时不显示提示对话框，可以通过设置Excel对象的DisplayAlerts属性为false来实现。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.fesugar.com/zh-CN/2019/08/25/e5-b0-86-e6-96-87-e6-9c-ac-e6-96-87-e4-bb-b6-e6-95-b0-e6-8d-ae-e5-88-86-e8-a7-a3-e5-88-b0excel-e4-b8-ad-e7-9a-84-e4-b8-8d-e5-90-8c-e6-95-b0-e6-8d-ae-e8-a1-a8.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//cdn.fesugar.com/2019/04/2019-04-04-16060550-150x150.jpg">
      <meta itemprop="name" content="fesugar">
      <meta itemprop="description" content="个人博客，分享自己的实践脚印的互联网技术以及实际应用的日志<br/>|非专业人士；<br/>|三线小城市普通打工仔一名；<br/>|养家糊口不易~<br/>~~~~~">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="佛系糖果的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/zh-CN/2019/08/25/e5-b0-86-e6-96-87-e6-9c-ac-e6-96-87-e4-bb-b6-e6-95-b0-e6-8d-ae-e5-88-86-e8-a7-a3-e5-88-b0excel-e4-b8-ad-e7-9a-84-e4-b8-8d-e5-90-8c-e6-95-b0-e6-8d-ae-e8-a1-a8.html" class="post-title-link" itemprop="url">将文本文件数据分解到Excel中的不同数据表</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-08-25 08:56:21" itemprop="dateCreated datePublished" datetime="2019-08-25T08:56:21+08:00">2019-08-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-05-10 03:27:05" itemprop="dateModified" datetime="2020-05-10T03:27:05+08:00">2020-05-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%B9%A6%E7%B1%8D%E6%96%87%E6%A1%A3/" itemprop="url" rel="index"><span itemprop="name">书籍文档</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan：</span>
    
    
      <a title="changyan" href="/zh-CN/2019/08/25/e5-b0-86-e6-96-87-e6-9c-ac-e6-96-87-e4-bb-b6-e6-95-b0-e6-8d-ae-e5-88-86-e8-a7-a3-e5-88-b0excel-e4-b8-ad-e7-9a-84-e4-b8-8d-e5-90-8c-e6-95-b0-e6-8d-ae-e8-a1-a8.html#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://www.fesugar.com/zh-CN/2019/08/25/e5-b0-86-e6-96-87-e6-9c-ac-e6-96-87-e4-bb-b6-e6-95-b0-e6-8d-ae-e5-88-86-e8-a7-a3-e5-88-b0excel-e4-b8-ad-e7-9a-84-e4-b8-8d-e5-90-8c-e6-95-b0-e6-8d-ae-e8-a1-a8.html" class="cy_cmt_count" data-xid="zh-CN/2019/08/25/e5-b0-86-e6-96-87-e6-9c-ac-e6-96-87-e4-bb-b6-e6-95-b0-e6-8d-ae-e5-88-86-e8-a7-a3-e5-88-b0excel-e4-b8-ad-e7-9a-84-e4-b8-8d-e5-90-8c-e6-95-b0-e6-8d-ae-e8-a1-a8.html" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>2.1k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>2 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="将文本文件数据分解到Excel中的不同数据表"><a href="#将文本文件数据分解到Excel中的不同数据表" class="headerlink" title="将文本文件数据分解到Excel中的不同数据表"></a>将文本文件数据分解到Excel中的不同数据表</h2><h3 id="实例说明"><a href="#实例说明" class="headerlink" title="实例说明"></a>实例说明</h3><p>本实例使用C#代码实现了将文本文件中的内容分解到Excel中不同数据表的功能。运行本实例，如图1所示，单击第一个“选择”按钮，选择要读取的文本文件；单击第二个“选择”按钮，选择Excel文件；然后单击“读取”按钮，将文本文件中的数分解到Excel文件的不同数据表中；单击“查看”按钮，查看分解完数据之后的Excel文件。 <img data-src="https://cdn.fesugar.com/2019/08/2019-08-25-00551033.png" alt=""> 图1 将文本文件数据分解到Excel中的不同数据表 例如，将如图2所示的文本文件内容分解到Excel文件的不同数据表中，则分解之后的Excel文件如图3所示。 <img data-src="https://cdn.fesugar.com/2019/08/2019-08-25-00551594.png" alt=""> 图2 文本文件数据 图3 分解之后的Excel文件</p>
<h3 id="关键技术"><a href="#关键技术" class="headerlink" title="关键技术"></a>关键技术</h3><p>本实例在将文本文件的内容分解到Excel中的不同数据表中时，首先需要使用StreamReader类的ReadLine方法依次读取文本文件中的内容，然后使用Excel自动化对象模型的Worksheets对象的Add方法添加多个工作表，最后通过Excel自动化对象模型的Excel对象的Cells属性为工作表的单元格设置值。</p>
<h3 id="设计过程"><a href="#设计过程" class="headerlink" title="设计过程"></a>设计过程</h3><p>（1）打开Visual Studio 2008开发环境，新建一个Windows窗体应用程序，命名为TxtToMulSheets。 （2）更改默认窗体Form1的Name属性为Frm_Main，在该窗体中添加两个TextBox控件，分别用来显示选择的文本文件路径和Excel文件路径；添加4个Button控件，分别用来执行选择文本文件、选择Excel文件、将文本文件中数据导入到Excel文件中的不同工作表和查看Excel文件操作。 （3）程序主要代码如下：</p>
<p>private void btn_Read_Click(object sender, EventArgs e)<br>{<br>    int P_int_Count = 0;                                        //记录正在读取的行数<br>    string P_str_Line, P_str_Content = “”;                            //记录读取行的内容及遍历到的内容<br>    List<string> P_str_List = new List<string>();                        //存储读取的所有内容<br>    StreamReader SReader = new StreamReader(txt_Txt.Text, Encoding.Default);        //创建流读取对象<br>    while ((P_str_Line = SReader.ReadLine()) != null)                        //循环读取文本文件中的每一行<br>    {<br>        P_str_List.Add(P_str_Line);                                //将读取到的行内容添加到泛型集合中<br>        P_int_Count++;                                        //使当前读取行数加1<br>}<br>//创建Excel对象<br>    Microsoft.Office.Interop.Excel.Application excel = new Microsoft.Office.Interop.Excel.Application();<br>    object missing = System.Reflection.Missing.Value;                    //获取缺少的object类型值<br>    //打开指定的Excel文件<br>    Microsoft.Office.Interop.Excel.Workbook workbook = excel.Application.Workbooks.Open(txt_Excel.Text, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing);<br>    Microsoft.Office.Interop.Excel.Worksheet newWorksheet;                //声明工作表对象<br>    for (int i = 0; i &lt; P_str_List.Count; i++)                            //遍历泛型集合<br>    {<br>        P_str_Content = P_str_List[i];                                //记录遍历到的值<br>//创建新工作表<br>        newWorksheet = (Microsoft.Office.Interop.Excel.Worksheet)workbook.Worksheets.Add(missing, missing, missing, missing);<br>        newWorksheet.Cells[1, 1] = P_str_Content;                        //直接将遍历到的内容添加到工作表中<br>    }<br>    excel.Application.DisplayAlerts = false;                            //不显示提示对话框<br>    workbook.Save();                                        //保存工作表<br>    workbook.Close(false, missing, missing);                            //关闭工作表<br>    MessageBox.Show(“已经将文本文件的内容分解到了Excel的不同数据表中！”, “提示”, MessageBoxButtons.OK, MessageBoxIcon.Information);<br>}</p>
<h3 id="秘笈心法"><a href="#秘笈心法" class="headerlink" title="秘笈心法"></a>秘笈心法</h3><p>心法领悟033：合理使用StreamReader对象的ReadToEnd方法！ 使用StreamReader对象的ReadToEnd方法可以方便的一次性全部读取出文本文件的所有文本信息，适当的使用此方法会使文件操作更加便捷。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.fesugar.com/zh-CN/2019/08/14/e5-b0-86excel-e6-95-b0-e6-8d-ae-e5-88-86-e8-a7-a3-e5-88-b0-e5-a4-9a-e4-b8-aa-e6-96-87-e6-9c-ac-e6-96-87-e4-bb-b6.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//cdn.fesugar.com/2019/04/2019-04-04-16060550-150x150.jpg">
      <meta itemprop="name" content="fesugar">
      <meta itemprop="description" content="个人博客，分享自己的实践脚印的互联网技术以及实际应用的日志<br/>|非专业人士；<br/>|三线小城市普通打工仔一名；<br/>|养家糊口不易~<br/>~~~~~">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="佛系糖果的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/zh-CN/2019/08/14/e5-b0-86excel-e6-95-b0-e6-8d-ae-e5-88-86-e8-a7-a3-e5-88-b0-e5-a4-9a-e4-b8-aa-e6-96-87-e6-9c-ac-e6-96-87-e4-bb-b6.html" class="post-title-link" itemprop="url">将Excel数据分解到多个文本文件</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-08-14 21:18:25" itemprop="dateCreated datePublished" datetime="2019-08-14T21:18:25+08:00">2019-08-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-05-10 03:27:05" itemprop="dateModified" datetime="2020-05-10T03:27:05+08:00">2020-05-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%B9%A6%E7%B1%8D%E6%96%87%E6%A1%A3/" itemprop="url" rel="index"><span itemprop="name">书籍文档</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan：</span>
    
    
      <a title="changyan" href="/zh-CN/2019/08/14/e5-b0-86excel-e6-95-b0-e6-8d-ae-e5-88-86-e8-a7-a3-e5-88-b0-e5-a4-9a-e4-b8-aa-e6-96-87-e6-9c-ac-e6-96-87-e4-bb-b6.html#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://www.fesugar.com/zh-CN/2019/08/14/e5-b0-86excel-e6-95-b0-e6-8d-ae-e5-88-86-e8-a7-a3-e5-88-b0-e5-a4-9a-e4-b8-aa-e6-96-87-e6-9c-ac-e6-96-87-e4-bb-b6.html" class="cy_cmt_count" data-xid="zh-CN/2019/08/14/e5-b0-86excel-e6-95-b0-e6-8d-ae-e5-88-86-e8-a7-a3-e5-88-b0-e5-a4-9a-e4-b8-aa-e6-96-87-e6-9c-ac-e6-96-87-e4-bb-b6.html" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.6k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="将Excel数据分解到多个文本文件"><a href="#将Excel数据分解到多个文本文件" class="headerlink" title="将Excel数据分解到多个文本文件"></a>将Excel数据分解到多个文本文件</h2><h3 id="实例说明"><a href="#实例说明" class="headerlink" title="实例说明"></a>实例说明</h3><p>本实例使用C#代码实现了将Excel文件中的数据分解到多个文本文件中的功能。运行本实例，如图1所示，单击“选择”按钮，选择要分解的Excel文件；然后在下拉列表中分别选择要分解的工作表和要分解的文本文件个数，单击“导出到文本文件”按钮，将Excel文件中指定工作表的内容分解到指定个数的文本文件中，如图2所示。 <img data-src="https://cdn.fesugar.com/2019/08/2019-08-14-10184115.png" alt=""> 图1 将Excel数据分解到多个文本文件 图2 分解之后的文本文件</p>
<h3 id="关键技术"><a href="#关键技术" class="headerlink" title="关键技术"></a>关键技术</h3><p>本实例在将Excel中的数据分解到多个文本文件时，首先需要循环读取出Excel文件中的内容，然后根据要分解的文本文件个数，使用StreamWriter类的Write方法向各个文件中写入不同的内容即可。 说明：关于StreamWriter类的Write方法的详细讲解，请参见实例“读取Excel指定表数据到文本文件”中的关键技术。</p>
<h3 id="设计过程"><a href="#设计过程" class="headerlink" title="设计过程"></a>设计过程</h3><p>（1）打开Visual Studio 2008开发环境，新建一个Windows窗体应用程序，命名为ExcelToMultiTxt。 （2）更改默认窗体Form1的Name属性为Frm_Main，在该窗体中添加一个TextBox控件，用来显示选择的Excel文件；添加两个ComboBox控件，分别用来显示指定Excel文件中的所有工作表名称和要分解为的文本文件个数；添加两个Button控件，分别用来执行选择Excel文件操作和将Excel文件中指定表的数据分解到多个文本文件的操作。 （3）程序主要代码如下：</p>
<p>//将Excel数据分解到多个文本文件中<br>private void WriteContent()<br>{<br>    int P_int_Counts = CBoxShowCount().Tables[0].Rows.Count;                    //获取记录总数<br>    int P_int_Page = Convert.ToInt32(cbox_Count.Text);                        //记录要分解为几个文件<br>    int P_int_PageRow = Convert.ToInt32(P_int_Counts / P_int_Page);                //记录每个文件的记录数<br>    for (int i = 0; i &lt; P_int_Page; i++)                                    //循环访问每个文件<br>{<br>//创建写入流对象<br>        using (StreamWriter SWriter = new StreamWriter(cbox_SheetName.Text + i + “.txt”, false, Encoding.Default))<br>        {<br>            string P_str_Content = “”;                                    //存储读取的内容<br>            for (int r = i * P_int_PageRow; r &lt; (i + 1) * P_int_PageRow; r++)            //遍历数据集中表的行数<br>            {<br>                if (r &lt; P_int_Counts)                                    //判断遍历到的行数是否小于总行数<br>                {<br>//遍历数据集中表的列数<br>                    for (int c = 0; c &lt; CBoxShowCount().Tables[0].Columns.Count; c++)<br>                    {<br>//记录当前遍历到的内容<br>                        P_str_Content += CBoxShowCount().Tables[0].Rows[r][c].ToString() + “  “;<br>                    }<br>                    P_str_Content += Environment.NewLine;                    //字符串换行<br>                }<br>            }<br>            SWriter.Write(P_str_Content);                                //先文本文件中写入内容<br>            SWriter.Close();                                        //关闭写入流对象<br>        }<br>    }<br>}</p>
<h3 id="秘笈心法"><a href="#秘笈心法" class="headerlink" title="秘笈心法"></a>秘笈心法</h3><p>心法领悟040：轻松回收StreamWriter对象资源！ 程序设计过程中，可以手动调用StreamWriter对象的Close方法回收文件资源，但是使用using关键字则更为简洁友好。当using关键字下面的代码执行完毕后，将会自动将using小括号中创建的StreamWriter对象隐式转换为IDisposable接口类型，并调用接口方法Dispose释放对象资源。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.fesugar.com/zh-CN/2019/08/14/e5-b0-86sql-server-e6-95-b0-e6-8d-ae-e6-9f-a5-e8-af-a2-e7-bb-93-e6-9e-9c-e8-be-93-e5-87-ba-e5-88-b0excel.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//cdn.fesugar.com/2019/04/2019-04-04-16060550-150x150.jpg">
      <meta itemprop="name" content="fesugar">
      <meta itemprop="description" content="个人博客，分享自己的实践脚印的互联网技术以及实际应用的日志<br/>|非专业人士；<br/>|三线小城市普通打工仔一名；<br/>|养家糊口不易~<br/>~~~~~">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="佛系糖果的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/zh-CN/2019/08/14/e5-b0-86sql-server-e6-95-b0-e6-8d-ae-e6-9f-a5-e8-af-a2-e7-bb-93-e6-9e-9c-e8-be-93-e5-87-ba-e5-88-b0excel.html" class="post-title-link" itemprop="url">将Sql Server数据查询结果输出到Excel</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-08-14 19:07:54" itemprop="dateCreated datePublished" datetime="2019-08-14T19:07:54+08:00">2019-08-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-05-10 03:27:05" itemprop="dateModified" datetime="2020-05-10T03:27:05+08:00">2020-05-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%B9%A6%E7%B1%8D%E6%96%87%E6%A1%A3/" itemprop="url" rel="index"><span itemprop="name">书籍文档</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan：</span>
    
    
      <a title="changyan" href="/zh-CN/2019/08/14/e5-b0-86sql-server-e6-95-b0-e6-8d-ae-e6-9f-a5-e8-af-a2-e7-bb-93-e6-9e-9c-e8-be-93-e5-87-ba-e5-88-b0excel.html#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://www.fesugar.com/zh-CN/2019/08/14/e5-b0-86sql-server-e6-95-b0-e6-8d-ae-e6-9f-a5-e8-af-a2-e7-bb-93-e6-9e-9c-e8-be-93-e5-87-ba-e5-88-b0excel.html" class="cy_cmt_count" data-xid="zh-CN/2019/08/14/e5-b0-86sql-server-e6-95-b0-e6-8d-ae-e6-9f-a5-e8-af-a2-e7-bb-93-e6-9e-9c-e8-be-93-e5-87-ba-e5-88-b0excel.html" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.5k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><strong>将Sql Server数据查询结果输出到Excel</strong></p>
<p>实例说明</p>
<p>本实例使用C#代码实现了将Sql Server数据查询结果输出到Excel的功能。运行本实例，如图1所示，首先选择查询条件，并输入查询关键字，单击”查询”按钮，在Sql Server数据库中执行查询，并将查询结果显示在数据表格控件中；然后单击”导出Excel”按钮，将数据表格控件中的查询结果输出到Excel文件中。</p>
<p><img data-src="https://cdn.fesugar.com/2019/08/081419_1107_SqlServer1.png" alt=""></p>
<p>图1 将Sql Server数据查询结果输出到Excel</p>
<p>例如，在如图2所示的Sql Server数据库中查询性别为”男”的数据，并将查询之后的数据输出到Excel文件中，则输入之后的Excel文件如图3所示。</p>
<p><img data-src="https://cdn.fesugar.com/2019/08/081419_1107_SqlServer2.png" alt=""></p>
<p>图2 Sql Server数据库中的数据</p>
<p><img data-src="https://cdn.fesugar.com/2019/08/081419_1107_SqlServer3.png" alt=""></p>
<p>图3 输入数据之后的Excel文件</p>
<p>关键技术</p>
<p>本实例在将Sql Server数据库的查询结果输出到Excel时，首先需要将Sql Server数据库的查询结果显示在DataGridView控件中，然后遍历DataGridView控件中的数据，并通过设置Excel对象的Cells属性来将遍历到的值填充到Excel的单元格中。</p>
<p>设计过程</p>
<p>（1）打开Visual Studio 2008开发环境，新建一个Windows窗体应用程序，命名为SqlToExcel。</p>
<p>（2）更改默认窗体Form1的Name属性为Frm_Main，在该窗体中添加一个ComboBox控件，用来选择查询条件；添加一个TextBox控件，用来输入查询关键字；添加一个DataGridView控件，用来显示Sql Server数据库中的数据；添加两个Button控件，分别用来执行数据库查询和将数据库查询结果输出到Excel文件中的操作。</p>
<p>（3）程序主要代码如下：</p>
<p>private void btn_Excel_Click(object sender, EventArgs e)<br>{<br>    if (dgv_Info.Rows.Count == 0)                                //判断是否有数据<br>        return;                                            //返回<br>//创建Excel对象<br>    Microsoft.Office.Interop.Excel.Application excel = new Microsoft.Office.Interop.Excel.Application();<br>    excel.Application.Workbooks.Add(true);                            //在Excel中添加一个工作簿<br>    excel.Visible = true;                                        //设置Excel显示<br>    //生成字段名称<br>    for (int i = 0; i &lt; dgv_Info.ColumnCount; i++)<br>    {<br>        excel.Cells[1, i + 1] = dgv_Info.Columns[i].HeaderText;                //将数据表格控件中的列表头填充到Excel中<br>    }<br>    //填充数据<br>    for (int i = 0; i &lt; dgv_Info.RowCount - 1; i++)                        //遍历数据表格控件的所有行<br>    {<br>        for (int j = 0; j &lt; dgv_Info.ColumnCount; j++)                    //遍历数据表格控件的所有列<br>        {<br>            if (dgv_Info[j, i].ValueType == typeof(string))                    //判断遍历到的数据是否是字符串类型<br>            {<br>                excel.Cells[i + 2, j + 1] = “‘“ + dgv_Info[j, i].Value.ToString();        //填充Excel表格<br>            }<br>            else<br>            {<br>                excel.Cells[i + 2, j + 1] = dgv_Info[j, i].Value.ToString();        //填充Excel表格<br>            }<br>        }<br>    }<br>}</p>
<p>秘笈心法</p>
<p>心法领悟036：如何连接Sql Server数据库？</p>
<p>C#中连接Sql Server数据库时，需要使用SqlConnection类，该类位于System.Data.SqlClient命名空间下。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.fesugar.com/zh-CN/2019/08/14/e5-ae-9e-e6-97-b6-e8-af-bb-e5-8f-96-e4-b8-8d-e5-90-8c-e6-95-b0-e6-8d-ae-e5-88-b0excel-e8-bf-9b-e8-a1-8c-e6-b1-87-e6-80-bb-e5-a4-84-e7-90-86.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//cdn.fesugar.com/2019/04/2019-04-04-16060550-150x150.jpg">
      <meta itemprop="name" content="fesugar">
      <meta itemprop="description" content="个人博客，分享自己的实践脚印的互联网技术以及实际应用的日志<br/>|非专业人士；<br/>|三线小城市普通打工仔一名；<br/>|养家糊口不易~<br/>~~~~~">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="佛系糖果的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/zh-CN/2019/08/14/e5-ae-9e-e6-97-b6-e8-af-bb-e5-8f-96-e4-b8-8d-e5-90-8c-e6-95-b0-e6-8d-ae-e5-88-b0excel-e8-bf-9b-e8-a1-8c-e6-b1-87-e6-80-bb-e5-a4-84-e7-90-86.html" class="post-title-link" itemprop="url">实时读取不同数据到Excel进行汇总处理</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-08-14 19:03:07" itemprop="dateCreated datePublished" datetime="2019-08-14T19:03:07+08:00">2019-08-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-05-10 03:27:05" itemprop="dateModified" datetime="2020-05-10T03:27:05+08:00">2020-05-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%B9%A6%E7%B1%8D%E6%96%87%E6%A1%A3/" itemprop="url" rel="index"><span itemprop="name">书籍文档</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan：</span>
    
    
      <a title="changyan" href="/zh-CN/2019/08/14/e5-ae-9e-e6-97-b6-e8-af-bb-e5-8f-96-e4-b8-8d-e5-90-8c-e6-95-b0-e6-8d-ae-e5-88-b0excel-e8-bf-9b-e8-a1-8c-e6-b1-87-e6-80-bb-e5-a4-84-e7-90-86.html#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://www.fesugar.com/zh-CN/2019/08/14/e5-ae-9e-e6-97-b6-e8-af-bb-e5-8f-96-e4-b8-8d-e5-90-8c-e6-95-b0-e6-8d-ae-e5-88-b0excel-e8-bf-9b-e8-a1-8c-e6-b1-87-e6-80-bb-e5-a4-84-e7-90-86.html" class="cy_cmt_count" data-xid="zh-CN/2019/08/14/e5-ae-9e-e6-97-b6-e8-af-bb-e5-8f-96-e4-b8-8d-e5-90-8c-e6-95-b0-e6-8d-ae-e5-88-b0excel-e8-bf-9b-e8-a1-8c-e6-b1-87-e6-80-bb-e5-a4-84-e7-90-86.html" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>6.3k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>6 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><strong>实时读取不同数据到Excel进行汇总处理</strong></p>
<p>实例说明</p>
<p>本实例使用C#代码实现了实时读取不同数据到Excel进行汇总处理的功能。运行本实例，如图1所示，单击第一个”选择”按钮，选择要读取的文本文件；单击第二个”选择”按钮，选择要读取的Word文件；单击第3个”选择”按钮，选择要读取的Access数据库文件；单击第4个”选择”按钮，选择Excel文件；单击”开始”按钮，启动Timer计时器，并实时将各种不同的数据读取到Excel文件进行汇总处理；单击”停止”按钮，停止Timer计时器，同时停止向Excel文件中读取数据；单击”查看”按钮，查看导入数据之后的Excel文件。</p>
<p><img data-src="https://cdn.fesugar.com/2019/08/081419_1103_Excel1.png" alt=""></p>
<p>图1 实时读取不同数据到Excel进行汇总处理 关键技术</p>
<p>本实例主要实现将3种不同的数据（文本文件数据、Word文档数据和Access数据库数据）实时汇总到Excel中的功能，在将这3种数据汇总到Excel时，分别需要用到文本文件的流读取、Word文档内容的获取和OLEDB获取Access数据等技术，另外，还需要使用Timer计时器来控制数据的实时汇总。下面对本实例中用到的关键技术进行详细讲解。</p>
<p>Timer计时器可以按用户定义的时间间隔来引发事件，引发的事件一般为周期性的，每隔若干秒或若干毫秒执行一次，其Interval属性用来获取或设置在相对于上一次发生的Tick事件引发Tick事件之前的时间（以毫秒为单位）。Interval属性语法格式如下：</p>
<p>public int Interval { get; set; }</p>
<p>参数说明</p>
<p>R  属性值：指定在相对于上一次发生的Tick事件引发Tick事件之前的毫秒数，该值不能小于1。</p>
<p>设计过程</p>
<p>（1）打开Visual Studio 2008开发环境，新建一个Windows窗体应用程序，命名为DisDataToExcel。</p>
<p>（2）更改默认窗体Form1的Name属性为Frm_Main，在该窗体中添加4个TextBox控件，分别用来显示选择的文本文件路径、Word文档路径、Access数据库文件路径和Excel文件路径；添加7个Button控件，分别用来执行选择文本文件、选择Word文档、选择Access数据库文件、选择Excel文件、开始和停止将不同数据导入到Excel文件中、查看Excel文件操作；添加一个Timer组件，用来实时将各种不同的数据导入到Excel中进行汇总处理。</p>
<p>（3）程序主要代码如下：</p>
<p>在timer1组件的Tick事件中，首先判断是否选择了Excel文件，如果已经选择，则分别判断是否选择了文本文件、Word文件及Access数据库文件，并调用相应的自定义方法将各种不同的数据导入到选择的Excel文件中，代码如下：</p>
<p>private void timer1_Tick(object sender, EventArgs e)<br>{<br>    if (txt_Excel.Text != “”)                                                         //判断是否选择了Excel文件<br>    {<br>        if (txt_Txt.Text != “”)                                                            //判断是否选择了文本文件<br>            TxtToExcel(txt_Txt.Text, txt_Excel.Text);                                     //将文本文件数据导入Excel<br>        if (txt_Word.Text != “”)                                                                //判断是否选择了Word文件<br>            WordToExcel(txt_Word.Text, txt_Excel.Text);                                      //将Word文件数据导入Excel<br>        if (txt_Access.Text != “”)                                                       //判断是否选择了Access文件<br>        {<br>            List<string> P_list_Tables = GetTable(txt_Access.Text);                         //获取Access中的所有表<br>            for (int i = 0; i &lt; P_list_Tables.Count; i++)                                      //遍历所有表<br>            {<br>                AccessToExcel(txt_Access.Text, P_list_Tables[i], txt_Excel.Text);          //将表中的数据导入Excel<br>            }<br>        }<br>    }<br>}</p>
<p>上面的代码中用到了TxtToExcel方法、WordToExcel方法和AccessToExcel方法，这3个方法是用户自定义的方法，下面分别进行介绍。TxtToExcel方法用来将文本文件的数据导入到Excel文件中，该方法中主要是通过文件流读取文本文件中的数据，并将读取到的数据填充到指定的Excel单元格中。TxtToExcel方法实现代码如下：</p>
<p>private void TxtToExcel(string P_str_Txt,string P_str_Excel)<br>{<br>    int P_int_Count = 0;                                                                     //记录正在读取的行数<br>    string P_str_Line;                                                                  //记录读取行的内容<br>    List<string> P_str_List = new List<string>();                                                //存储读取的所有内容<br>    StreamReader SReader = new StreamReader(P_str_Txt, Encoding.Default);                   //创建流读取对象<br>    while ((P_str_Line = SReader.ReadLine()) != null)                                                //循环读取文本文件中的每一行<br>    {<br>        P_str_List.Add(P_str_Line);                                                          //将读取到的行内容添加到泛型集合中<br>        P_int_Count++;                                                                     //使当前读取行数加1<br>}<br>//创建Excel对象<br>    Microsoft.Office.Interop.Excel.Application excel = new Microsoft.Office.Interop.Excel.Application();<br>    object missing = System.Reflection.Missing.Value;                                        //获取缺少的object类型值<br>    //打开指定的Excel文件<br>    Microsoft.Office.Interop.Excel.Workbook workbook = excel.Application.Workbooks.Open(P_str_Excel, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing);<br>    Microsoft.Office.Interop.Excel.Worksheet newWorksheet = (Microsoft.Office.Interop.Excel.Worksheet)workbook.Worksheets.Add(missing, missing, missing, missing);<br>    excel.Application.DisplayAlerts = false;                                                  //不显示提示对话框<br>    for (int i = 0; i &lt; P_str_List.Count; i++)                                                        //遍历泛型集合<br>    {<br>        newWorksheet.Cells[i + 1, 1] = P_str_List[i];                                                //直接将遍历到的内容添加到工作表中<br>    }<br>    workbook.Save();                                                                 //保存工作表<br>    workbook.Close(false, missing, missing);                                                     //关闭工作表<br>}<br>WordToExcel方法用来将Word文件中的数据导入到Excel文件中，该方法中首先需要判断Word文件中是否有表格存在，如果有表格存在，则将Word表格中的数据一一插入到Excel文件的对应单元格中；如果没有表格存在，则将Word文件中的所有内容整体插入到Excel文件的一个单元格中。WordToExcel方法实现代码如下：<br>private void WordToExcel(string P_str_Word, string P_str_Excel)<br>{<br>//创建Word对象<br>    Microsoft.Office.Interop.Word.Application word = new Microsoft.Office.Interop.Word.Application();<br>    Microsoft.Office.Interop.Word.Table table;                                                   //声明Word表格对象<br>//定义3个变量，分别用来存储表格数量、表格中的行数、列数<br>    int P_int_TableCount = 0, P_int_Row = 0, P_int_Column = 0;<br>    string P_str_Content;                                                                    //存储Word表格的单元格内容<br>    object missing = System.Reflection.Missing.Value;                                        //获取缺少的object类型值<br>object P_obj_Name;                                                               //存储遍历到的Word文件名<br>//创建Excel对象<br>    Microsoft.Office.Interop.Excel.Application excel = new Microsoft.Office.Interop.Excel.Application();<br>    //打开指定的Excel文件<br>Microsoft.Office.Interop.Excel.Workbook workbook = excel.Application.Workbooks.Open(P_str_Excel, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing, missing);<br>//创建新工作表<br>    Microsoft.Office.Interop.Excel.Worksheet newWorksheet = (Microsoft.Office.Interop.Excel.Worksheet)workbook.Worksheets.Add(missing, missing, missing, missing);<br>    P_obj_Name = (object)P_str_Word;                                                             //记录遍历到的Word文件名<br>    //打开Word文档<br>    Microsoft.Office.Interop.Word.Document document = word.Documents.Open(ref P_obj_Name, ref missing, ref missing, ref missing, ref missing, ref missing, ref missing, ref missing, ref missing, ref missing, ref missing, ref missing, ref missing, ref missing, ref missing, ref missing);<br>    word.DisplayAlerts = Microsoft.Office.Interop.Word.WdAlertLevel.wdAlertsNone;        //设置操作Word时不显示任何对话框<br>    P_int_TableCount = document.Tables.Count;                                                //获取Word文档中表格的数量<br>    if (P_int_TableCount &gt; 0)                                                              //判断表格数量是否大于0<br>    {<br>        for (int j = 1; j &lt;= P_int_TableCount; j++)                                              //遍历所有表格<br>        {<br>            table = document.Tables[j];                                                    //记录遍历到的表格<br>            P_int_Row = table.Rows.Count;                                                    //获取表格行数<br>            P_int_Column = table.Columns.Count;                                            //获取表格列数<br>            for (int row = 1; row &lt;= P_int_Row; row++)                                        //遍历表格中的行<br>            {<br>                for (int column = 1; column &lt;= P_int_Column; column++)               //遍历表格中的列<br>                {<br>                    P_str_Content = table.Cell(row, column).Range.Text;               //获取遍历到的单元格内容<br>//将遍历到的单元格内容添加到Excel单元格中<br>                    newWorksheet.Cells[row, column] = P_str_Content.Substring(0, P_str_Content.Length - 2);<br>                }<br>            }<br>        }<br>    }<br>    else<br>    {<br>        if (P_int_Row == 0)                                                              //判断前面是否已经填充过表格<br>//直接将Word文档内容添加到工作表中<br>            newWorksheet.Cells[P_int_Row + 1, 1] = document.Content.Text;<br>        else<br>//直接将Word文档内容添加到工作表中<br>            newWorksheet.Cells[P_int_Row, 1] = document.Content.Text;<br>    }<br>    document.Close(ref missing, ref missing, ref missing);                                          //关闭Word文档<br>    excel.Application.DisplayAlerts = false;                                                  //不显示提示对话框<br>    workbook.Save();                                                                 //保存工作表<br>    workbook.Close(false, missing, missing);                                                     //关闭工作表<br>    word.Quit(ref missing, ref missing, ref missing);                                           //退出Word应用程序<br>}<br>AccessToExcel方法用来将Access数据库中的指定数据表的内容导入到Excel文件中，该方法主要通过使用“select * into from 表名”SQL语句来进行实现。AccessToExcel方法实现代码如下：<br>private void AccessToExcel(string P_str_Access,string P_str_Table,string P_str_Excel)<br>{<br>    string P_str_Con = @”Provider=Microsoft.Jet.OLEDB.4.0;Data Source=” + P_str_Access + “;Persist Security Info=True”;                                                       //记录连接Access的语句<br>    string P_str_Sql = “”;                                                                    //存储要执行的SQL语句<br>    OleDbConnection oledbcon = new OleDbConnection(P_str_Con);                          //创建OLEDB连接对象<br>    OleDbCommand oledbcom;                                                           //定义OleDbCommand对象<br>    oledbcon.Open();                                                                  //打开数据库连接<br>P_str_Sql = @”select * into [Excel 8.0;database=” + P_str_Excel + “].” + “[“ + P_str_Table + “] from “ + P_str_Table + “”;                                                      //记录连接Excel的语句<br>//创建OleDbCommand对象<br>    oledbcom = new System.Data.OleDb.OleDbCommand(P_str_Sql, oledbcon);<br>    oledbcom.ExecuteNonQuery();                                                      //将数据表的内容导入到Excel中<br>    oledbcon.Close();                                                                  //关闭数据库连接<br>    oledbcon.Dispose();                                                               //释放资源<br>}</p>
<p>秘笈心法</p>
<p>心法领悟037：使用线程代替Timer组件！</p>
<p>Timer组件可以按用户定义的时间间隔来引发Tick事件，Tick事件一般为周期性的，每隔若干秒或若干毫秒执行一次，Timer组件工作在窗体线程中，如果Timer组件中执行了较为耗时的操作，会增加窗体线程的负担，导致窗体中其它操作不能及时得到CPU资源，出现窗体长时间或短时间无响应的情况。在适当的情况下可以使用线程来代替Timer组件，这样会减少窗体线程的负担。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/4/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><span class="space">&hellip;</span><a class="page-number" href="/page/14/">14</a><a class="extend next" rel="next" href="/page/6/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="fesugar"
      src="//cdn.fesugar.com/2019/04/2019-04-04-16060550-150x150.jpg">
  <p class="site-author-name" itemprop="name">fesugar</p>
  <div class="site-description" itemprop="description">个人博客，分享自己的实践脚印的互联网技术以及实际应用的日志<br/>|非专业人士；<br/>|三线小城市普通打工仔一名；<br/>|养家糊口不易~<br/>~~~~~</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">139</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">13</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/fesugar" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;fesugar" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:fesugar@fesugar.com" title="E-Mail → mailto:fesugar@fesugar.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="//weibo.com/u/1756351303" target="_blank" rel="noopener" title="Weibo → &#x2F;&#x2F;weibo.com&#x2F;u&#x2F;1756351303"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      友情链接
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="http://www.fesugar.com/" title="http:&#x2F;&#x2F;www.fesugar.com&#x2F;">甜甜糖博客</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://www.allenlan.com/" title="http:&#x2F;&#x2F;www.allenlan.com&#x2F;" rel="noopener" target="_blank">不忘初心</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://my.oschina.net/u/2955242" title="https:&#x2F;&#x2F;my.oschina.net&#x2F;u&#x2F;2955242" rel="noopener" target="_blank">fesugar</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://www.mxxia.com/" title="http:&#x2F;&#x2F;www.mxxia.com" rel="noopener" target="_blank">梦想霞博客</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        
  <div class="beian"><a href="http://www.beian.miit.gov.cn/" rel="noopener" target="_blank">苏ICP备15051349号-1 </a>
  </div>

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">fesugar</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">站点总字数：</span>
    <span title="站点总字数">380k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">5:45</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> 强力驱动
  </div>

        
<div class="busuanzi-count">
  <script data-pjax async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="//cdn.jsdelivr.net/npm/animejs@3.1.0/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/theme-next/theme-next-pjax@0/pjax.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/velocity-animate@1/velocity.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/velocity-animate@1/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>

  <script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[data-pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.dataset.pjax !== undefined) {
      script.dataset.pjax = '';
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});
</script>




  
  <script data-pjax>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>




  
<script src="/js/local-search.js"></script>











<script data-pjax>
if (document.querySelectorAll('pre.mermaid').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js', () => {
    mermaid.initialize({
      theme    : 'forest',
      logLevel : 3,
      flowchart: { curve     : 'linear' },
      gantt    : { axisFormat: '%m/%d/%Y' },
      sequence : { actorMargin: 50 }
    });
  }, window.mermaid);
}
</script>


    <div id="pjax">
  

  

  <script id="cy_cmt_num" src="https://changyan.sohu.com/upload/plugins/plugins.list.count.js?clientId=cys44eS01"></script>


    </div>
</body>
</html>
