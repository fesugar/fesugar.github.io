<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/pace-js@1/themes/blue/pace-theme-minimal.css">
  <script src="//cdn.jsdelivr.net/npm/pace-js@1/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"www.fesugar.com","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"always","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":true,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="个人博客，分享自己的实践脚印的互联网技术以及实际应用的日志|非专业人士；|三线小城市普通打工仔一名；|养家糊口不易~~~~~~">
<meta property="og:type" content="website">
<meta property="og:title" content="佛系糖果的博客">
<meta property="og:url" content="https://www.fesugar.com/page/9/index.html">
<meta property="og:site_name" content="佛系糖果的博客">
<meta property="og:description" content="个人博客，分享自己的实践脚印的互联网技术以及实际应用的日志|非专业人士；|三线小城市普通打工仔一名；|养家糊口不易~~~~~~">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="fesugar">
<meta property="article:tag" content="fesugar">
<meta property="article:tag" content="甜甜糖">
<meta property="article:tag" content="甜甜糖个人博客">
<meta property="article:tag" content="甜甜糖博客">
<meta property="article:tag" content="如何做个人博客网站">
<meta property="article:tag" content="严圣川">
<meta property="article:tag" content="严圣川个人网站">
<meta property="article:tag" content="佛系糖果">
<meta property="article:tag" content="小程序">
<meta property="article:tag" content="多线程c#">
<meta property="article:tag" content=".net">
<meta property="article:tag" content="c语言">
<meta property="article:tag" content="vb">
<meta property="article:tag" content="php">
<meta property="article:tag" content="小程序radio样式">
<meta property="article:tag" content="小程序开发">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://www.fesugar.com/page/9/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>佛系糖果的博客</title>
  


  <script data-pjax>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?c708aaffb3b844ecd872db5ea0e68d8f";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="佛系糖果的博客" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">佛系糖果的博客</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">行到水穷处，坐看云起时</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-knowledge">

    <a href="/categories/%E4%B9%A6%E7%B1%8D%E6%96%87%E6%A1%A3/" rel="section"><i class="fa fa-book fa-fw"></i>知识</a>

  </li>
        <li class="menu-item menu-item-study">

    <a href="/categories/%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/" rel="section"><i class="fa fa-edit fa-fw"></i>学习</a>

  </li>
        <li class="menu-item menu-item-guestbook">

    <a href="/guestbook/" rel="section"><i class="fa fa-comment fa-fw"></i>留言簿</a>

  </li>
        <li class="menu-item menu-item-weiyu">

    <a href="/weiyu/" rel="section"><i class="fa fa-eye fa-fw"></i>微语</a>

  </li>
        <li class="menu-item menu-item-disclaimer">

    <a href="/disclaimer/" rel="section"><i class="fa fa-bell fa-fw"></i>条款声明</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-coffee fa-fw"></i>关于</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <a href="https://github.com/fesugar" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.fesugar.com/zh-CN/2019/07/09/e5-88-b6-e4-bd-9c-e5-ae-b6-e5-ba-ad-e5-bd-b1-e9-9b-86.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//cdn.fesugar.com/2019/04/2019-04-04-16060550-150x150.jpg">
      <meta itemprop="name" content="fesugar">
      <meta itemprop="description" content="个人博客，分享自己的实践脚印的互联网技术以及实际应用的日志<br/>|非专业人士；<br/>|三线小城市普通打工仔一名；<br/>|养家糊口不易~<br/>~~~~~">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="佛系糖果的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/zh-CN/2019/07/09/e5-88-b6-e4-bd-9c-e5-ae-b6-e5-ba-ad-e5-bd-b1-e9-9b-86.html" class="post-title-link" itemprop="url">制作家庭影集</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-07-09 22:59:36" itemprop="dateCreated datePublished" datetime="2019-07-09T22:59:36+08:00">2019-07-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-05-10 03:27:05" itemprop="dateModified" datetime="2020-05-10T03:27:05+08:00">2020-05-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%B9%A6%E7%B1%8D%E6%96%87%E6%A1%A3/" itemprop="url" rel="index"><span itemprop="name">书籍文档</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan：</span>
    
    
      <a title="changyan" href="/zh-CN/2019/07/09/e5-88-b6-e4-bd-9c-e5-ae-b6-e5-ba-ad-e5-bd-b1-e9-9b-86.html#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://www.fesugar.com/zh-CN/2019/07/09/e5-88-b6-e4-bd-9c-e5-ae-b6-e5-ba-ad-e5-bd-b1-e9-9b-86.html" class="cy_cmt_count" data-xid="zh-CN/2019/07/09/e5-88-b6-e4-bd-9c-e5-ae-b6-e5-ba-ad-e5-bd-b1-e9-9b-86.html" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.9k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>2 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="制作家庭影集"><a href="#制作家庭影集" class="headerlink" title="制作家庭影集"></a>制作家庭影集</h2><h3 id="实例说明"><a href="#实例说明" class="headerlink" title="实例说明"></a>实例说明</h3><p>许多家庭为了防止照片的损坏，便将图片存入电脑中，为了更方便的浏览图片，本实例制作了一个多图片的浏览程序，运行本实例，单击“上一张”、“下一张”按钮，可以对图片进行快速浏览。实例运行效果如图1所示。 <img data-src="https://cdn.fesugar.com/2019/07/2019-07-09-14583875.png" alt=""> 图1 制作家庭影集</p>
<h3 id="关键技术"><a href="#关键技术" class="headerlink" title="关键技术"></a>关键技术</h3><p>本实例在实现时，首先通过DirectoryInfo类的GetFileSystemInfos方法从指定的文件夹中获取图片信息；然后将所有的图片名称取出来放在一个字符串中，并通过Split方法分割字符串生成一个存储图片名称的数组，数组的大小就是图片的数量；最后通过一个变量进行增加或减少作为数组下标从而实现图片的显示。下面对本实例中用到的关键技术进行详细介绍。 （1）DirectoryInfo类的GetFileSystemInfos方法 该方法用来返回表示某个目录中所有文件和子目录的强类型FileSystemInfo项的数组，其语法格式如下： public Rectangle WorkingArea { get; } 参数说明 返回值：强类型FileSystemInfo项的数组。 （2）Split方法 该方法返回的字符串数组包含字符串中的子字符串（由指定Unicode字符数组的元素分隔），其语法格式如下： public string[] Split(char[] separator) 参数说明 separator：分隔此实例中子字符串的Unicode字符数组、不包含分隔符的空数组或null。 返回值：一个数组，其元素包含此实例中的子字符串，这些子字符串由separator参数中的一个或多个字符分隔。</p>
<h3 id="设计过程"><a href="#设计过程" class="headerlink" title="设计过程"></a>设计过程</h3><p>（1）打开Visual Studio 2008开发环境，新建一个Windows窗体应用程序，命名为TailorFamilyAlbum。 （2）更改默认窗体Form1的Name属性为Frm_Main，在该窗体中添加两个Button控件和一个PictureBox控件，分别用来执行上一张、下一张导向操作以及显示图片信息。 （3）程序主要代码如下：</p>
<p>public void GetAllFiles(DirectoryInfo dir)<br>   {<br>       FileSystemInfo[] fileinfo = dir.GetFileSystemInfos( );     //初始化一个FileSystemInfo类型的数组<br>       foreach (FileSystemInfo i in fileinfo)                 //循环遍历fileinfo中的每一个记录<br>       {<br>           if (i is DirectoryInfo)                     //当i在类DirectoryInfo中存在时<br>           {<br>               GetAllFiles((DirectoryInfo)i);             //获取i下的所有文件<br>           }<br>           else                                //当不存在该i时<br>           {<br>               string str = i.FullName;                 //记录变量i的全名<br>               int b = str.LastIndexOf(“\&quot;);                //在此示例中获取最后一个匹配项的索引<br>               string strType = str.Substring(b + 1);         //保存文件的后缀<br>               //当文件格式为“jpg”或者“bmp”时<br>               if (strType.Substring(strType.Length - 3) == “jpg” || strType.Substring(strType.Length - 3) == “bmp”)<br>               {<br>                   strInfo += strType+ “#”;                //为变量strInfo赋值<br>               }<br>            }<br>       }<br>   }</p>
<p>  Frm_Main窗体加载时，调用GetAllFiles方法，并将该方法的返回值转化为一个字符串数组，用于存放图片名。代码如下：</p>
<p>private void Frm_Main_Load(object sender, EventArgs e)<br>{<br>    DirectoryInfo dir = new DirectoryInfo(strPath);             //创建一个DirectoryInfo对象<br>    GetAllFiles(dir);                             //获取dir下的所有文件<br>    if (strInfo != “”)                                //当字符串不为空时<br>    {<br>        strName = strInfo.Split(‘#’);                     //获取文件名<br>        Num = 0;                                 //初始化Num的值<br>        showPic(Num);                             //显示图片<br>        Count = strName.Length-1;                     //记录Array中的元素数<br>    }<br>    else                                    //当字符串为空时<br>    {<br>        MessageBox.Show(“影集里没有照片”);            //弹出信息提示<br>    }<br>}</p>
<h3 id="秘笈心法"><a href="#秘笈心法" class="headerlink" title="秘笈心法"></a>秘笈心法</h3><p>心法领悟006：妙用foreach语句！ foreach循环专门用来遍历数组和集合的元素，foreach的工作原理是逐个枚举出数组或集合中的每一个元素，每当枚举一个元素就执行一次语句块中的内容，在使用foreach遍历的过程中要注意不可以更改遍历中的集合。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.fesugar.com/zh-CN/2019/07/09/e5-88-b6-e4-bd-9cavi-e6-92-ad-e6-94-be-e5-99-a8.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//cdn.fesugar.com/2019/04/2019-04-04-16060550-150x150.jpg">
      <meta itemprop="name" content="fesugar">
      <meta itemprop="description" content="个人博客，分享自己的实践脚印的互联网技术以及实际应用的日志<br/>|非专业人士；<br/>|三线小城市普通打工仔一名；<br/>|养家糊口不易~<br/>~~~~~">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="佛系糖果的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/zh-CN/2019/07/09/e5-88-b6-e4-bd-9cavi-e6-92-ad-e6-94-be-e5-99-a8.html" class="post-title-link" itemprop="url">制作AVI播放器</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-07-09 22:57:26" itemprop="dateCreated datePublished" datetime="2019-07-09T22:57:26+08:00">2019-07-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-05-10 03:27:05" itemprop="dateModified" datetime="2020-05-10T03:27:05+08:00">2020-05-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%B9%A6%E7%B1%8D%E6%96%87%E6%A1%A3/" itemprop="url" rel="index"><span itemprop="name">书籍文档</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan：</span>
    
    
      <a title="changyan" href="/zh-CN/2019/07/09/e5-88-b6-e4-bd-9cavi-e6-92-ad-e6-94-be-e5-99-a8.html#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://www.fesugar.com/zh-CN/2019/07/09/e5-88-b6-e4-bd-9cavi-e6-92-ad-e6-94-be-e5-99-a8.html" class="cy_cmt_count" data-xid="zh-CN/2019/07/09/e5-88-b6-e4-bd-9cavi-e6-92-ad-e6-94-be-e5-99-a8.html" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.5k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="制作AVI播放器"><a href="#制作AVI播放器" class="headerlink" title="制作AVI播放器"></a>制作AVI播放器</h2><h3 id="实例说明"><a href="#实例说明" class="headerlink" title="实例说明"></a>实例说明</h3><p>相信大家都使用过“金山影霸”、“RealOne”等影视播放器，其强大的媒体播放功能深受大家的喜爱。是否想过自己设计一个AVI播放器呢？本实例中笔者设计了一个AVI播放器，实现了对AVI文件的基本播放与重复播放的功能。实例运行效果如图1所示。 <img data-src="https://cdn.fesugar.com/2019/07/2019-07-09-14565476.png" alt=""> 图1 制作AVI播放器</p>
<h3 id="关键技术"><a href="#关键技术" class="headerlink" title="关键技术"></a>关键技术</h3><p>本实例实现时主要用到了Microsoft Animation Control Version 6.0组件，该组件可以一帧一帧的播放AVI文件，在使用该组件进行开发程序前，必须将Microsoft Animation Control Version 6.0组件添加到工具箱中，步骤如下： （1）选择工具箱，单击鼠标右键，在弹出的快捷菜单中选择“选择项”。 （2）弹出“选择工具箱项”对话框，选择“COM组件”选项卡。 （3）在COM组件列表中，选择名称为“Microsoft Animation Control Version 6.0”的项，单击“确定”按钮，该组件将会自动添加到“工具箱”中。 Microsoft Animation Control Version 6.0组件提供了多个属性、方法用于控制多媒体文件的播放，其常用的属性和方法如表1所示。 表1 Microsoft Animation Control Version 6.0组件的常用属性和方法</p>
<p>属性、方法</p>
<p>说明</p>
<p>AutoPlay属性</p>
<p>确定程序运行时，媒体播放器是否自动播放</p>
<p>Open方法</p>
<p>打开一个媒体文件</p>
<p>Stop方法</p>
<p>停止媒体文件的播放</p>
<p>Play方法</p>
<p>播放媒体文件</p>
<p><img data-src="https://cdn.fesugar.com/2019/07/2019-07-09-14565645.jpeg" alt="注意"> 注意：Play方法可以重载，本实例中使用了它的第一种重载形式，该方法具有3个参数，第一个参数是重复播放次数，第二个参数是起始帧的位置，第3个参数是结束帧的位置。</p>
<h3 id="设计过程"><a href="#设计过程" class="headerlink" title="设计过程"></a>设计过程</h3><p>（1）打开Visual Studio 2008开发环境，新建一个Windows窗体应用程序，命名为AviPlay。 （2）更改默认窗体Form1的Name属性为Frm_Main，在该窗体中添加一个AxAnimation组件，用来播放AVI文件；添加两个Button控件，分别用来执行重复播放指定帧操作和播放AVI文件操作；添加两个TextBox控件，分别用来设置要重复播放的起始帧和结束帧。 （3）程序主要代码如下：</p>
<p>private void Frm_Main_Load(object sender, EventArgs e)<br>{<br>    this.axAnimation1.Open(Application.StartupPath + “//clock.avi”);        //加载AVI文件<br>}<br>private void button1_Click(object sender, EventArgs e)<br>{<br>    try<br>    {<br>        this.axAnimation1.Stop();                             //停止播放<br>        object start = this.textBox1.Text;                         //保存起始帧中的数据<br>        object end = this.textBox2.Text;                         //保存结束帧中的数据<br>        object time = 20;                                     //初始化变量time<br>        this.axAnimation1.Play(time, start, end);                     //播放指定的帧数<br>    }<br>    catch<br>    {<br>        MessageBox.Show(“请输入正确帧数！”);<br>    }<br>}<br>private void button2_Click(object sender, EventArgs e)<br>{<br>    this.axAnimation1.Play();                                //播放多媒体文件<br>}</p>
<h3 id="秘笈心法"><a href="#秘笈心法" class="headerlink" title="秘笈心法"></a>秘笈心法</h3><p>心法领悟007：object类型的使用。 object类是Object类的别名，它支持.NET Framework类层次结构中的所有类，并为派生类提供低级别服务，它是.NET Framework中所有类的最终基类。一般在程序中定义变量的类型时，如果不确定变量的类型，则可以使用object类型来定义。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.fesugar.com/zh-CN/2019/07/08/e5-88-b6-e4-bd-9c-e7-94-b5-e5-bd-b1-e7-89-b9-e6-95-88-e6-95-88-e6-9e-9c.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//cdn.fesugar.com/2019/04/2019-04-04-16060550-150x150.jpg">
      <meta itemprop="name" content="fesugar">
      <meta itemprop="description" content="个人博客，分享自己的实践脚印的互联网技术以及实际应用的日志<br/>|非专业人士；<br/>|三线小城市普通打工仔一名；<br/>|养家糊口不易~<br/>~~~~~">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="佛系糖果的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/zh-CN/2019/07/08/e5-88-b6-e4-bd-9c-e7-94-b5-e5-bd-b1-e7-89-b9-e6-95-88-e6-95-88-e6-9e-9c.html" class="post-title-link" itemprop="url">制作电影特效效果</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-07-08 21:51:05" itemprop="dateCreated datePublished" datetime="2019-07-08T21:51:05+08:00">2019-07-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-05-10 03:27:05" itemprop="dateModified" datetime="2020-05-10T03:27:05+08:00">2020-05-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%B9%A6%E7%B1%8D%E6%96%87%E6%A1%A3/" itemprop="url" rel="index"><span itemprop="name">书籍文档</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan：</span>
    
    
      <a title="changyan" href="/zh-CN/2019/07/08/e5-88-b6-e4-bd-9c-e7-94-b5-e5-bd-b1-e7-89-b9-e6-95-88-e6-95-88-e6-9e-9c.html#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://www.fesugar.com/zh-CN/2019/07/08/e5-88-b6-e4-bd-9c-e7-94-b5-e5-bd-b1-e7-89-b9-e6-95-88-e6-95-88-e6-9e-9c.html" class="cy_cmt_count" data-xid="zh-CN/2019/07/08/e5-88-b6-e4-bd-9c-e7-94-b5-e5-bd-b1-e7-89-b9-e6-95-88-e6-95-88-e6-9e-9c.html" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.3k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="制作电影特效效果"><a href="#制作电影特效效果" class="headerlink" title="制作电影特效效果"></a>制作电影特效效果</h2><h3 id="实例说明"><a href="#实例说明" class="headerlink" title="实例说明"></a>实例说明</h3><p>随着现代高科技越来越快的发展，电影特效在现代电影中的使用越来越多，而它们这样做的目的无非是为了更好的吸引观看者的眼球，同样的，如果开发人员能在开发的程序中实现一些电影特效效果，也一定可以为程序增色不少。本实例实现了两种常见的电影特效效果，实例运行结果如图1和图2所示。 <img data-src="https://cdn.fesugar.com/2019/07/2019-07-08-13503264.png" alt=""> 图1 文字特效 <img data-src="https://cdn.fesugar.com/2019/07/2019-07-08-13503455.png" alt=""> 图2 图片特效</p>
<h3 id="关键技术"><a href="#关键技术" class="headerlink" title="关键技术"></a>关键技术</h3><p>本实例在实现时主要用到了Label控件的Font属性和PictureBox控件的Size属性，下面分别对它们进行详细讲解。 （1）Label控件的Font属性 Label控件表示一个标签控件，其Font属性用于获取或设置控件显示的文字的字体，该属性语法格式如下： public virtual Font Font { get; set; } 参数说明 属性值：要应用于由控件显示的文本的Font。默认为DefaultFont属性的值。 （2）PictureBox控件的Size属性 PictureBox控件用于显示位图、GIF、JPEG、图元文件或图标格式的图形，其Size属性用于获取或设置控件的高度和宽度，该属性语法格式如下： public Size Size { get; set; } 参数说明 属性值：表示控件的高度和宽度（以像素为单位）。</p>
<h3 id="设计过程"><a href="#设计过程" class="headerlink" title="设计过程"></a>设计过程</h3><p>（1）打开Visual Studio 2008开发环境，新建一个Windows窗体应用程序，命名为MovieSpecific。 （2）更改默认窗体Form1的Name属性为Frm_Main，在该窗体中添加一个Label控件，用来显示动态缩放的文字；添加一个PictureBox控件，用来显示动态缩放的图片；添加两个Button控件，分别用来执行文字和图片缩放操作；添加一个Timer计时器组件，用来控制文字和图片的缩放。 （3）程序主要代码如下：</p>
<p>private void button1_Click(object sender, EventArgs e)<br>{<br>    timer1.Enabled = true;                                                    //启动计时器<br>    pictureBox1.Visible = false;                                                //隐藏PictureBox控件<br>    label1.Visible = true;                                                    //显示Label控件<br>}<br>private void button3_Click(object sender, EventArgs e)<br>{<br>    label1.Visible = false;                                                    //隐藏Label控件<br>    timer1.Enabled = true;                                                    //启动计时器<br>    pictureBox1.Visible = true;                                                //显示PictureBox控件<br>}<br>private void timer1_Tick(object sender, EventArgs e)<br>{<br>    label1.Font = new Font(label1.Font.FontFamily, label1.Font.Size + 1);                        //使字体逐步加一<br>    pictureBox1.Size = new Size(pictureBox1.Size.Width + 5, pictureBox1.Size.Height + 5);            //使图片逐渐增大<br>}</p>
<h3 id="秘笈心法"><a href="#秘笈心法" class="headerlink" title="秘笈心法"></a>秘笈心法</h3><p>心法领悟008：Timer计时器组件的使用。 Timer组件是一个计时器组件，它主要用来按用户定义的时间间隔来引发事件，引发的事件一般为周期性的，每隔若干秒或若干毫秒执行一次。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.fesugar.com/zh-CN/2019/07/07/e4-ba-a7-e5-93-81-e7-94-b5-e5-ad-90-e6-8a-a5-e4-bb-b7.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//cdn.fesugar.com/2019/04/2019-04-04-16060550-150x150.jpg">
      <meta itemprop="name" content="fesugar">
      <meta itemprop="description" content="个人博客，分享自己的实践脚印的互联网技术以及实际应用的日志<br/>|非专业人士；<br/>|三线小城市普通打工仔一名；<br/>|养家糊口不易~<br/>~~~~~">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="佛系糖果的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/zh-CN/2019/07/07/e4-ba-a7-e5-93-81-e7-94-b5-e5-ad-90-e6-8a-a5-e4-bb-b7.html" class="post-title-link" itemprop="url">产品电子报价</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-07-07 22:39:59" itemprop="dateCreated datePublished" datetime="2019-07-07T22:39:59+08:00">2019-07-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-05-10 03:27:05" itemprop="dateModified" datetime="2020-05-10T03:27:05+08:00">2020-05-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%B9%A6%E7%B1%8D%E6%96%87%E6%A1%A3/" itemprop="url" rel="index"><span itemprop="name">书籍文档</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan：</span>
    
    
      <a title="changyan" href="/zh-CN/2019/07/07/e4-ba-a7-e5-93-81-e7-94-b5-e5-ad-90-e6-8a-a5-e4-bb-b7.html#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://www.fesugar.com/zh-CN/2019/07/07/e4-ba-a7-e5-93-81-e7-94-b5-e5-ad-90-e6-8a-a5-e4-bb-b7.html" class="cy_cmt_count" data-xid="zh-CN/2019/07/07/e4-ba-a7-e5-93-81-e7-94-b5-e5-ad-90-e6-8a-a5-e4-bb-b7.html" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>2.2k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>2 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="产品电子报价"><a href="#产品电子报价" class="headerlink" title="产品电子报价"></a>产品电子报价</h2><h3 id="实例说明"><a href="#实例说明" class="headerlink" title="实例说明"></a>实例说明</h3><p>本实例是通过电子产品的名称，来查看该电子产品的图片。运行程序，在“选择电子产品”下拉列表中选择电子产品的名称，单击“查询”按钮，即可在产品电子报价栏中显示该产品的图片信息。实例运行效果如图1所示。 <img data-src="https://cdn.fesugar.com/2019/07/2019-07-07-14385589.png" alt=""> 图1 产品电子报价</p>
<h3 id="关键技术"><a href="#关键技术" class="headerlink" title="关键技术"></a>关键技术</h3><p>通过对本实例的分析，由于要将所有海报名列添加到下拉列表框中，海报的名称是惟一的，但是海报的格式（JPG、BMP等）不一定一样，所以要通过名称以最快的方式定位到图片上，笔者在这里使用了Hashtable类。Hashtable类用于表示键/值对的集合，这些键/值对可以根据键的哈希代码进行组织。Hashtable类的常用方法及说明如表1所示。 表1 Hashtable类的常用方法及说明</p>
<p>方法</p>
<p>说明</p>
<p>Add</p>
<p>将带有指定键和值的元素添加到Hashtable中</p>
<p>Clear</p>
<p>从Hashtable中移除所有元素</p>
<p>Contains</p>
<p>确定Hashtable是否包含特定键</p>
<p>ContainsKey</p>
<p>确定Hashtable是否包含特定键</p>
<p>ContainsValue</p>
<p>确定Hashtable是否包含特定值</p>
<p>CopyTo</p>
<p>将Hashtable元素复制到一维Array实例中的指定索引位置</p>
<p>GetEnumerator</p>
<p>返回循环访问Hashtable的IDictionaryEnumerator</p>
<p>Remove</p>
<p>从Hashtable中移除带有指定键的元素</p>
<h3 id="设计过程"><a href="#设计过程" class="headerlink" title="设计过程"></a>设计过程</h3><p>（1）打开Visual Studio 2008开发环境，新建一个Windows窗体应用程序，命名为ProductElectronQuote。 （2）更改默认窗体Form1的Name属性为Frm_Main，在该窗体中添加一个ComboBox控件，用来选择产品名称列表；添加一个Button控件，用来执行查找功能；添加一个PictureBox控件，用来显示产品海报。 （3）程序主要代码如下：</p>
<p>Hashtable ht = new Hashtable();                                 //初始化一个哈希表对象<br>string str;                                             //初始化一个字符串str<br>public Frm_Main()<br>{<br>    InitializeComponent();<br>    str = Application.StartupPath + “\\Image”;                        //保存商品图片所在的路径<br>}<br>private void Form1_Load(object sender, EventArgs e)<br>{<br>    DirectoryInfo dir = new DirectoryInfo(str);                        //创建一个DirectoryInfo类的对象<br>    GetAllFiles(dir);                                     //获取指定路径下的所有文件<br>    foreach (DictionaryEntry de in ht)                             //循环哈希表中的所有数据<br>        this.comboBox1.Items.Add(de.Key);                         //向comboBox1中添加内容<br>}<br>public void GetAllFiles(DirectoryInfo dir)<br>{<br>    FileSystemInfo[] fileinfo = dir.GetFileSystemInfos();                //创建一个FileSystemInfo类型的对象<br>    foreach (FileSystemInfo i in fileinfo)                         //循环遍历fileinfo下的所有内容<br>    {<br>        if (i is DirectoryInfo)                                 //当在DirectoryInfo中存在i时<br>        {<br>            GetAllFiles((DirectoryInfo)i);                         //获取i下的所有文件<br>        }<br>        else                                            //当在DirectoryInfo中不存在i时<br>        {<br>            string str = i.FullName;                             //记录i的绝对路径<br>            int b = str.LastIndexOf(“\&quot;);                        //获取字符串与指定项匹配的最后一个索引<br>            string strType = str.Substring(b + 1);                    //获取文件的后缀名<br>            //当图片类型为“jpg”或者“bmp”时<br>            if (strType.Substring(strType.Length - 3).ToLower() == “jpg” || strType.Substring(strType.Length - 3).ToLower() == “bmp”)<br>            {<br>                ht.Add(strType.Substring(0, strType.Length - 4), strType);     //向哈希表中添加内容<br>            }<br>        }<br>    }<br>}<br>private void showPic(string name)<br>{<br>    this.pictureBox1.ImageLocation = str + “\&quot; + name;                //设置在pictureBox1中显示图片的路径<br>}</p>
<h3 id="秘笈心法"><a href="#秘笈心法" class="headerlink" title="秘笈心法"></a>秘笈心法</h3><p>心法领悟012：如何获取一个文件夹中的所有子文件夹及文件？ 获取一个文件夹中的所有子文件夹及文件时，可以使用DirectoryInfo类的GetFileSystemInfos方法来实现，该方法用来返回表示某个目录中所有文件和子目录的强类型FileSystemInfo项的数组，例如，本实例中使用该方法的代码如下：</p>
<p>str = Application.StartupPath + “\\Image”;                            //保存商品图片所在的路径<br>DirectoryInfo dir = new DirectoryInfo(str);                        //创建一个DirectoryInfo类的对象<br>FileSystemInfo[] fileinfo = dir.GetFileSystemInfos();                    //创建一个FileSystemInfo类型的对象</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.fesugar.com/zh-CN/2019/07/07/e4-ba-a7-e5-93-81-e6-bb-9a-e5-8a-a8-e5-b1-95-e7-a4-ba-e7-a8-8b-e5-ba-8f.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//cdn.fesugar.com/2019/04/2019-04-04-16060550-150x150.jpg">
      <meta itemprop="name" content="fesugar">
      <meta itemprop="description" content="个人博客，分享自己的实践脚印的互联网技术以及实际应用的日志<br/>|非专业人士；<br/>|三线小城市普通打工仔一名；<br/>|养家糊口不易~<br/>~~~~~">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="佛系糖果的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/zh-CN/2019/07/07/e4-ba-a7-e5-93-81-e6-bb-9a-e5-8a-a8-e5-b1-95-e7-a4-ba-e7-a8-8b-e5-ba-8f.html" class="post-title-link" itemprop="url">产品滚动展示程序</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-07-07 22:37:26" itemprop="dateCreated datePublished" datetime="2019-07-07T22:37:26+08:00">2019-07-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-05-10 03:27:05" itemprop="dateModified" datetime="2020-05-10T03:27:05+08:00">2020-05-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%B9%A6%E7%B1%8D%E6%96%87%E6%A1%A3/" itemprop="url" rel="index"><span itemprop="name">书籍文档</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan：</span>
    
    
      <a title="changyan" href="/zh-CN/2019/07/07/e4-ba-a7-e5-93-81-e6-bb-9a-e5-8a-a8-e5-b1-95-e7-a4-ba-e7-a8-8b-e5-ba-8f.html#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://www.fesugar.com/zh-CN/2019/07/07/e4-ba-a7-e5-93-81-e6-bb-9a-e5-8a-a8-e5-b1-95-e7-a4-ba-e7-a8-8b-e5-ba-8f.html" class="cy_cmt_count" data-xid="zh-CN/2019/07/07/e4-ba-a7-e5-93-81-e6-bb-9a-e5-8a-a8-e5-b1-95-e7-a4-ba-e7-a8-8b-e5-ba-8f.html" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>2k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>2 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="产品滚动展示程序"><a href="#产品滚动展示程序" class="headerlink" title="产品滚动展示程序"></a>产品滚动展示程序</h2><h3 id="实例说明"><a href="#实例说明" class="headerlink" title="实例说明"></a>实例说明</h3><p>很多商家为了宣传自己的产品，在网络上制作网页，通过互联网将自己的产品推向全国，甚至全世界。本实例将摸拟网页来制作一个窗体，将一系列产品的图片在窗体上滚动显示。实例运行效果如图1所示。 <img data-src="https://cdn.fesugar.com/2019/07/2019-07-07-1436373.png" alt=""> 图1 产品滚动展示程序</p>
<h3 id="关键技术"><a href="#关键技术" class="headerlink" title="关键技术"></a>关键技术</h3><p>本实例主要使用Timer计时器组件来控制产品图片的滚动显示。实现过程中，主要利用Timer计时器组件使Panel控件的Left属性在一定的时间内减10，从而达到产品图片滚动的效果。下面对本实例中用到的关键技术进行详细讲解。 Panel控件是一个容器控件，其Left属性用来获取或设置控件左边缘与其容器的工作区左边缘之间的距离（以像素为单位），该属性语法格式如下： [BrowsableAttribute(false)] public int Left { get; set; } 参数说明 属性值：表示控件左边缘与其容器的工作区左边缘之间的距离（以像素为单位）。</p>
<h3 id="设计过程"><a href="#设计过程" class="headerlink" title="设计过程"></a>设计过程</h3><p>（1）打开Visual Studio 2008开发环境，新建一个Windows窗体应用程序，命名为ProductTumblingShown。 （2）更改默认窗体Form1的Name属性为Frm_Main，在该窗体中添加3个PictureBox控件，用来显示产品图片；添加3个ImageList组件，用来存放产品图片；添加两个Timer组件，分别用来控制产品图片以指定的速度向左和向右移动。 （3）程序主要代码如下：</p>
<p>private void timer1_Tick(object sender, EventArgs e)<br>{<br>    left = 10;                                        //初始化变量left的值<br>    this.panel1.Left += left;                            //设置panel1控件距容器左边缘之间的距离<br>    int width = this.Width - this.panel1.Width;                    //初始化变量width<br>    if (this.panel1.Left &gt; width)                            //当panel1控件距容器左边缘之间的距离大于width时<br>    {<br>        this.timer1.Enabled = false;                        //禁用计时器timer1<br>        this.timer2.Enabled = true;                        //启用计时器timer2<br>        this.pictureBox1.Image = this.imageList1.Images[0];            //设置pictureBox1控件中显示的图片<br>        this.pictureBox2.Image = this.imageList2.Images[0];            //设置pictureBox2控件中显示的图片<br>        this.pictureBox3.Image = this.imageList3.Images[0];            //设置pictureBox3控件中显示的图片<br>    }<br>}<br>private void Frm_Main_Load(object sender, EventArgs e)<br>{<br>    this.pictureBox1.Image = this.imageList1.Images[0];            //设置pictureBox1控件中显示的图片<br>    this.pictureBox2.Image = this.imageList2.Images[0];            //设置pictureBox2控件中显示的图片<br>    this.pictureBox3.Image = this.imageList3.Images[0];            //设置pictureBox3控件中显示的图片<br>}<br>private void timer2_Tick(object sender, EventArgs e)<br>{<br>    left = -10;                                    //初始化left的值<br>    this.panel1.Left += left;                            //设置panel1距容器左边缘之间的距离<br>    if (this.panel1.Left &lt; 0)                            //当panel1距容器左边缘之间的距离小于0时<br>    {<br>        this.timer1.Enabled = true;                        //启用计时器timer1<br>        this.timer2.Enabled = false;                         //禁用计时器timer2<br>        this.pictureBox1.Image = this.imageList1.Images[1];         //设置pictureBox1控件中显示的图片<br>        this.pictureBox2.Image = this.imageList2.Images[1];            //设置pictureBox2控件中显示的图片<br>        this.pictureBox3.Image = this.imageList3.Images[1];            //设置pictureBox3控件中显示的图片<br>    }<br>}</p>
<h3 id="秘笈心法"><a href="#秘笈心法" class="headerlink" title="秘笈心法"></a>秘笈心法</h3><p>心法领悟013：启动和关闭Timer计时器的两种方法。 启动Timer计时器时，可以将其Enabled属性设置为true，或者调用其Start方法；而关闭Timer计时器时，则需要将其Enabled属性设置为false，或者调用其Stop方法。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.fesugar.com/zh-CN/2019/07/07/e5-b0-86-e6-b1-87-e6-80-bb-e6-95-b0-e6-8d-ae-e5-88-a9-e7-94-a8-e6-9f-b1-e5-bd-a2-e5-9b-be-e5-88-86-e6-9e-90.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//cdn.fesugar.com/2019/04/2019-04-04-16060550-150x150.jpg">
      <meta itemprop="name" content="fesugar">
      <meta itemprop="description" content="个人博客，分享自己的实践脚印的互联网技术以及实际应用的日志<br/>|非专业人士；<br/>|三线小城市普通打工仔一名；<br/>|养家糊口不易~<br/>~~~~~">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="佛系糖果的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/zh-CN/2019/07/07/e5-b0-86-e6-b1-87-e6-80-bb-e6-95-b0-e6-8d-ae-e5-88-a9-e7-94-a8-e6-9f-b1-e5-bd-a2-e5-9b-be-e5-88-86-e6-9e-90.html" class="post-title-link" itemprop="url">将汇总数据利用柱形图分析</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-07-07 17:42:40" itemprop="dateCreated datePublished" datetime="2019-07-07T17:42:40+08:00">2019-07-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-05-10 03:27:05" itemprop="dateModified" datetime="2020-05-10T03:27:05+08:00">2020-05-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%B9%A6%E7%B1%8D%E6%96%87%E6%A1%A3/" itemprop="url" rel="index"><span itemprop="name">书籍文档</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan：</span>
    
    
      <a title="changyan" href="/zh-CN/2019/07/07/e5-b0-86-e6-b1-87-e6-80-bb-e6-95-b0-e6-8d-ae-e5-88-a9-e7-94-a8-e6-9f-b1-e5-bd-a2-e5-9b-be-e5-88-86-e6-9e-90.html#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://www.fesugar.com/zh-CN/2019/07/07/e5-b0-86-e6-b1-87-e6-80-bb-e6-95-b0-e6-8d-ae-e5-88-a9-e7-94-a8-e6-9f-b1-e5-bd-a2-e5-9b-be-e5-88-86-e6-9e-90.html" class="cy_cmt_count" data-xid="zh-CN/2019/07/07/e5-b0-86-e6-b1-87-e6-80-bb-e6-95-b0-e6-8d-ae-e5-88-a9-e7-94-a8-e6-9f-b1-e5-bd-a2-e5-9b-be-e5-88-86-e6-9e-90.html" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.7k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>2 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="将汇总数据利用柱形图分析"><a href="#将汇总数据利用柱形图分析" class="headerlink" title="将汇总数据利用柱形图分析"></a>将汇总数据利用柱形图分析</h2><h3 id="实例说明"><a href="#实例说明" class="headerlink" title="实例说明"></a>实例说明</h3><p>在开发数据库系统管理软件时，通常使用图表分析数据库中的汇总数据。本实例通过柱形图对水果市场进行抽样调查，评选出最受欢迎的3种水果。实例运行效果如图1所示。 <img data-src="https://cdn.fesugar.com/2019/07/2019-07-07-09414680.png" alt=""> 图1 将汇总数据利用柱形图分析</p>
<h3 id="关键技术"><a href="#关键技术" class="headerlink" title="关键技术"></a>关键技术</h3><p>本实例主要通过调用Graphics类的FillRectangle方法来绘制表示汇总数据的柱形图。</p>
<h3 id="设计过程"><a href="#设计过程" class="headerlink" title="设计过程"></a>设计过程</h3><p>（1）打开Visual Studio 2008开发环境，新建一个Windows窗体应用程序，命名为GatherDataAnalyse。 （2）更改默认窗体Form1的Name属性为Frm_Main，在该窗体中添加一个Panel控件，用于显示绘图结果。 （3）程序主要代码如下：</p>
<p>private void ShowPic()<br>{<br>Conn();                                                        //打开数据库连接<br>//创建SqlCommand对象<br>    using (cmd = new SqlCommand(“SELECT TOP 3 * FROM tb_Rectangle order by t_Num desc”, con));<br>    {<br>        SqlDataReader dr = cmd.ExecuteReader();                                //创建SqlDataReader对象<br>        Bitmap bitM = new Bitmap(this.panel1.Width, this.panel1.Height);                //创建一个新画布<br>        Graphics g = Graphics.FromImage(bitM);                                //创建Graphics对象<br>        g.Clear(Color.White);                                            //设置画布背景<br>        for (int i = 0; i &lt; 5; i++)<br>        {<br>            g.DrawLine(new Pen(new SolidBrush(Color.Red), 2.0f), 50, this.panel1.Height - 20 - i * 20, this.panel1.Width - 40, this.panel1.Height - 20 - i * 20);                                                        //绘制水平直线<br>            g.DrawString(Convert.ToString(i * 100), new Font(“Times New Roman”, 10, FontStyle.Regular), new SolidBrush(Color.Black), 20, this.panel1.Height - 27 - i * 20);                                            //绘制文字<br>        }<br>        for (int j = 0; j &lt; 4; j++)<br>        {<br>            g.DrawLine(new Pen(new SolidBrush(Color.Red), 1.0f), 50+ 40 * j, this.panel1.Height - 20, 50 + 40 * j, 20);                                                                                    //绘制垂直直线<br>            if (dr.Read())<br>            {<br>                int x,y,w,h;                                            //声明变量存储坐标和宽高<br>                g.DrawString(dr[0].ToString(), new Font(“宋体”, 8, FontStyle.Regular), new SolidBrush(Color.Black), 76 + 40 * j, this.panel1.Height-16);                                                //绘制说明文字<br>                x = 78+ 40 * j;                                            //X轴<br>//Y轴<br>                y = this.panel1.Height - 20 - Convert.ToInt32((Convert.ToDouble(Convert.ToDouble(dr[1].ToString()) * 20 / 100)));<br>                w = 24;                                                //宽<br>                h = Convert.ToInt32(Convert.ToDouble(dr[1].ToString()) * 20 / 100);         //高<br>                g.FillRectangle(new SolidBrush(Color.FromArgb(56,129,78)), x,y,w,h);        //绘制柱形图<br>            }<br>        }<br>        this.panel1.BackgroundImage = bitM;                                    //将画布设为panel1控件的背景图<br>    }<br>}</p>
<h3 id="秘笈心法"><a href="#秘笈心法" class="headerlink" title="秘笈心法"></a>秘笈心法</h3><p>心法领悟003：有效回收对象资源！ 程序设计过程中，可以手动回收文件资源，但是使用using关键字则更为简洁友好。当using关键字下面的代码执行完毕后，将会自动将using小括号中创建的对象隐式转换为IDisposable接口类型，并调用接口方法Dispose释放对象资源。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.fesugar.com/zh-CN/2019/07/07/e5-af-b9-e6-8e-92-e5-ba-8f-e6-95-b0-e6-8d-ae-e8-bf-9b-e8-a1-8c-e5-88-86-e6-9e-90.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//cdn.fesugar.com/2019/04/2019-04-04-16060550-150x150.jpg">
      <meta itemprop="name" content="fesugar">
      <meta itemprop="description" content="个人博客，分享自己的实践脚印的互联网技术以及实际应用的日志<br/>|非专业人士；<br/>|三线小城市普通打工仔一名；<br/>|养家糊口不易~<br/>~~~~~">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="佛系糖果的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/zh-CN/2019/07/07/e5-af-b9-e6-8e-92-e5-ba-8f-e6-95-b0-e6-8d-ae-e8-bf-9b-e8-a1-8c-e5-88-86-e6-9e-90.html" class="post-title-link" itemprop="url">对排序数据进行分析</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-07-07 17:38:06" itemprop="dateCreated datePublished" datetime="2019-07-07T17:38:06+08:00">2019-07-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-05-10 03:27:05" itemprop="dateModified" datetime="2020-05-10T03:27:05+08:00">2020-05-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%B9%A6%E7%B1%8D%E6%96%87%E6%A1%A3/" itemprop="url" rel="index"><span itemprop="name">书籍文档</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan：</span>
    
    
      <a title="changyan" href="/zh-CN/2019/07/07/e5-af-b9-e6-8e-92-e5-ba-8f-e6-95-b0-e6-8d-ae-e8-bf-9b-e8-a1-8c-e5-88-86-e6-9e-90.html#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://www.fesugar.com/zh-CN/2019/07/07/e5-af-b9-e6-8e-92-e5-ba-8f-e6-95-b0-e6-8d-ae-e8-bf-9b-e8-a1-8c-e5-88-86-e6-9e-90.html" class="cy_cmt_count" data-xid="zh-CN/2019/07/07/e5-af-b9-e6-8e-92-e5-ba-8f-e6-95-b0-e6-8d-ae-e8-bf-9b-e8-a1-8c-e5-88-86-e6-9e-90.html" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>2.2k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>2 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="对排序数据进行分析"><a href="#对排序数据进行分析" class="headerlink" title="对排序数据进行分析"></a>对排序数据进行分析</h2><h3 id="实例说明"><a href="#实例说明" class="headerlink" title="实例说明"></a>实例说明</h3><p>使用图表显示统计信息时，数据量很大并且图表看起来会很杂乱。那么将图表按一定条件进行排序再显示给用户，这样可以解决数据量大、图表多、无法很快得到想要的信息这一棘手问题。本实例将通过柱形图对排序数据进行分析，实例运行效果如图1和图2所示。 <img data-src="https://cdn.fesugar.com/2019/07/2019-07-07-09371674.png" alt=""> 图1 升序排序 <img data-src="https://cdn.fesugar.com/2019/07/2019-07-07-09371763.png" alt=""> 图2 降序排序</p>
<h3 id="关键技术"><a href="#关键技术" class="headerlink" title="关键技术"></a>关键技术</h3><p>本实例实现的重点是如何通过SQL语句对数据进行排序，而在排完序之后，即可调用Graphics类的FillRectangle方法绘制柱形图。下面对本实例中用到的关键技术进行详细介绍。 SQL语句的语法在索引中的各列上支持关键字ASC（升序）和DESC（降序），默认为升序。如何使用关键字ASC（升序）和DESC（降序），请看下面的例子。将“tb_Rectangle”表，按销售量（t_Num字段）查询，显示出销售量最低的3种商品，代码如下： SELECT TOP 3 * FROM tb_Rectangle order by t_Num desc</p>
<h3 id="设计过程"><a href="#设计过程" class="headerlink" title="设计过程"></a>设计过程</h3><p>（1）打开Visual Studio 2008开发环境，新建一个Windows窗体应用程序，命名为AnalyseSortData。 （2）更改默认窗体Form1的Name属性为Frm_Main，在该窗体中添加一个Panel控件和两个Button控件，分别用来显示绘图结果和执行升序、降序绘图操作。 （3）程序主要代码如下：</p>
<p>private void ShowPic(string str)<br>{<br>    Conn();                                                        //打开数据库连接<br>    //生成SqlCommand对象<br>    using (cmd = new SqlCommand(“SELECT TOP 3 * FROM tb_Rectangle order by t_Num “ + str, con))<br>    {<br>        SqlDataReader dr = cmd.ExecuteReader();                                //创建SqlDataReader对象<br>        Bitmap bitM = new Bitmap(this.panel1.Width, this.panel1.Height);                //新建一张画布<br>        Graphics g = Graphics.FromImage(bitM);                                //创建Graphics对象用于绘图<br>        g.Clear(Color.White);                                            //设置画布背景<br>        for (int i = 0; i &lt; 5; i++)<br>        {<br>            g.DrawLine(new Pen(new SolidBrush(Color.Red), 2.0f), 50, this.panel1.Height - 20 - i * 20, this.panel1.Width - 40, this.panel1.Height - 20 - i * 20);                                                        //绘制水平线条<br>            g.DrawString(Convert.ToString(i * 100), new Font(“Times New Roman”, 10, FontStyle.Regular), new SolidBrush(Color.Black), 20, this.panel1.Height - 27 - i * 20);                                            //绘制商品上升数量<br>        }<br>        for (int j = 0; j &lt; 4; j++)<br>        {<br>            //绘制垂直线条<br>            g.DrawLine(new Pen(new SolidBrush(Color.Red), 1.0f), 50 + 40 * j, this.panel1.Height - 20, 50 + 40 * j, 50);<br>            if (dr.Read())<br>            {<br>                int x, y, w, h;                                            //声明变量存储坐标与宽高<br>                g.DrawString(dr[0].ToString(), new Font(“宋体”, 8, FontStyle.Regular), new SolidBrush(Color.Black), 76 + 40 * j, this.panel1.Height - 16);                                                            //绘制商品名称<br>                x = 78 + 40 * j;                                        //X坐标<br>//Y坐标<br>                y = this.panel1.Height - 20 - Convert.ToInt32((Convert.ToDouble(Convert.ToDouble(dr[1].ToString()) * 20 / 100)));<br>                w = 24;                                                //宽度<br>                h = Convert.ToInt32(Convert.ToDouble(dr[1].ToString()) * 20 / 100);            //高度<br>                g.FillRectangle(new SolidBrush(Color.FromArgb(56, 129, 78)), x, y, w, h);        //开始绘制柱形图<br>            }<br>        }<br>        if (str == “desc”)                                                //如果按降序排列<br>        {<br>            //绘制提示文字，提示商品是按降序排列的<br>            g.DrawString(“热卖前三名”, new Font(“宋体”, 9), new SolidBrush(Color.Red), this.panel1.Width / 2 - 26, 20);<br>        }<br>        else if (str == “asc”)                                            //如果按升序排列<br>        {<br>            //绘制提示文字，提示商品是按升序排列的<br>            g.DrawString(“热卖后三名”, new Font(“宋体”, 9), new SolidBrush(Color.Red), this.panel1.Width / 2 - 26, 20);<br>        }<br>        this.panel1.BackgroundImage = bitM;                                    //显示绘制的图形<br>    }<br>}</p>
<h3 id="秘笈心法"><a href="#秘笈心法" class="headerlink" title="秘笈心法"></a>秘笈心法</h3><p>心法领悟005：使用DrawString方法绘制文本。 DrawString方法用来在指定位置并且用指定的Brush和Font对象绘制指定的文本字符串。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.fesugar.com/zh-CN/2019/07/07/e5-88-a9-e7-94-a8-e6-8e-a7-e4-bb-b6-e5-ae-9e-e7-8e-b0-e6-9f-b1-e5-bd-a2-e5-9b-be-e5-88-86-e6-9e-90.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//cdn.fesugar.com/2019/04/2019-04-04-16060550-150x150.jpg">
      <meta itemprop="name" content="fesugar">
      <meta itemprop="description" content="个人博客，分享自己的实践脚印的互联网技术以及实际应用的日志<br/>|非专业人士；<br/>|三线小城市普通打工仔一名；<br/>|养家糊口不易~<br/>~~~~~">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="佛系糖果的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/zh-CN/2019/07/07/e5-88-a9-e7-94-a8-e6-8e-a7-e4-bb-b6-e5-ae-9e-e7-8e-b0-e6-9f-b1-e5-bd-a2-e5-9b-be-e5-88-86-e6-9e-90.html" class="post-title-link" itemprop="url">利用控件实现柱形图分析</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-07-07 17:36:01" itemprop="dateCreated datePublished" datetime="2019-07-07T17:36:01+08:00">2019-07-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-05-10 03:27:05" itemprop="dateModified" datetime="2020-05-10T03:27:05+08:00">2020-05-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/" itemprop="url" rel="index"><span itemprop="name">学习记录</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan：</span>
    
    
      <a title="changyan" href="/zh-CN/2019/07/07/e5-88-a9-e7-94-a8-e6-8e-a7-e4-bb-b6-e5-ae-9e-e7-8e-b0-e6-9f-b1-e5-bd-a2-e5-9b-be-e5-88-86-e6-9e-90.html#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://www.fesugar.com/zh-CN/2019/07/07/e5-88-a9-e7-94-a8-e6-8e-a7-e4-bb-b6-e5-ae-9e-e7-8e-b0-e6-9f-b1-e5-bd-a2-e5-9b-be-e5-88-86-e6-9e-90.html" class="cy_cmt_count" data-xid="zh-CN/2019/07/07/e5-88-a9-e7-94-a8-e6-8e-a7-e4-bb-b6-e5-ae-9e-e7-8e-b0-e6-9f-b1-e5-bd-a2-e5-9b-be-e5-88-86-e6-9e-90.html" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.8k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>2 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="利用控件实现柱形图分析"><a href="#利用控件实现柱形图分析" class="headerlink" title="利用控件实现柱形图分析"></a>利用控件实现柱形图分析</h2><h3 id="实例说明"><a href="#实例说明" class="headerlink" title="实例说明"></a>实例说明</h3><p>读者已了解通过GDI+来绘制图表方法，那么不用GDI+能不能实现图形显示的效果呢？答案是肯定的。本实例通过控件来完成柱形图统计功能，实例运行效果如图1所示。 <img data-src="https://cdn.fesugar.com/2019/07/2019-07-07-09351441.png" alt=""> 图1 利用控件实现柱形图分析</p>
<h3 id="关键技术"><a href="#关键技术" class="headerlink" title="关键技术"></a>关键技术</h3><p>实现动态分析数据信息时需要通过SQL语句查询要分析的数据信息，并且将查询出的字段赋给相应的变量，然后通过变量来控制控件的显示。由于分析结果为动态值，所以定义一个动态控件数组来存放信息。最后通过Controls类的Add方法将控件添加到窗体上。</p>
<h3 id="设计过程"><a href="#设计过程" class="headerlink" title="设计过程"></a>设计过程</h3><p>（1）打开Visual Studio 2008开发环境，新建一个Windows窗体应用程序，命名为ColumnByControl。 （2）更改默认窗体Form1的Name属性为Frm_Main。 （3）程序主要代码如下：</p>
<p>private void Frm_Main_Load(object sender, EventArgs e)<br>{<br>//创建一个SqlConnection对象<br>    using (SqlConnection con = new SqlConnection(“server=mrwxk\\wangxiaoke;uid=sa;pwd=;database=db_TomeOne”))<br>    {<br>        int XValse = 20;<br>        DataSet ds = new DataSet();                                //创建DataSet对象<br>        //创建SqlCommand对象<br>        SqlCommand cmd = new SqlCommand(“select * from tb_Rectangle select Sum(t_Num) from tb_Rectangle”, con);<br>        SqlDataAdapter da = new SqlDataAdapter();                        //创建SqlDataAdapter对象<br>        da.SelectCommand = cmd;<br>        da.Fill(ds);                                            //Fill方法填充DataSet<br>        Panel[] p = new Panel[ds.Tables[0].Rows.Count];                    //创建一个Panel数组<br>        int Values = Convert.ToInt32(ds.Tables[1].Rows[0][0].ToString());        //商品总数<br>        for (int i = 0; i &lt; ds.Tables[0].Rows.Count; i++)<br>        {<br>            ds.Tables[0].Rows[i][0].ToString();<br>            float f = Convert.ToInt32(ds.Tables[0].Rows[i][1].ToString());        //获取每个商品的数量<br>            Size s = new Size();                                    //创建Size对象<br>            s.Width = 30;                                    //设置柱形图宽度<br>            s.Height = Convert.ToInt32(f / Values * 200);                    //计算柱形图高度<br>            Point pint = new Point();                                //创建Point对象<br>            pint.X = XValse;                                    //x坐标<br>            pint.Y = this.Height - 50 - s.Height;                        //y坐标<br>            p[i] = new Panel();                                    //创建一个Panel对象<br>            p[i].Location = pint;                                //设置位置<br>            p[i].BackColor = Color.Red;                            //设置背景颜色<br>            p[i].Size = s;                                        //设置大小<br>            XValse += 40;                                    //设置Xvalse变量的值<br>            Label lbl = new Label();                                //创建Label对象<br>            lbl.Text = ds.Tables[0].Rows[i][0].ToString();                    //设置Label显示的文本<br>            lbl.Font = new Font(“宋体”, 9, FontStyle.Regular);                //设置Label的Font属性<br>            lbl.ForeColor = Color.White;                            //设置Label的ForeColor属性<br>            p[i].Controls.Add(lbl);                                //添加控件<br>            this.Controls.Add(p[i]);                                //将控件数组添加到当前容器中<br>        }<br>    }<br>}</p>
<h3 id="秘笈心法"><a href="#秘笈心法" class="headerlink" title="秘笈心法"></a>秘笈心法</h3><p>心法领悟006：有效回收对象资源！ 程序设计过程中，可以手动回收文件资源，但是使用using关键字则更为简洁友好。当using关键字下面的代码执行完毕后，将会自动将using小括号中创建的对象隐式转换为IDisposable接口类型，并调用接口方法Dispose释放对象资源。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.fesugar.com/zh-CN/2019/07/07/e5-9c-a8-e6-9f-b1-e5-bd-a2-e5-9b-be-e7-9a-84-e6-8c-87-e5-ae-9a-e4-bd-8d-e7-bd-ae-e6-98-be-e7-a4-ba-e8-af-b4-e6-98-8e-e6-96-87-e5-ad-97.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//cdn.fesugar.com/2019/04/2019-04-04-16060550-150x150.jpg">
      <meta itemprop="name" content="fesugar">
      <meta itemprop="description" content="个人博客，分享自己的实践脚印的互联网技术以及实际应用的日志<br/>|非专业人士；<br/>|三线小城市普通打工仔一名；<br/>|养家糊口不易~<br/>~~~~~">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="佛系糖果的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/zh-CN/2019/07/07/e5-9c-a8-e6-9f-b1-e5-bd-a2-e5-9b-be-e7-9a-84-e6-8c-87-e5-ae-9a-e4-bd-8d-e7-bd-ae-e6-98-be-e7-a4-ba-e8-af-b4-e6-98-8e-e6-96-87-e5-ad-97.html" class="post-title-link" itemprop="url">在柱形图的指定位置显示说明文字</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-07-07 17:33:33" itemprop="dateCreated datePublished" datetime="2019-07-07T17:33:33+08:00">2019-07-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-05-10 03:27:05" itemprop="dateModified" datetime="2020-05-10T03:27:05+08:00">2020-05-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%B9%A6%E7%B1%8D%E6%96%87%E6%A1%A3/" itemprop="url" rel="index"><span itemprop="name">书籍文档</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan：</span>
    
    
      <a title="changyan" href="/zh-CN/2019/07/07/e5-9c-a8-e6-9f-b1-e5-bd-a2-e5-9b-be-e7-9a-84-e6-8c-87-e5-ae-9a-e4-bd-8d-e7-bd-ae-e6-98-be-e7-a4-ba-e8-af-b4-e6-98-8e-e6-96-87-e5-ad-97.html#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://www.fesugar.com/zh-CN/2019/07/07/e5-9c-a8-e6-9f-b1-e5-bd-a2-e5-9b-be-e7-9a-84-e6-8c-87-e5-ae-9a-e4-bd-8d-e7-bd-ae-e6-98-be-e7-a4-ba-e8-af-b4-e6-98-8e-e6-96-87-e5-ad-97.html" class="cy_cmt_count" data-xid="zh-CN/2019/07/07/e5-9c-a8-e6-9f-b1-e5-bd-a2-e5-9b-be-e7-9a-84-e6-8c-87-e5-ae-9a-e4-bd-8d-e7-bd-ae-e6-98-be-e7-a4-ba-e8-af-b4-e6-98-8e-e6-96-87-e5-ad-97.html" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>2.1k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>2 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="在柱形图的指定位置显示说明文字"><a href="#在柱形图的指定位置显示说明文字" class="headerlink" title="在柱形图的指定位置显示说明文字"></a>在柱形图的指定位置显示说明文字</h2><h3 id="实例说明"><a href="#实例说明" class="headerlink" title="实例说明"></a>实例说明</h3><p>在实际中使用柱形图统计分析一些数据时，通常都会在柱形图上显示说明文字，以便能够让用户更清楚的了解统计分析的数据。本实例使用C#实现了在柱形图上绘制说明文字的功能，实例运行效果如图1所示。 <img data-src="https://cdn.fesugar.com/2019/07/2019-07-07-09322324.png" alt=""> 图1 在柱形图的指定位置显示说明文字</p>
<h3 id="关键技术"><a href="#关键技术" class="headerlink" title="关键技术"></a>关键技术</h3><p>本实例在绘制柱形图及柱形图上的文字时，主要用到了Graphics类的FillRectangle方法和DrawString方法，下面分别对它们进行详细讲解。 Graphics类的DrawString方法主要用于在指定位置用指定的Brush和Font对象绘制文本字符串，其语法格式如下。 public void DrawString(string s,Font font,Brush brush,PointF point) DrawString方法语法中的参数及说明如表1所示。 表1 DrawString方法语法中的参数及说明</p>
<p>参数</p>
<p>说明</p>
<p>s</p>
<p>要绘制的字符串</p>
<p>font</p>
<p>定义字符串的文本格式</p>
<p>brush</p>
<p>确定所绘制文本的颜色和纹理</p>
<p>point</p>
<p>指定所绘制文本的左上角</p>
<h3 id="设计过程"><a href="#设计过程" class="headerlink" title="设计过程"></a>设计过程</h3><p>（1）打开Visual Studio 2008开发环境，新建一个Windows窗体应用程序，命名为TextInColumn。 （2）更改默认窗体Form1的Name属性为Frm_Main，在该窗体中添加一个Panel控件，用于显示绘制的标有说明文字的柱形图。 （3）程序主要代码如下：</p>
<p>private void ShowPic()<br>{<br>    Conn();                                                    //打开数据库<br>    using (cmd = new SqlCommand(“SELECT TOP 3 * FROM tb_Rectangle order by t_Num desc”, con))<br>    {<br>        SqlDataReader dr = cmd.ExecuteReader();                            //创建SqlDataReader对象<br>        Bitmap bitM = new Bitmap(this.panel1.Width, this.panel1.Height);            //创建画布<br>        Graphics g = Graphics.FromImage(bitM);                            //创建Graphics对象<br>        Pen p = new Pen(new SolidBrush(Color.SlateGray), 1.0f);                    //创建Pen对象<br>        p.DashStyle= System.Drawing.Drawing2D.DashStyle.Dash;                //设置虚线<br>        g.Clear(Color.White);                                        //设置画布颜色<br>        for (int i = 0; i &lt; 5; i++)<br>        {<br>               //绘制水平线条<br>            g.DrawLine(p, 50, this.panel1.Height - 20 - i * 20, this.panel1.Width - 40, this.panel1.Height - 20 - i * 20);<br>            g.DrawString(Convert.ToString(i * 100), new Font(“Times New Roman”, 10, FontStyle.Regular), new SolidBrush(Color.Black), 20, this.panel1.Height - 27 - i * 20);                                        //绘制商品的增长值<br>        }<br>        for (int j = 0; j &lt; 4; j++)<br>        {<br>            g.DrawLine(p, 50 , this.panel1.Height - 20, 50, 20);                    //绘制垂直线条<br>            if (dr.Read())<br>            {<br>                int x, y, w, h;                                        //声明变量存储坐标和大小<br>                g.DrawString(dr[0].ToString(), new Font(“宋体”, 9, FontStyle.Regular), new SolidBrush(Color.Black), 76 + 40 * j, this.panel1.Height - 16);                                                        //绘制商品名称<br>                x = 78 + 40 * j;                                    //X坐标<br>//Y坐标<br>                y = this.panel1.Height - 20 - Convert.ToInt32((Convert.ToDouble(Convert.ToDouble(dr[1].ToString()) * 20 / 100)));<br>                w = 24;                                            //宽度<br>                h = Convert.ToInt32(Convert.ToDouble(dr[1].ToString()) * 20 / 100);        //高度<br>                g.FillRectangle(new SolidBrush(Color.SlateGray), x, y, w, h);            //绘制柱形图<br>//在柱形图指定的位置绘制文字<br>                g.DrawString((h*100/20).ToString(), new Font(“宋体”, 8,FontStyle.Bold), new SolidBrush(Color.Tomato), new Point(x+4,y-10));<br>            }<br>        }<br>        this.panel1.BackgroundImage = bitM;                                //显示绘制的图形<br>    }<br>}</p>
<h3 id="秘笈心法"><a href="#秘笈心法" class="headerlink" title="秘笈心法"></a>秘笈心法</h3><p>心法领悟007：FillRectangle方法的使用。 FillRectangle方法为可重载方法，它有4种重载形式，分别用来填充由Rectangle结构、RectangleF结构以及一对坐标、一个宽度、一个高度指定的矩形的内部。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.fesugar.com/zh-CN/2019/07/07/e5-88-a9-e7-94-a8-e6-8a-98-e7-ba-bf-e5-9b-be-e5-88-86-e6-9e-90-e4-ba-a7-e5-93-81-e9-94-80-e5-94-ae-e8-b5-b0-e5-8a-bf.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//cdn.fesugar.com/2019/04/2019-04-04-16060550-150x150.jpg">
      <meta itemprop="name" content="fesugar">
      <meta itemprop="description" content="个人博客，分享自己的实践脚印的互联网技术以及实际应用的日志<br/>|非专业人士；<br/>|三线小城市普通打工仔一名；<br/>|养家糊口不易~<br/>~~~~~">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="佛系糖果的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/zh-CN/2019/07/07/e5-88-a9-e7-94-a8-e6-8a-98-e7-ba-bf-e5-9b-be-e5-88-86-e6-9e-90-e4-ba-a7-e5-93-81-e9-94-80-e5-94-ae-e8-b5-b0-e5-8a-bf.html" class="post-title-link" itemprop="url">利用折线图分析产品销售走势</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-07-07 17:31:23" itemprop="dateCreated datePublished" datetime="2019-07-07T17:31:23+08:00">2019-07-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-05-10 03:27:05" itemprop="dateModified" datetime="2020-05-10T03:27:05+08:00">2020-05-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/" itemprop="url" rel="index"><span itemprop="name">学习记录</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan：</span>
    
    
      <a title="changyan" href="/zh-CN/2019/07/07/e5-88-a9-e7-94-a8-e6-8a-98-e7-ba-bf-e5-9b-be-e5-88-86-e6-9e-90-e4-ba-a7-e5-93-81-e9-94-80-e5-94-ae-e8-b5-b0-e5-8a-bf.html#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://www.fesugar.com/zh-CN/2019/07/07/e5-88-a9-e7-94-a8-e6-8a-98-e7-ba-bf-e5-9b-be-e5-88-86-e6-9e-90-e4-ba-a7-e5-93-81-e9-94-80-e5-94-ae-e8-b5-b0-e5-8a-bf.html" class="cy_cmt_count" data-xid="zh-CN/2019/07/07/e5-88-a9-e7-94-a8-e6-8a-98-e7-ba-bf-e5-9b-be-e5-88-86-e6-9e-90-e4-ba-a7-e5-93-81-e9-94-80-e5-94-ae-e8-b5-b0-e5-8a-bf.html" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>3k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>3 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="利用折线图分析产品销售走势"><a href="#利用折线图分析产品销售走势" class="headerlink" title="利用折线图分析产品销售走势"></a>利用折线图分析产品销售走势</h2><h3 id="实例说明"><a href="#实例说明" class="headerlink" title="实例说明"></a>实例说明</h3><p>在商品销售企业中商品的销售额是决策者最关心的，及时、清晰、准确的分析产品销售走势是每个商业企业所必需的。本实例通过对某地区白金市场进行统计分析近半年白金价格的走势，实例运行结果如图1所示。 <img data-src="https://cdn.fesugar.com/2019/07/2019-07-07-09292184.png" alt=""> 图1 利用折线图分析产品销售走势</p>
<h3 id="关键技术"><a href="#关键技术" class="headerlink" title="关键技术"></a>关键技术</h3><p>本实例实现时主要用到了Graphics类中的DrawLines方法、DrawLine方法和DrawString方法，下面对本实例中用到的关键技术进行详细介绍。 DrawLines方法用于绘制一系列连接一组Point结构的线段，其语法格式如下： public void DrawLines (Pen pen,Point[] points) 参数说明 pen：Pen，确定线段的颜色、宽度和样式。 points：Point结构数组，这些结构表示要连接的点。</p>
<h3 id="设计过程"><a href="#设计过程" class="headerlink" title="设计过程"></a>设计过程</h3><p>（1）打开Visual Studio 2008开发环境，新建一个Windows窗体应用程序，命名为GoodsSallTrend。 （2）更改默认窗体Form1的Name属性为Frm_Main，在该窗体中添加一个ComboBox控件，用来显示白金型号；添加一个Button控件，用来执行绘制折线图操作；添加一个Panel控件，用来显示描绘图；添加两个GroupBox控件，分别用来显示分析图和详细信息列表图。 （3）程序主要代码如下： 自定义DrowPic方法，用来绘制折线图来显示分析产品销售走势。代码如下：</p>
<p>private void DrowPic(string str)<br>{<br>    int MaxValue, MinValue;                                                //声明变量记录最大值和最小值<br>    using (cmd = new SqlCommand(“select Max(t_price) from tb_merchandise where t_name=’” + str + “‘“, con))<br>    {<br>        con.Open();                                                    //打开数据库连接<br>        MaxValue = Convert.ToInt16(cmd.ExecuteScalar());                                //获取最大值<br>        con.Close();                                                    //关闭数据库连接<br>    }<br>    using (cmd = new SqlCommand(“select Min(t_price) from tb_merchandise where t_name=’” + str + “‘“, con))<br>    {<br>        con.Open();                                                    //打开数据库连接<br>        MinValue = Convert.ToInt16(cmd.ExecuteScalar());                                //获取最小值<br>        con.Close();                                                    //关闭数据库连接<br>    }<br>    Graphics g = this.groupBox1.CreateGraphics();                                    //创建Graphics对象<br>    g.Clear(Color.SeaShell);                                                //设置背景<br>    Brush b = new SolidBrush(Color.Blue);                                        //创建Brush对象<br>    Font f = new Font(“Arial”, 9, FontStyle.Regular);                                    //创建Font对象<br>    Pen p=new Pen(b);                                                    //创建Pen对象<br>    using (sqlAda = new SqlDataAdapter(“select * from tb_merchandise where t_name=’” + str + “‘ order by t_date”, con))<br>    {<br>        ds = new DataSet();                                                //创建DataSet对象<br>        sqlAda.Fill(ds,”t_date”);                                                //Fill方法填充对象<br>        int M = MaxValue / 50+1;                                            //最大值<br>        int N = MinValue / 50;                                                //最小值<br>        int T = N;<br>       for(int i=0;i&lt;=M-N;i++)<br>       {<br>           g.DrawString(Convert.ToString(T * 50), f, b,0, 190 - 30 * i);<br>           g.DrawLine(p, 30, 200 - 30 * i, 260, 200 -30 * i);<br>           T++;<br>       }<br>       int Num = ds.Tables[0].Rows.Count;<br>       int[] Values = new int[Num];<br>       for (int C = 0; C &lt;Num; C++)<br>       {<br>           Values[C] =Convert.ToInt32(ds.Tables[0].Rows[C][3].ToString());<br>           g.DrawString(Convert.ToDateTime(ds.Tables[0].Rows[C][2].ToString()).Month + “月”, f, b, 30 * (C + 1)-10, 15);<br>           g.DrawLine(p, 30<em>(C+1), 200, 30</em>(C+1), 30);<br>       }<br>       Point[] P = new Point[Num];<br>       for (int i = 0; i &lt; Num; i++)<br>       {<br>           P[i].X=30<em>(i+1);<br>           P[i].Y = 290 - Convert.ToInt32(Values[i] / 50f</em> 30);<br>       }<br>       g.DrawLines(p, P);<br>    }<br>}<br>自定义DrowInfo方法，用来绘制提示信息来显示各种商品的出售情况。代码如下：<br>private void DrowInfo(string str)<br>{<br>    Graphics g = this.groupBox2.CreateGraphics();                                    //创建Graphics对象<br>    g.Clear(Color.SeaShell);                                                //设置背景颜色<br>    Brush b=new SolidBrush(Color.Blue);                                        //创建Brush对象<br>    Font f=new Font(“Arial”, 9, FontStyle.Regular);                                    //设置Font对象<br>    using (sqlAda = new SqlDataAdapter(“select * from tb_merchandise where t_name=’” + str + “‘ order by t_date”, con))<br>    {<br>        DataSet ds = new DataSet();                                            //创建DataSet对象<br>        sqlAda.Fill(ds, “tb_09”);                                                //Fill方法填充对象<br>        g.DrawString( “月份：       “ + “价格”, f, b, 10.0f,  25.0f);                        //绘制标题<br>        for (int i = 0; i &lt; ds.Tables[0].Rows.Count; i++)                                //绘制月份及相应的产品价格<br>        {<br>            int month=Convert.ToDateTime(ds.Tables[0].Rows[i][2].ToString()).Month;            //获取月份<br>            if (month &gt;= 10)<br>{<br>//绘制月份及价格<br>                g.DrawString(month + “月： “ + “『” + ds.Tables[0].Rows[i][3].ToString() + “ 』”, f, b, 10.0f, (i + 2) * 25.0f);<br>            }<br>            else<br>            {<br>                g.DrawString(“0”+month + “月： “ + “『” + ds.Tables[0].Rows[i][3].ToString() + “ 』”, f, b, 10.0f, (i + 2) * 25.0f);<br>            }<br>        }<br>    }<br>}</p>
<h3 id="秘笈心法"><a href="#秘笈心法" class="headerlink" title="秘笈心法"></a>秘笈心法</h3><p>心法领悟008：如何清空控件的背景色？ 清空控件背景色时，可以使用Graphics类的Clear方法来实现，例如，本实例中清空GroupBox控件的背景色的实现代码如下：</p>
<p>Graphics g = this.groupBox2.CreateGraphics();                                        //创建Graphics对象<br>g.Clear(Color.SeaShell);                                                    //设置背景颜色</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/8/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><span class="page-number current">9</span><a class="page-number" href="/page/10/">10</a><span class="space">&hellip;</span><a class="page-number" href="/page/14/">14</a><a class="extend next" rel="next" href="/page/10/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="fesugar"
      src="//cdn.fesugar.com/2019/04/2019-04-04-16060550-150x150.jpg">
  <p class="site-author-name" itemprop="name">fesugar</p>
  <div class="site-description" itemprop="description">个人博客，分享自己的实践脚印的互联网技术以及实际应用的日志<br/>|非专业人士；<br/>|三线小城市普通打工仔一名；<br/>|养家糊口不易~<br/>~~~~~</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">139</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">13</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/fesugar" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;fesugar" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:fesugar@fesugar.com" title="E-Mail → mailto:fesugar@fesugar.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="//weibo.com/u/1756351303" target="_blank" rel="noopener" title="Weibo → &#x2F;&#x2F;weibo.com&#x2F;u&#x2F;1756351303"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      友情链接
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="http://www.fesugar.com/" title="http:&#x2F;&#x2F;www.fesugar.com&#x2F;">甜甜糖博客</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://www.allenlan.com/" title="http:&#x2F;&#x2F;www.allenlan.com&#x2F;" rel="noopener" target="_blank">不忘初心</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://my.oschina.net/u/2955242" title="https:&#x2F;&#x2F;my.oschina.net&#x2F;u&#x2F;2955242" rel="noopener" target="_blank">fesugar</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://www.mxxia.com/" title="http:&#x2F;&#x2F;www.mxxia.com" rel="noopener" target="_blank">梦想霞博客</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        
  <div class="beian"><a href="http://www.beian.miit.gov.cn/" rel="noopener" target="_blank">苏ICP备15051349号-1 </a>
  </div>

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">fesugar</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">站点总字数：</span>
    <span title="站点总字数">380k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">5:45</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> 强力驱动
  </div>

        
<div class="busuanzi-count">
  <script data-pjax async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="//cdn.jsdelivr.net/npm/animejs@3.1.0/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/theme-next/theme-next-pjax@0/pjax.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/velocity-animate@1/velocity.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/velocity-animate@1/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>

  <script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[data-pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.dataset.pjax !== undefined) {
      script.dataset.pjax = '';
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});
</script>




  
  <script data-pjax>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>




  
<script src="/js/local-search.js"></script>











<script data-pjax>
if (document.querySelectorAll('pre.mermaid').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js', () => {
    mermaid.initialize({
      theme    : 'forest',
      logLevel : 3,
      flowchart: { curve     : 'linear' },
      gantt    : { axisFormat: '%m/%d/%Y' },
      sequence : { actorMargin: 50 }
    });
  }, window.mermaid);
}
</script>


    <div id="pjax">
  

  

  <script id="cy_cmt_num" src="https://changyan.sohu.com/upload/plugins/plugins.list.count.js?clientId=cys44eS01"></script>


    </div>
</body>
</html>
