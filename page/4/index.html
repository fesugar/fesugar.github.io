<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/pace-js@1/themes/blue/pace-theme-minimal.css">
  <script src="//cdn.jsdelivr.net/npm/pace-js@1/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"www.fesugar.com","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"always","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":true,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="个人博客，分享自己的实践脚印的互联网技术以及实际应用的日志|非专业人士；|三线小城市普通打工仔一名；|养家糊口不易~~~~~~">
<meta property="og:type" content="website">
<meta property="og:title" content="佛系糖果的博客">
<meta property="og:url" content="https://www.fesugar.com/page/4/index.html">
<meta property="og:site_name" content="佛系糖果的博客">
<meta property="og:description" content="个人博客，分享自己的实践脚印的互联网技术以及实际应用的日志|非专业人士；|三线小城市普通打工仔一名；|养家糊口不易~~~~~~">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="fesugar">
<meta property="article:tag" content="fesugar">
<meta property="article:tag" content="甜甜糖">
<meta property="article:tag" content="甜甜糖个人博客">
<meta property="article:tag" content="甜甜糖博客">
<meta property="article:tag" content="如何做个人博客网站">
<meta property="article:tag" content="严圣川">
<meta property="article:tag" content="严圣川个人网站">
<meta property="article:tag" content="佛系糖果">
<meta property="article:tag" content="小程序">
<meta property="article:tag" content="多线程c#">
<meta property="article:tag" content=".net">
<meta property="article:tag" content="c语言">
<meta property="article:tag" content="vb">
<meta property="article:tag" content="php">
<meta property="article:tag" content="小程序radio样式">
<meta property="article:tag" content="小程序开发">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://www.fesugar.com/page/4/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>佛系糖果的博客</title>
  


  <script data-pjax>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?c708aaffb3b844ecd872db5ea0e68d8f";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="佛系糖果的博客" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">佛系糖果的博客</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">行到水穷处，坐看云起时</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-knowledge">

    <a href="/categories/%E4%B9%A6%E7%B1%8D%E6%96%87%E6%A1%A3/" rel="section"><i class="fa fa-book fa-fw"></i>知识</a>

  </li>
        <li class="menu-item menu-item-study">

    <a href="/categories/%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/" rel="section"><i class="fa fa-edit fa-fw"></i>学习</a>

  </li>
        <li class="menu-item menu-item-guestbook">

    <a href="/guestbook/" rel="section"><i class="fa fa-comment fa-fw"></i>留言簿</a>

  </li>
        <li class="menu-item menu-item-weiyu">

    <a href="/weiyu/" rel="section"><i class="fa fa-eye fa-fw"></i>微语</a>

  </li>
        <li class="menu-item menu-item-disclaimer">

    <a href="/disclaimer/" rel="section"><i class="fa fa-bell fa-fw"></i>条款声明</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-coffee fa-fw"></i>关于</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <a href="https://github.com/fesugar" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.fesugar.com/zh-CN/2019/09/10/e5-90-91word-e6-96-87-e6-a1-a3-e4-b8-ad-e6-8f-92-e5-85-a5windows-e6-8e-a7-e4-bb-b6.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//cdn.fesugar.com/2019/04/2019-04-04-16060550-150x150.jpg">
      <meta itemprop="name" content="fesugar">
      <meta itemprop="description" content="个人博客，分享自己的实践脚印的互联网技术以及实际应用的日志<br/>|非专业人士；<br/>|三线小城市普通打工仔一名；<br/>|养家糊口不易~<br/>~~~~~">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="佛系糖果的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/zh-CN/2019/09/10/e5-90-91word-e6-96-87-e6-a1-a3-e4-b8-ad-e6-8f-92-e5-85-a5windows-e6-8e-a7-e4-bb-b6.html" class="post-title-link" itemprop="url">向Word文档中插入Windows控件</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-09-10 23:26:15" itemprop="dateCreated datePublished" datetime="2019-09-10T23:26:15+08:00">2019-09-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-05-10 03:27:05" itemprop="dateModified" datetime="2020-05-10T03:27:05+08:00">2020-05-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%B9%A6%E7%B1%8D%E6%96%87%E6%A1%A3/" itemprop="url" rel="index"><span itemprop="name">书籍文档</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan：</span>
    
    
      <a title="changyan" href="/zh-CN/2019/09/10/e5-90-91word-e6-96-87-e6-a1-a3-e4-b8-ad-e6-8f-92-e5-85-a5windows-e6-8e-a7-e4-bb-b6.html#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://www.fesugar.com/zh-CN/2019/09/10/e5-90-91word-e6-96-87-e6-a1-a3-e4-b8-ad-e6-8f-92-e5-85-a5windows-e6-8e-a7-e4-bb-b6.html" class="cy_cmt_count" data-xid="zh-CN/2019/09/10/e5-90-91word-e6-96-87-e6-a1-a3-e4-b8-ad-e6-8f-92-e5-85-a5windows-e6-8e-a7-e4-bb-b6.html" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.5k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="向Word文档中插入Windows控件"><a href="#向Word文档中插入Windows控件" class="headerlink" title="向Word文档中插入Windows控件"></a>向Word文档中插入Windows控件</h2><h3 id="实例说明"><a href="#实例说明" class="headerlink" title="实例说明"></a>实例说明</h3><p>Word是一个功能强大的文字处理软件，在Word文档中可以方便的对文字信息进行排版，也可以向文档中插入生动、直观的图片信息，本实例将会介绍一个有趣的功能，向Word文档中插入Windows控件，并且此控件还可以响应用户事件。比如，向Word文档中插入Button按钮，此按钮也可以响应用户的单击事件。实例运行效果如图1所示。</p>
<p><img data-src="https://cdn.fesugar.com/2019/09/091019_1525_WordWindo1.png" alt=""></p>
<p>图1 向Word文档中插入Windows控件</p>
<h3 id="关键技术"><a href="#关键技术" class="headerlink" title="关键技术"></a>关键技术</h3><p>本实例重点在于向读者介绍怎样使用Controls集合的AddButton方法向文档中插入Windows按钮控件，下面对本实例用到的关键技术进行详细讲解。 使用Controls集合的AddButton方法可以方便的向Word文档中插入按钮控件。AddButton的语法格式如下：</p>
<p>public Button AddButton(Range range, float width, float height, string name);</p>
<p>AddButton方法中的参数说明如表1所示。 表1 AddButton方法中的参数说明</p>
<p>参数</p>
<p>描述</p>
<p>range</p>
<p>将要插入Windows控件所在的范围</p>
<p>width</p>
<p>插入Windows控件的宽度</p>
<p>height</p>
<p>插入Windows控件的高度</p>
<p>name</p>
<p>插入Windows控件的名称</p>
<p>说明：实例中介绍了向Word文档中插入Windows控件的方法，当AddButton方法执行后将会向Word文档中插入Button按钮同时还会返回此Button对象的引用，可以通过设置此Button对象的属性和事件来控制Word文档中Button按钮的状态和事件。</p>
<h3 id="设计过程"><a href="#设计过程" class="headerlink" title="设计过程"></a>设计过程</h3><p>（1）打开Visual Studio 2008开发环境，选择文件菜单中的”新建”/“项目”，此时会弹出”新建项目”窗口，在”新建项目”窗口的”项目类型”中选择”Visual C#”/“Office”，在右侧模板中选择”Word 2003 文档”，并在名称中添写”InsertControl”，并选择项目保存位置，单击确定按钮新建项目。如图2所示。</p>
<p><img data-src="https://cdn.fesugar.com/2019/09/091019_1525_WordWindo2.png" alt="">)<img data-src="https://cdn.fesugar.com/2019/09/091019_1525_WordWindo3.png" alt="">)<img data-src="https://cdn.fesugar.com/2019/09/091019_1525_WordWindo4.png" alt="">)<img data-src="https://cdn.fesugar.com/2019/09/091019_1525_WordWindo5.png" alt="">)<img data-src="https://cdn.fesugar.com/2019/09/091019_1525_WordWindo6.png" alt="">)<img data-src="https://cdn.fesugar.com/2019/09/091019_1525_WordWindo7.png" alt="">)<img data-src="https://cdn.fesugar.com/2019/09/091019_1525_WordWindo8.png" alt="">)<img data-src="https://cdn.fesugar.com/2019/09/091019_1525_WordWindo9.png" alt="">)<img data-src="https://cdn.fesugar.com/2019/09/091019_1525_WordWindo10.png" alt="">)<img data-src="https://cdn.fesugar.com/2019/09/091019_1525_WordWindo11.png" alt="">)<img data-src="https://cdn.fesugar.com/2019/09/091019_1525_WordWindo12.png" alt="">)<img data-src="https://cdn.fesugar.com/2019/09/091019_1525_WordWindo13.png" alt="">)<img data-src="https://cdn.fesugar.com/2019/09/091019_1525_WordWindo14.png" alt=""></p>
<p>图2 在VS2008中创建Word 2003 文档</p>
<p>（2）在打开的Word文档中单击鼠标右键选择”查看代码”，在Startup事件中写入代码如下：</p>
<p>private void ThisDocument_Startup(object sender, System.EventArgs e)<br>{<br>    Word.Range P_Range1 = this.Paragraphs[1].Range;                                //得到文档范围<br>    Microsoft.Office.Tools.Word.Controls.Button P_btn =                                //向文档中添加按钮<br>    this.Controls.AddButton(P_Range1, 50, 20, “button1”);<br>    P_btn.Text = “Button按钮”;                                                //设置按钮文本<br>    P_btn.Height = 50;                                                    //设置按钮高度<br>    P_btn.Width = 100;                                                    //设置按钮宽度<br>    P_btn.Click += new EventHandler(P_btn_Click);                                    //添加单击事件<br>}</p>
<h3 id="秘笈心法"><a href="#秘笈心法" class="headerlink" title="秘笈心法"></a>秘笈心法</h3><p>心法领悟006：怎样向Word文档中插入多个Windows控件？ 使用Controls集合的AddButton方法可以向Word文档中添加Button按钮，同样的也可以使用其它方法向文档中添加多个Windows控件，如：使用AddTextBox方法可以向文档中添加文本框控件，使用AddDataGridView方法可以向文档中添加DataGridView控件。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.fesugar.com/zh-CN/2019/09/10/e5-b0-86-e4-b8-80-e4-b8-aaword-e6-96-87-e6-a1-a3-e5-88-86-e5-89-b2-e4-b8-ba-e5-a4-9a-e4-b8-aa-e5-b0-8f-e7-9a-84word-e6-96-87-e6-a1-a3-2.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//cdn.fesugar.com/2019/04/2019-04-04-16060550-150x150.jpg">
      <meta itemprop="name" content="fesugar">
      <meta itemprop="description" content="个人博客，分享自己的实践脚印的互联网技术以及实际应用的日志<br/>|非专业人士；<br/>|三线小城市普通打工仔一名；<br/>|养家糊口不易~<br/>~~~~~">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="佛系糖果的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/zh-CN/2019/09/10/e5-b0-86-e4-b8-80-e4-b8-aaword-e6-96-87-e6-a1-a3-e5-88-86-e5-89-b2-e4-b8-ba-e5-a4-9a-e4-b8-aa-e5-b0-8f-e7-9a-84word-e6-96-87-e6-a1-a3-2.html" class="post-title-link" itemprop="url">将一个Word文档分割为多个小的Word文档</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-09-10 23:23:17" itemprop="dateCreated datePublished" datetime="2019-09-10T23:23:17+08:00">2019-09-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-05-10 03:27:05" itemprop="dateModified" datetime="2020-05-10T03:27:05+08:00">2020-05-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%B9%A6%E7%B1%8D%E6%96%87%E6%A1%A3/" itemprop="url" rel="index"><span itemprop="name">书籍文档</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan：</span>
    
    
      <a title="changyan" href="/zh-CN/2019/09/10/e5-b0-86-e4-b8-80-e4-b8-aaword-e6-96-87-e6-a1-a3-e5-88-86-e5-89-b2-e4-b8-ba-e5-a4-9a-e4-b8-aa-e5-b0-8f-e7-9a-84word-e6-96-87-e6-a1-a3-2.html#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://www.fesugar.com/zh-CN/2019/09/10/e5-b0-86-e4-b8-80-e4-b8-aaword-e6-96-87-e6-a1-a3-e5-88-86-e5-89-b2-e4-b8-ba-e5-a4-9a-e4-b8-aa-e5-b0-8f-e7-9a-84word-e6-96-87-e6-a1-a3-2.html" class="cy_cmt_count" data-xid="zh-CN/2019/09/10/e5-b0-86-e4-b8-80-e4-b8-aaword-e6-96-87-e6-a1-a3-e5-88-86-e5-89-b2-e4-b8-ba-e5-a4-9a-e4-b8-aa-e5-b0-8f-e7-9a-84word-e6-96-87-e6-a1-a3-2.html" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>3.2k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>3 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="将一个Word文档分割为多个小的Word文档"><a href="#将一个Word文档分割为多个小的Word文档" class="headerlink" title="将一个Word文档分割为多个小的Word文档"></a>将一个Word文档分割为多个小的Word文档</h2><h3 id="实例说明"><a href="#实例说明" class="headerlink" title="实例说明"></a>实例说明</h3><p>将一个Word文档分割为多个文档的实现原理非常简单，首先，打开指定的Word文档并检查文档的信息，然后，跟据用户选择分割文档的方式来分割文档的内容，最后，指定的Word文档将会被分割成多个小的Word文档。实例运行效果如图1所示。</p>
<p><img data-src="https://cdn.fesugar.com/2019/09/091019_1522_Word1.png" alt=""></p>
<p>图1 将一个Word文档分割为多个小的Word文档 实例运行中单击”开始分割”按钮，会根据用户选择的方式分割Word文档，并生成多个Word文档。分割前的Word文档如图2所示。</p>
<p><img data-src="https://cdn.fesugar.com/2019/09/091019_1522_Word2.png" alt=""></p>
<p>图2 分割前的Word文档 实例运行中单击”开始分割”按钮，会根据用户选择的方式分割Word文档，并生成多个Word文档。分割后的Word文档如图3、4、5和6所示。</p>
<p><img data-src="https://cdn.fesugar.com/2019/09/091019_1522_Word3.png" alt=""></p>
<p>图3 分割后的第一个Word文档</p>
<p><img data-src="https://cdn.fesugar.com/2019/09/091019_1522_Word4.png" alt=""></p>
<p>图4 分割后的第二个Word文档</p>
<p><img data-src="https://cdn.fesugar.com/2019/09/091019_1522_Word5.png" alt=""></p>
<p>图5 分割后的第3个Word文档</p>
<p><img data-src="https://cdn.fesugar.com/2019/09/091019_1522_Word6.png" alt=""></p>
<p>图6 分割后的第4个Word文档</p>
<h3 id="关键技术"><a href="#关键技术" class="headerlink" title="关键技术"></a>关键技术</h3><p>本实例重点在于向读者介绍怎样使用Range对象的Copy方法和Paste方法轻松的复制和粘贴Word文档中的内容，下面对本实例用到的关键技术进行详细讲解。 Range对象表示Word文档中文档内容的一段范围，要复制Word文档中的内容首先要使用Range对象的Select方法选中将要复制的Range范围，选中范围后就可以使用Range对象的Copy方法将选中范围复制到系统剪切板。现在，文档中指定的内容已经被放入剪切板，在其它Word文档的Range对象中可以调用Paste方法方便的将剪切板的内容粘贴到Word文档中。</p>
<p>提示：由于Range对象的Copy方法是将文档指定内容放入系统剪切板，所以在执行Copy方法后，用户在操作系统中的其它文本编辑器中单击”鼠标右键”并选择”粘贴”，可以将剪切板中的内容手动粘贴到文本编辑器中，但是这样做是不友好的，在用户不知情的情况下在系统剪切板中放入大量内容是不对的，所以在使用Range对象的Copy和Paste方法后不要忘记使用Clipboard.Clear方法清空系统剪切板。</p>
<h3 id="设计过程"><a href="#设计过程" class="headerlink" title="设计过程"></a>设计过程</h3><p>（1）打开Visual Studio 2008开发环境，新建一个Windows窗体应用程序，命名为WordSplit。 （2）使用C#操作Word文档，需要引用相关的COM组件，引用COM组件的步骤请参照实例426中的设计过程。 （3）更改默认窗体Form1中的Name属性为Frm_Main，更改Text属性为”将一个Word文档分割为多个小的Word文档”，向窗体中添加两个TextBox控件，分别用于显示Word文档的打开位置和显示文档的保存位置；向窗体中添加3个Button按钮，3个按钮分别用于打开Word文档、选择文档的保存路径和分割文档。 （4）程序主要代码如下：</p>
<p>private void btn_Get_Click(object sender, EventArgs e)<br>{<br>    btn_split.Enabled = false;                                            //停用分割按钮<br>    ThreadPool.QueueUserWorkItem(                                        //开始线程池<br>    (pp) =&gt;                                                    //使用lambda表达式<br>{<br>        G_wa = new Microsoft.Office.Interop.Word.Application();                    //创建应用程序对象<br>    object P_OpenFileDialog = G_OpenFileDialog.FileName;                    //创建object对象<br>    Word.Document P_Document = G_wa.Documents.Open(                    //打开Word文档<br>    ref P_OpenFileDialog, ref G_missing, ref G_missing, ref G_missing<br>    , ref G_missing, ref G_missing, ref G_missing, ref G_missing<br>    , ref G_missing, ref G_missing, ref G_missing, ref G_missing<br>    , ref G_missing, ref G_missing, ref G_missing, ref G_missing);<br>        bool P_bl = false;                                            //定义布尔变量<br>    this.Invoke(                                                //调用窗体线程<br>    (MethodInvoker)(() =&gt;                                    //使用lambda表达式<br>{<br>        P_bl = cbox_Select.SelectedIndex == 0;<br>    }));<br>        if (P_bl)                                                //判断用什么方式分割文档<br>    {<br>            foreach (Word.Paragraph Paragraph in G_wa.ActiveDocument.Paragraphs)<br>            {<br>                Paragraph.Range.Select();                                //选择段落<br>            Paragraph.Range.Copy();                                //将段落放入剪切板<br>            AddFile();                                        //将剪切板数据放入文档<br>        }<br>        }<br>        else<br>        {<br>            Word.Range P_Range = G_wa.ActiveDocument.Content;                //得到文档区域<br>        int P_int_count = P_Range.Text.Length;                            //得到文档字符总长度<br>        int P_int_i = P_int_count / 100;                                //计算循环建立文档次数<br>        if (P_int_i &gt; 0)                                            //如果文字大于100个<br>        {<br>                for (int i = 0; i &lt; P_int_i; i++)                                //开始循环创建文档<br>            {<br>                    object P_o1 = i == 0 ? 0 : i * 100 + 1;                        //复制文档范围的开始部份<br>                object P_o2 = i * 100 + 101;                            //复制文档范围的结尾部份<br>                Word.Range P_Range_temp =                             //得到文档的范围<br>                G_wa.ActiveDocument.Range(ref P_o1, ref P_o2);<br>                    P_Range.Select();                                    //选中文档范围<br>                P_Range_temp.Copy();                                //将文档范围放入剪切板<br>                AddFile();                                        //将剪切板数据放入文档<br>            }<br>                object P_o11 = P_int_i * 100 + 1;                            //复制文档范围的开始部份<br>            Word.Range P_Range_temp1 =                             //得到文档的范围<br>            G_wa.ActiveDocument.Range(ref P_o11, ref G_missing);<br>                P_Range.Select();                                    //选中文档范围<br>            P_Range_temp1.Copy();                                //将内容放入剪切板<br>            AddFile();                                        //向新建文档中粘贴<br>        }<br>            else<br>            {<br>                Word.Range P_Range2 = G_wa.ActiveDocument.Content;             //得到文档区域<br>            P_Range.Select();                                    //选中文档范围<br>            P_Range2.Copy();                                    //将文档范围放入剪切板<br>            AddFile();                                        //将剪切板数据放入文档<br>        }<br>        }<br>    ((Word._Application)G_wa.Application).Quit(                            //退出应用程序<br>    ref G_missing, ref G_missing, ref G_missing);<br>        this.Invoke(                                                //调用窗体线程<br>    (MethodInvoker)(() =&gt;                                    //使用lambda表达式<br>{<br>        Clipboard.Clear();                                    //清空剪切板<br>    MessageBox.Show(“完成！”, “提示！”);                        //弹出消息对话框<br>    btn_split.Enabled = true;                                //启用分割按钮<br>}));<br>    });<br>}</p>
<h3 id="秘笈心法"><a href="#秘笈心法" class="headerlink" title="秘笈心法"></a>秘笈心法</h3><p>心法领悟009：轻松复制Word文档中的信息！ 如果复制Word文档中的信息，首先得到Word文档中将要复制内容的范围，然后通过Range对象的Select方法选中将要复制的内容，调用Range对象的Copy方法将指定的内容复制到系统剪切板，最后使用Paste方法将剪切板的内容粘贴到指定位置。要注意一点，在使用Range对象的Copy和Paste方法后不要忘记使用Clipboard.Clear方法清空剪切板中的内容。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.fesugar.com/zh-CN/2019/09/10/e5-b0-86-e4-b8-80-e4-b8-aaword-e6-96-87-e6-a1-a3-e5-88-86-e5-89-b2-e4-b8-ba-e5-a4-9a-e4-b8-aa-e5-b0-8f-e7-9a-84word-e6-96-87-e6-a1-a3.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//cdn.fesugar.com/2019/04/2019-04-04-16060550-150x150.jpg">
      <meta itemprop="name" content="fesugar">
      <meta itemprop="description" content="个人博客，分享自己的实践脚印的互联网技术以及实际应用的日志<br/>|非专业人士；<br/>|三线小城市普通打工仔一名；<br/>|养家糊口不易~<br/>~~~~~">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="佛系糖果的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/zh-CN/2019/09/10/e5-b0-86-e4-b8-80-e4-b8-aaword-e6-96-87-e6-a1-a3-e5-88-86-e5-89-b2-e4-b8-ba-e5-a4-9a-e4-b8-aa-e5-b0-8f-e7-9a-84word-e6-96-87-e6-a1-a3.html" class="post-title-link" itemprop="url">将一个Word文档分割为多个小的Word文档</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-09-10 14:39:02" itemprop="dateCreated datePublished" datetime="2019-09-10T14:39:02+08:00">2019-09-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-05-10 03:27:05" itemprop="dateModified" datetime="2020-05-10T03:27:05+08:00">2020-05-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%B9%A6%E7%B1%8D%E6%96%87%E6%A1%A3/" itemprop="url" rel="index"><span itemprop="name">书籍文档</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan：</span>
    
    
      <a title="changyan" href="/zh-CN/2019/09/10/e5-b0-86-e4-b8-80-e4-b8-aaword-e6-96-87-e6-a1-a3-e5-88-86-e5-89-b2-e4-b8-ba-e5-a4-9a-e4-b8-aa-e5-b0-8f-e7-9a-84word-e6-96-87-e6-a1-a3.html#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://www.fesugar.com/zh-CN/2019/09/10/e5-b0-86-e4-b8-80-e4-b8-aaword-e6-96-87-e6-a1-a3-e5-88-86-e5-89-b2-e4-b8-ba-e5-a4-9a-e4-b8-aa-e5-b0-8f-e7-9a-84word-e6-96-87-e6-a1-a3.html" class="cy_cmt_count" data-xid="zh-CN/2019/09/10/e5-b0-86-e4-b8-80-e4-b8-aaword-e6-96-87-e6-a1-a3-e5-88-86-e5-89-b2-e4-b8-ba-e5-a4-9a-e4-b8-aa-e5-b0-8f-e7-9a-84word-e6-96-87-e6-a1-a3.html" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>3.2k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>3 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="将一个Word文档分割为多个小的Word文档"><a href="#将一个Word文档分割为多个小的Word文档" class="headerlink" title="将一个Word文档分割为多个小的Word文档"></a>将一个Word文档分割为多个小的Word文档</h2><h3 id="实例说明"><a href="#实例说明" class="headerlink" title="实例说明"></a>实例说明</h3><p>将一个Word文档分割为多个文档的实现原理非常简单，首先，打开指定的Word文档并检查文档的信息，然后，跟据用户选择分割文档的方式来分割文档的内容，最后，指定的Word文档将会被分割成多个小的Word文档。实例运行效果如图1所示。</p>
<p><img data-src="https://cdn.fesugar.com/2019/09/091019_0638_Word1.png" alt=""></p>
<p>图1 将一个Word文档分割为多个小的Word文档 实例运行中单击”开始分割”按钮，会根据用户选择的方式分割Word文档，并生成多个Word文档。分割前的Word文档如图2所示。</p>
<p><img data-src="https://cdn.fesugar.com/2019/09/091019_0638_Word2.png" alt=""></p>
<p>图2 分割前的Word文档 实例运行中单击”开始分割”按钮，会根据用户选择的方式分割Word文档，并生成多个Word文档。分割后的Word文档如图3、4、5和6所示。</p>
<p><img data-src="https://cdn.fesugar.com/2019/09/091019_0638_Word3.png" alt=""></p>
<p>图3 分割后的第一个Word文档</p>
<p><img data-src="https://cdn.fesugar.com/2019/09/091019_0638_Word4.png" alt=""></p>
<p>图4 分割后的第二个Word文档</p>
<p><img data-src="https://cdn.fesugar.com/2019/09/091019_0638_Word5.png" alt=""></p>
<p>图5 分割后的第3个Word文档</p>
<p><img data-src="https://cdn.fesugar.com/2019/09/091019_0638_Word6.png" alt=""></p>
<p>图6 分割后的第4个Word文档</p>
<h3 id="关键技术"><a href="#关键技术" class="headerlink" title="关键技术"></a>关键技术</h3><p>本实例重点在于向读者介绍怎样使用Range对象的Copy方法和Paste方法轻松的复制和粘贴Word文档中的内容，下面对本实例用到的关键技术进行详细讲解。 Range对象表示Word文档中文档内容的一段范围，要复制Word文档中的内容首先要使用Range对象的Select方法选中将要复制的Range范围，选中范围后就可以使用Range对象的Copy方法将选中范围复制到系统剪切板。现在，文档中指定的内容已经被放入剪切板，在其它Word文档的Range对象中可以调用Paste方法方便的将剪切板的内容粘贴到Word文档中。</p>
<p>提示：由于Range对象的Copy方法是将文档指定内容放入系统剪切板，所以在执行Copy方法后，用户在操作系统中的其它文本编辑器中单击”鼠标右键”并选择”粘贴”，可以将剪切板中的内容手动粘贴到文本编辑器中，但是这样做是不友好的，在用户不知情的情况下在系统剪切板中放入大量内容是不对的，所以在使用Range对象的Copy和Paste方法后不要忘记使用Clipboard.Clear方法清空系统剪切板。</p>
<h3 id="设计过程"><a href="#设计过程" class="headerlink" title="设计过程"></a>设计过程</h3><p>（1）打开Visual Studio 2008开发环境，新建一个Windows窗体应用程序，命名为WordSplit。 （2）使用C#操作Word文档，需要引用相关的COM组件，引用COM组件的步骤请参照实例426中的设计过程。 （3）更改默认窗体Form1中的Name属性为Frm_Main，更改Text属性为”将一个Word文档分割为多个小的Word文档”，向窗体中添加两个TextBox控件，分别用于显示Word文档的打开位置和显示文档的保存位置；向窗体中添加3个Button按钮，3个按钮分别用于打开Word文档、选择文档的保存路径和分割文档。 （4）程序主要代码如下：</p>
<p>private void btn_Get_Click(object sender, EventArgs e)<br>{<br>    btn_split.Enabled = false;                                            //停用分割按钮<br>    ThreadPool.QueueUserWorkItem(                                        //开始线程池<br>        (pp) =&gt;                                                    //使用lambda表达式<br>        {<br>            G_wa = new Microsoft.Office.Interop.Word.Application();                    //创建应用程序对象<br>            object P_OpenFileDialog = G_OpenFileDialog.FileName;                    //创建object对象<br>            Word.Document P_Document = G_wa.Documents.Open(                    //打开Word文档<br>                ref P_OpenFileDialog, ref G_missing, ref G_missing, ref G_missing<br>                , ref G_missing, ref G_missing, ref G_missing, ref G_missing<br>                , ref G_missing, ref G_missing, ref G_missing, ref G_missing<br>                , ref G_missing, ref G_missing, ref G_missing, ref G_missing);<br>            bool P_bl = false;                                            //定义布尔变量<br>            this.Invoke(                                                //调用窗体线程<br>                 (MethodInvoker)(() =&gt;                                    //使用lambda表达式<br>                    {<br>                        P_bl = cbox_Select.SelectedIndex == 0;<br>                    }));<br>            if (P_bl)                                                //判断用什么方式分割文档<br>            {<br>                foreach (Word.Paragraph Paragraph in G_wa.ActiveDocument.Paragraphs)<br>                {<br>                    Paragraph.Range.Select();                                //选择段落<br>                    Paragraph.Range.Copy();                                //将段落放入剪切板<br>                    AddFile();                                        //将剪切板数据放入文档<br>                }<br>            }<br>            else<br>            {<br>                Word.Range P_Range = G_wa.ActiveDocument.Content;                //得到文档区域<br>                int P_int_count = P_Range.Text.Length;                            //得到文档字符总长度<br>                int P_int_i = P_int_count / 100;                                //计算循环建立文档次数<br>                if (P_int_i &gt; 0)                                            //如果文字大于100个<br>                {<br>                    for (int i = 0; i &lt; P_int_i; i++)                                //开始循环创建文档<br>                    {<br>                        object P_o1 = i == 0 ? 0 : i * 100 + 1;                        //复制文档范围的开始部份<br>                        object P_o2 = i * 100 + 101;                            //复制文档范围的结尾部份<br>                        Word.Range P_Range_temp =                             //得到文档的范围<br>                            G_wa.ActiveDocument.Range(ref P_o1, ref P_o2);<br>                        P_Range.Select();                                    //选中文档范围<br>                        P_Range_temp.Copy();                                //将文档范围放入剪切板<br>                        AddFile();                                        //将剪切板数据放入文档<br>                    }<br>                    object P_o11 = P_int_i * 100 + 1;                            //复制文档范围的开始部份<br>                    Word.Range P_Range_temp1 =                             //得到文档的范围<br>                        G_wa.ActiveDocument.Range(ref P_o11, ref G_missing);<br>                    P_Range.Select();                                    //选中文档范围<br>                    P_Range_temp1.Copy();                                //将内容放入剪切板<br>                    AddFile();                                        //向新建文档中粘贴<br>                }<br>                else<br>                {<br>                    Word.Range P_Range2 = G_wa.ActiveDocument.Content;             //得到文档区域<br>                    P_Range.Select();                                    //选中文档范围<br>                    P_Range2.Copy();                                    //将文档范围放入剪切板<br>                    AddFile();                                        //将剪切板数据放入文档<br>                }<br>            }<br>            ((Word._Application)G_wa.Application).Quit(                            //退出应用程序<br>                ref G_missing, ref G_missing, ref G_missing);<br>            this.Invoke(                                                //调用窗体线程<br>                (MethodInvoker)(() =&gt;                                    //使用lambda表达式<br>                {<br>                    Clipboard.Clear();                                    //清空剪切板<br>                    MessageBox.Show(“完成！”, “提示！”);                        //弹出消息对话框<br>                    btn_split.Enabled = true;                                //启用分割按钮<br>                }));<br>        });<br>}</p>
<h3 id="秘笈心法"><a href="#秘笈心法" class="headerlink" title="秘笈心法"></a>秘笈心法</h3><p>心法领悟009：轻松复制Word文档中的信息！ 如果复制Word文档中的信息，首先得到Word文档中将要复制内容的范围，然后通过Range对象的Select方法选中将要复制的内容，调用Range对象的Copy方法将指定的内容复制到系统剪切板，最后使用Paste方法将剪切板的内容粘贴到指定位置。要注意一点，在使用Range对象的Copy和Paste方法后不要忘记使用Clipboard.Clear方法清空剪切板中的内容。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.fesugar.com/zh-CN/2019/09/10/e5-b0-86-e5-a4-9a-e4-b8-aaword-e6-96-87-e6-a1-a3-e5-90-88-e5-b9-b6-e4-b8-ba-e4-b8-80-e4-b8-aaword-e6-96-87-e6-a1-a3.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//cdn.fesugar.com/2019/04/2019-04-04-16060550-150x150.jpg">
      <meta itemprop="name" content="fesugar">
      <meta itemprop="description" content="个人博客，分享自己的实践脚印的互联网技术以及实际应用的日志<br/>|非专业人士；<br/>|三线小城市普通打工仔一名；<br/>|养家糊口不易~<br/>~~~~~">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="佛系糖果的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/zh-CN/2019/09/10/e5-b0-86-e5-a4-9a-e4-b8-aaword-e6-96-87-e6-a1-a3-e5-90-88-e5-b9-b6-e4-b8-ba-e4-b8-80-e4-b8-aaword-e6-96-87-e6-a1-a3.html" class="post-title-link" itemprop="url">将多个Word文档合并为一个Word文档</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-09-10 14:34:24" itemprop="dateCreated datePublished" datetime="2019-09-10T14:34:24+08:00">2019-09-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-05-10 03:27:05" itemprop="dateModified" datetime="2020-05-10T03:27:05+08:00">2020-05-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%B9%A6%E7%B1%8D%E6%96%87%E6%A1%A3/" itemprop="url" rel="index"><span itemprop="name">书籍文档</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan：</span>
    
    
      <a title="changyan" href="/zh-CN/2019/09/10/e5-b0-86-e5-a4-9a-e4-b8-aaword-e6-96-87-e6-a1-a3-e5-90-88-e5-b9-b6-e4-b8-ba-e4-b8-80-e4-b8-aaword-e6-96-87-e6-a1-a3.html#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://www.fesugar.com/zh-CN/2019/09/10/e5-b0-86-e5-a4-9a-e4-b8-aaword-e6-96-87-e6-a1-a3-e5-90-88-e5-b9-b6-e4-b8-ba-e4-b8-80-e4-b8-aaword-e6-96-87-e6-a1-a3.html" class="cy_cmt_count" data-xid="zh-CN/2019/09/10/e5-b0-86-e5-a4-9a-e4-b8-aaword-e6-96-87-e6-a1-a3-e5-90-88-e5-b9-b6-e4-b8-ba-e4-b8-80-e4-b8-aaword-e6-96-87-e6-a1-a3.html" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>4k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>4 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="将多个Word文档合并为一个Word文档"><a href="#将多个Word文档合并为一个Word文档" class="headerlink" title="将多个Word文档合并为一个Word文档"></a>将多个Word文档合并为一个Word文档</h2><h3 id="实例说明"><a href="#实例说明" class="headerlink" title="实例说明"></a>实例说明</h3><p>将多个Word文档合并为一个Word文档，首先需要用户手动添加多个Word文档的集合，然后依次打开每一个Word文档，将每一个Word文档的全部内容复制到剪切板并粘贴到新建的Word文档中。实例运行效果如图1所示。</p>
<p><img data-src="https://cdn.fesugar.com/2019/09/091019_0633_WordW1.png" alt=""></p>
<p>图1 将多个Word文档合并为一个Word文档 实例运行中单击”选择”按钮，会将用户所选择Word文档的路径放入文件列表中，后期可以遍历文件列表将多个Word文档合并到一个Word文档中，合并前的多个Word文档如图2、3、4和5所示。</p>
<p><img data-src="https://cdn.fesugar.com/2019/09/091019_0633_WordW2.png" alt=""></p>
<p>图2 合并前的第一个Word文档</p>
<p><img data-src="https://cdn.fesugar.com/2019/09/091019_0633_WordW3.png" alt=""></p>
<p>图3 合并前的第二个Word文档</p>
<p><img data-src="https://cdn.fesugar.com/2019/09/091019_0633_WordW4.png" alt=""></p>
<p>图4 合并前的第3个Word文档</p>
<p><img data-src="https://cdn.fesugar.com/2019/09/091019_0633_WordW5.png" alt=""></p>
<p>图5 合并前的第4个Word文档 实例运行中单击”开始合并”按钮，会将用户选择的多个Word文档合并为一个Word文档，合并后的Word文档如图6所示。</p>
<p><img data-src="https://cdn.fesugar.com/2019/09/091019_0633_WordW6.png" alt=""></p>
<p>图6 合并后的Word文档</p>
<h3 id="关键技术"><a href="#关键技术" class="headerlink" title="关键技术"></a>关键技术</h3><p>本实例重点在于向读者介绍怎样将多个Word文档的内容合并为一个Word文档以及使用Documents对象的Open方法打开指定Word文档，下面对本实例用到的关键技术进行详细讲解。</p>
<p>说明：实例中用到了Range对象的Copy方法和Paste方法分别复制和粘贴Word文档中的内容。</p>
<p>（1）合并Word文档 将多个Word文档的内容合并为一个Word文档的实现方法很简单，首先创建并打开一个新的Word文档用于存放多个文档的内容，然后根据用户指定的Word文档路径的集合依次打开每一个Word文档，并将Word文档中的所有内容粘贴到新建Word文档中。 （2）Documents对象的Open方法 使用Documents对象的Open方法可以方便的打开Word文档，Open方法的语法格式如下：</p>
<p>Document Open(ref object FileName, ref object ConfirmConversions, ref object ReadOnly, ref object AddToRecentFiles, ref object PasswordDocument, ref object PasswordTemplate, ref object Revert, ref object WritePasswordDocument, ref object WritePasswordTemplate, ref object Format, ref object Encoding, ref object Visible, ref object OpenAndRepair, ref object DocumentDirection, ref object NoEncodingDialog, ref object XMLTransform);</p>
<p>Open方法中的参数说明如表1所示。 表1 Open方法中的参数说明</p>
<p>参数</p>
<p>描述</p>
<p>FileName</p>
<p>将要打开的Word文档名称及路径</p>
<p>ConfirmConversions</p>
<p>如果Open方法中FileName参数指定的不是Word格式文件，则需要将该参数设置为true，表示显示文件转换对话框</p>
<p>ReadOnly</p>
<p>是否以只读方式打开文档，默认值为false</p>
<p>AddToRecentFiles</p>
<p>是否将文件名称添加到文件菜单中的最近使用文件列表中，默认为true</p>
<p>PasswordDocument</p>
<p>如果文档有密码保护，可以使用此参数传递密码的字符串值，用于打开文档</p>
<p>PasswordTemplate</p>
<p>如果模板有密码保护，可以使用此参数传递密码的字符串值，用于打开模板</p>
<p>Revert</p>
<p>使用Open方法打开已经被打开的文档，如果此参数为true时，则放弃已打开文档中尚未保存的修改。如果此参数为false，则激活已打开文档</p>
<p>WritePasswordDocument</p>
<p>如果文档有密码保护，可以使用此参数传递密码的字符串值，用于保存文档</p>
<p>WritePasswordTemplate</p>
<p>如果模板有密码保护，可以使用此参数传递密码的字符串值，用于保存模板</p>
<p>Format</p>
<p>WdOpenFormat枚举类型参数，用于在打开文档时指定所使用的文件转换器</p>
<p>Encoding</p>
<p>Office.MsoEncoding枚举类型参数，用于指定打开文档时所使用的代码页或字符集</p>
<p>Visible</p>
<p>是否在可见窗口中打开文档，如果为true，则在可见窗口中打开，默认为true</p>
<p>OpenAndRepair</p>
<p>是否尝试修复损坏文档，true为修复</p>
<p>DocumentDirection</p>
<p>WdDocumentDirection枚举类型参数，用于指定已打开文档中文本的水平流动方式</p>
<p>NoEncodingDialog</p>
<p>如果为true，表示在不能确定文档编码方式时，阻止显示编码对话框</p>
<p>XMLTransform</p>
<p>XML转换格式</p>
<p>注意：Documents的Add方法中只有第一个参数FileName是必选的，其它参数都是可选参数。</p>
<h3 id="设计过程"><a href="#设计过程" class="headerlink" title="设计过程"></a>设计过程</h3><p>（1）打开Visual Studio 2008开发环境，新建一个Windows窗体应用程序，命名为WordMerge。 （2）使用C#操作Word文档，需要引用相关的COM组件，引用COM组件的步骤请参照实例426中的设计过程。 （3）更改默认窗体Form1中的Name属性为Frm_Main，更改Text属性为”将多个Word文档合并为一个Word文档”，向窗体中添加一个ListBox控件，此控件用于显示将要合并的Word文档的集合；向窗体中添加3个Button按钮，分别用于添加将要合并的Word文档、选择合并文档的保存位置和开始合并Word文档。 （4）程序主要代码如下：</p>
<p>private void btn_split_Click(object sender, EventArgs e)<br>{<br>    btn_Merge.Enabled = false;                                                //启用合并按钮<br>    ThreadPool.QueueUserWorkItem(                                            //开始线程池<br>        (pp) =&gt;                                                        //使用lambda表达式<br>        {<br>            G_wa = new Microsoft.Office.Interop.Word.Application();                        //创建应用程序对象<br>            Word.Document P_MainDocument =                                    //新建合并文档对象<br>                G_wa.Documents.Add(ref G_missing, ref G_missing<br>                , ref G_missing, ref G_missing);<br>            foreach (string P_Str in G_Str_Files)                                    //遍历文档的集合<br>            {<br>                object P_strs = P_Str;                                            //创建object对象<br>                Word.Document P_Document = G_wa.Documents.Open(                    //打开Word文档<br>                    ref P_strs, ref G_missing, ref G_missing, ref G_missing<br>                    , ref G_missing, ref G_missing, ref G_missing, ref G_missing<br>                    , ref G_missing, ref G_missing, ref G_missing, ref G_missing<br>                    , ref G_missing, ref G_missing, ref G_missing, ref G_missing);<br>                Word.Range P_Range_temp =                                     //得到文档全部范围<br>                    P_Document.Range(ref G_missing, ref G_missing);<br>                P_Range_temp.Select();                                        //选择文档全部范围<br>                P_Range_temp.Copy();                                        //复制文档全部范围<br>                Word.Range P_Range_temp2 =                                    //得到文档的范围<br>                    P_MainDocument.Range(ref G_missing, ref G_missing);<br>                object P_end= Word.WdCollapseDirection.wdCollapseEnd;                    //创建object对象<br>                P_Range_temp2.Collapse(ref P_end);                                //折叠文档范围<br>                P_Range_temp2.Select();                                        //选择档的最后位置<br>                P_Range_temp2.Paste();                                        //粘贴文档内容<br>                ((Word._Document)P_Document).Close(ref G_missing, ref G_missing,            //关闭文档<br>                    ref G_missing);<br>            }<br>            object P_SavePath=G_SaveFileDialog.FileName;                            //创建object对象<br>            P_MainDocument.SaveAs(                                        //保存合并后的文档<br>                ref P_SavePath, ref G_missing, ref G_missing, ref G_missing, ref G_missing,<br>                ref G_missing, ref G_missing, ref G_missing, ref G_missing, ref G_missing,<br>                ref G_missing, ref G_missing, ref G_missing, ref G_missing, ref G_missing,<br>                ref G_missing);<br>            ((Word._Application)G_wa.Application).Quit(                                //退出应用程序<br>                ref G_missing, ref G_missing, ref G_missing);<br>            this.Invoke(                                                    //调用窗体线程<br>                (MethodInvoker)(() =&gt;                                        //使用lambda表达式<br>                {<br>                    Clipboard.Clear();                                        //清空剪切板<br>                    MessageBox.Show(“成功合并Word文档！”, “提示！”);                    //弹出消息对话框<br>                    btn_Merge.Enabled = true;                                    //停用合并按钮<br>                }));<br>        });<br>}</p>
<h3 id="秘笈心法"><a href="#秘笈心法" class="headerlink" title="秘笈心法"></a>秘笈心法</h3><p>心法领悟010：以只读方式打开Word文档！ 本实例已经介绍了怎样使用Documents对象的Open方法方便的打开Word文档，如果想使用只读的方式打开Word文档，可以设置Open方法的第三个参数为true使文档以只读方式打开。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.fesugar.com/zh-CN/2019/08/27/e5-b0-86sql-server-e6-95-b0-e6-8d-ae-e6-9f-a5-e8-af-a2-e7-bb-93-e6-9e-9c-e8-be-93-e5-87-ba-e5-88-b0word.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//cdn.fesugar.com/2019/04/2019-04-04-16060550-150x150.jpg">
      <meta itemprop="name" content="fesugar">
      <meta itemprop="description" content="个人博客，分享自己的实践脚印的互联网技术以及实际应用的日志<br/>|非专业人士；<br/>|三线小城市普通打工仔一名；<br/>|养家糊口不易~<br/>~~~~~">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="佛系糖果的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/zh-CN/2019/08/27/e5-b0-86sql-server-e6-95-b0-e6-8d-ae-e6-9f-a5-e8-af-a2-e7-bb-93-e6-9e-9c-e8-be-93-e5-87-ba-e5-88-b0word.html" class="post-title-link" itemprop="url">将SQL Server数据查询结果输出到Word</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-08-27 11:20:28" itemprop="dateCreated datePublished" datetime="2019-08-27T11:20:28+08:00">2019-08-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-05-10 03:27:05" itemprop="dateModified" datetime="2020-05-10T03:27:05+08:00">2020-05-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%B9%A6%E7%B1%8D%E6%96%87%E6%A1%A3/" itemprop="url" rel="index"><span itemprop="name">书籍文档</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan：</span>
    
    
      <a title="changyan" href="/zh-CN/2019/08/27/e5-b0-86sql-server-e6-95-b0-e6-8d-ae-e6-9f-a5-e8-af-a2-e7-bb-93-e6-9e-9c-e8-be-93-e5-87-ba-e5-88-b0word.html#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://www.fesugar.com/zh-CN/2019/08/27/e5-b0-86sql-server-e6-95-b0-e6-8d-ae-e6-9f-a5-e8-af-a2-e7-bb-93-e6-9e-9c-e8-be-93-e5-87-ba-e5-88-b0word.html" class="cy_cmt_count" data-xid="zh-CN/2019/08/27/e5-b0-86sql-server-e6-95-b0-e6-8d-ae-e6-9f-a5-e8-af-a2-e7-bb-93-e6-9e-9c-e8-be-93-e5-87-ba-e5-88-b0word.html" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>2.6k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>2 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="将SQL-Server数据查询结果输出到Word"><a href="#将SQL-Server数据查询结果输出到Word" class="headerlink" title="将SQL Server数据查询结果输出到Word"></a>将SQL Server数据查询结果输出到Word</h2><h3 id="实例说明"><a href="#实例说明" class="headerlink" title="实例说明"></a>实例说明</h3><p>SQl Server数据库中存储着大量的数据，我们可以使用C#从数据库中取出数据信息，并处理这些信息。本实例将会介绍一种方法，将SQL Server中查询所得到的数据输出到Word文档。首先得到从SQL Server数据库中查询到的数据集合，然后将数据集合中的信息写入到Word文档中。实例运行效果如图1所示。 <img data-src="https://cdn.fesugar.com/2019/08/2019-08-27-03200074.png" alt=""> 图1 将SQL Server数据查询结果输出到Word 实例运行中单击“读取SQL数据并写入Word文档”按钮，此时会读取SQL Server中的数据到新创建的Word文档中，SQL Server中的数据如图2所示。被写入数据的Word文档如图3所示。 图2 SQL Server中的数据 图3 被写入数据的Word文档</p>
<h3 id="关键技术"><a href="#关键技术" class="headerlink" title="关键技术"></a>关键技术</h3><p>本实例重点在于向读者介绍怎样将SQL Server数据查询结果输出到Word，下面对本实例用到的关键技术进行详细讲解。 注意：如果操作SQL Server数据库，那么在代码中要引用SQL命名空间，如using System.Data.SqlClient，下面再次涉及到SQL Server的使用时，将不再提示。 要将SQL Server中的数据插入到Word，首先可以使用SqlDataAdapter对象填充DataTable，然后遍历DataTable中的数据并添加到数据集合，最后将数据集合中的数据写入到Word文档。</p>
<h3 id="设计过程"><a href="#设计过程" class="headerlink" title="设计过程"></a>设计过程</h3><p>（1）打开Visual Studio 2008开发环境，新建一个Windows窗体应用程序，命名为SQLToWord。 （2）使用C#操作Word文档，需要引用相关的COM组件，引用COM组件的步骤请参照实例“创建Word文档”中的设计过程。 （3）更改默认窗体Form1的Name属性为Frm_Main，更改Text属性为“将SQL Server数据查询结果输出到Word”，向窗体中添加4个TextBox控件，分别用于填写SQL服务器信息和显示Word文档保存路径；向窗体中添加3个Button按钮，分别用于选择Word文档保存路径、读取SQL数据并写入Word文档和显示Word文档。 （4）程序主要代码如下：</p>
<p>private void btn_New_Click(object sender, EventArgs e)<br>{<br>    btn_New.Enabled = false;                                    //停用新建按钮<br>    ThreadPool.QueueUserWorkItem(                                //开始线程池<br>        (pp) =&gt;                                            //使用lambda表达式<br>        {<br>            G_wa = new Microsoft.Office.Interop.Word.Application();            //创建应用程序对象<br>            object P_obj = “Normal.dot”;                            //定义文档模板<br>            Word.Document P_wd = G_wa.Documents.Add(                //创建Word文档<br>                ref P_obj, ref G_missing, ref G_missing, ref G_missing);<br>            Word.Range P_Range = P_wd.Range(                        //得到文档范围<br>                ref G_missing, ref G_missing);<br>            string P_Server = string.Empty;                            //定义字符串变量用于存放服务器信息<br>            string P_DataBase = string.Empty;                        //定义字符串变量用于存放数据库名称<br>            string P_UserName = string.Empty;                        //定义字符串变量用于存放用户名<br>            string P_PassWord = string.Empty;                        //定义字符串变量用于存放密码<br>            this.Invoke(<br>                (MethodInvoker)(() =&gt;<br>                {<br>                    P_Server = txt_Server.Text;                        //得到数据库服务器信息<br>                    P_DataBase = txt_DataBase.Text;                    //得到数据库名称<br>                    P_UserName = txt_UserName.Text;                    //得到数据库用户名<br>                    P_PassWord = txt_PassWord.Text;                    //得到数据库密码<br>                }));<br>            DataTier P_DataTier = new DataTier(                        //创建数据层对象<br>                P_Server, P_DataBase, P_UserName, P_PassWord);<br>            List<string> P_List_Str = P_DataTier.GetMessage();                //得到数据集合<br>            foreach (string P_str in P_List_Str)                        //遍历数据集合<br>            {<br>                P_Range.Text += P_str;                            //向文档中添加数据<br>            }<br>            G_str_path = string.Format(                            //计算文件保存路径<br>                @”{0}\{1}”, G_FolderBrowserDialog.SelectedPath,<br>                DateTime.Now.ToString(“yyyy年M月d日h时s分m秒fff毫秒”) + “.doc”);<br>            P_wd.SaveAs(                                    //保存Word文件<br>                ref G_str_path,<br>                ref G_missing, ref G_missing, ref G_missing, ref G_missing,<br>                ref G_missing, ref G_missing, ref G_missing, ref G_missing,<br>                ref G_missing, ref G_missing, ref G_missing, ref G_missing,<br>                ref G_missing, ref G_missing, ref G_missing);<br>            ((Word._Application)G_wa.Application).Quit(                    //退出应用程序<br>                ref G_missing, ref G_missing, ref G_missing);<br>            this.Invoke(                                        //调用窗体线程<br>                (MethodInvoker)(() =&gt;                            //使用lambda表达式<br>                {<br>                    MessageBox.Show(“成功创建Word文档！”, “提示！”);    //弹出消息对话框<br>                    btn_display.Enabled = true;                        //启用显示按钮<br>                }));<br>        });<br>}</p>
<h3 id="秘笈心法"><a href="#秘笈心法" class="headerlink" title="秘笈心法"></a>秘笈心法</h3><p>心法领悟015：使用Foreach循环方便的将字符串集合中的信息写入Word文档！ 现在，我们可以使用Range对象的Text属性轻松的向Word文档中写入文字信息，那么，怎样将字符串集合中的字符信息写入Word文档呢？可以使用Foreach遍历集合中的每一个字符串，并使用Range对象的Text属性将字符串信息添加到Word文档中。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.fesugar.com/zh-CN/2019/08/27/e5-b0-86xml-e4-b8-ad-e7-9a-84-e6-95-b0-e6-8d-ae-e8-af-bb-e5-8f-96-e5-88-b0word-e6-96-87-e6-a1-a3-e4-b8-ad.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//cdn.fesugar.com/2019/04/2019-04-04-16060550-150x150.jpg">
      <meta itemprop="name" content="fesugar">
      <meta itemprop="description" content="个人博客，分享自己的实践脚印的互联网技术以及实际应用的日志<br/>|非专业人士；<br/>|三线小城市普通打工仔一名；<br/>|养家糊口不易~<br/>~~~~~">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="佛系糖果的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/zh-CN/2019/08/27/e5-b0-86xml-e4-b8-ad-e7-9a-84-e6-95-b0-e6-8d-ae-e8-af-bb-e5-8f-96-e5-88-b0word-e6-96-87-e6-a1-a3-e4-b8-ad.html" class="post-title-link" itemprop="url">将XML中的数据读取到Word文档中</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-08-27 11:14:25" itemprop="dateCreated datePublished" datetime="2019-08-27T11:14:25+08:00">2019-08-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-05-10 03:27:05" itemprop="dateModified" datetime="2020-05-10T03:27:05+08:00">2020-05-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%B9%A6%E7%B1%8D%E6%96%87%E6%A1%A3/" itemprop="url" rel="index"><span itemprop="name">书籍文档</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan：</span>
    
    
      <a title="changyan" href="/zh-CN/2019/08/27/e5-b0-86xml-e4-b8-ad-e7-9a-84-e6-95-b0-e6-8d-ae-e8-af-bb-e5-8f-96-e5-88-b0word-e6-96-87-e6-a1-a3-e4-b8-ad.html#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://www.fesugar.com/zh-CN/2019/08/27/e5-b0-86xml-e4-b8-ad-e7-9a-84-e6-95-b0-e6-8d-ae-e8-af-bb-e5-8f-96-e5-88-b0word-e6-96-87-e6-a1-a3-e4-b8-ad.html" class="cy_cmt_count" data-xid="zh-CN/2019/08/27/e5-b0-86xml-e4-b8-ad-e7-9a-84-e6-95-b0-e6-8d-ae-e8-af-bb-e5-8f-96-e5-88-b0word-e6-96-87-e6-a1-a3-e4-b8-ad.html" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>2.7k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>2 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="将XML中的数据读取到Word文档中实例说明"><a href="#将XML中的数据读取到Word文档中实例说明" class="headerlink" title="将XML中的数据读取到Word文档中实例说明"></a><strong>将XML中的数据读取到Word文档中</strong>实例说明</h3><p>在程序设计过程中，我们经常用到XML（Extensible Markup Language 可扩展标记语言），XML是一种严谨的描述数据的语言，在C#中可以使用XmlReader和XmlDocument对象方便的读取XML文件的内容。在实例中将会使用XmlDocument对象读取指定XML文件内容，并将XML的文本内容写入到Word文档中。实例运行效果如图1所示。</p>
<p><img data-src="https://cdn.fesugar.com/2019/08/082719_0313_XMLWord1.png" alt=""></p>
<p>图1 将XML中的数据读取到Word文档中 实例运行中单击”读取XML内容并写入Word文档”按钮，此时会读取XML文档的内容到新创建的Word文档中，XML文档中的内容如图2所示。被写入数据的Word文档如图3所示。</p>
<p><img data-src="https://cdn.fesugar.com/2019/08/082719_0313_XMLWord2.png" alt=""></p>
<p>图2 XML文档内容</p>
<p><img data-src="https://cdn.fesugar.com/2019/08/082719_0313_XMLWord3.png" alt=""></p>
<p>图3 被写入XML信息的Word文档</p>
<h3 id="关键技术"><a href="#关键技术" class="headerlink" title="关键技术"></a>关键技术</h3><p>本实例重点在于向读者介绍怎样使用XmlDocument对象读取XML文档，并将文档的文本内容写入Word文档，下面对本实例用到的关键技术进行详细讲解。 引用了相应的命名空间后，我们可以使用XmlDocument对象轻松的读取Xml文档中的文本内容，XmlDocument对象的使用方法如图4所示。</p>
<p><img data-src="https://cdn.fesugar.com/2019/08/082719_0313_XMLWord4.png" alt=""></p>
<p>图4 使用XmlDocument对象读取XML文档信息 从图4中可以看到，首先创建XmlDocument对象，通过XmlDocument对象的Load方法载入XML文档，然后使用DocumentElement属性返回XmlElement根结点对象，通过根结点对象的ChildNodes属性得到根节点中所有子节点的集合，最后遍历子节点集合中的每一个子节点，从每一个子节点所包含的节点集合中得到相应的字符串信息。</p>
<h3 id="设计过程"><a href="#设计过程" class="headerlink" title="设计过程"></a>设计过程</h3><p>（1）打开Visual Studio 2008开发环境，新建一个Windows窗体应用程序，命名为XMLToWord。 （2）使用C#操作Word文档，需要引用相关的COM组件，引用COM组件的步骤请参照实例”创建Word文档”中的设计过程。 （3）更改默认窗体Form1的Name属性为Frm_Main，更改Text属性为”将XML中的数据读取到Word文档中”，向窗体中添加一个TextBox控件，用于显示Word文档保存路径；向窗体中添加3个Button按钮，分别用于选择Word文档保存路径、读取XML内容并写入Word文档和显示Word文档。 （4）程序主要代码如下：</p>
<p>private void btn_New_Click(object sender, EventArgs e)<br>{<br>    btn_New.Enabled = false;                                            //停用新建按钮<br>    ThreadPool.QueueUserWorkItem(                                        //使用线程池<br>        (P_temp) =&gt;                                                //使用lambda表达式<br>        {<br>            G_wa = new Word.Application();                                    //创建Word应用程序对象<br>            Word.Document P_wd = G_wa.Documents.Add(                        //建立新文档<br>                ref G_missing, ref G_missing, ref G_missing, ref G_missing);<br>            Word.Range P_Range = P_wd.Paragraphs[1].Range;                        //得到文档段落范围<br>            XmlDocument P_XML = new XmlDocument();                        //创建XML对象<br>            P_XML.Load(“test.xml”);                                        //打开XML文档<br>            XmlElement P_XmlElement = P_XML.DocumentElement;                    //得到XML根节点<br>            XmlNodeList P_XmlNodeList = P_XmlElement.ChildNodes;                    //得到子节点集合<br>            string P_Str_Message = string.Empty;                                //创建空字符串对象<br>            foreach (XmlNode xn in P_XmlNodeList)                            //遍历所有子节点<br>            {<br>                foreach (XmlNode xn2 in xn.ChildNodes)                            //遍历子节点中的节点<br>                {<br>                    P_Str_Message += xn2.InnerText + “\r\n”;                        //得到字符串信息<br>                }<br>            }<br>            P_Range.Text = P_Str_Message;                                    //向Word中添加字符串<br>            G_str_path = string.Format(                                    //计算文件保存路径<br>                @”{0}\{1}”, G_FolderBrowserDialog.SelectedPath,<br>                DateTime.Now.ToString(“yyyy年M月d日h时s分m秒fff毫秒”) + “.doc”);<br>            P_wd.SaveAs(                                            //保存Word文件<br>                ref G_str_path,<br>                ref G_missing, ref G_missing, ref G_missing, ref G_missing,<br>                ref G_missing, ref G_missing, ref G_missing, ref G_missing,<br>                ref G_missing, ref G_missing, ref G_missing, ref G_missing,<br>                ref G_missing, ref G_missing, ref G_missing);<br>            ((Word._Application)G_wa.Application).Quit(                            //退出应用程序<br>                ref G_missing, ref G_missing, ref G_missing);<br>            this.Invoke(                                                //开始执行窗体线程<br>                (MethodInvoker)(() =&gt;                                    //使用lambda表达式<br>                {<br>                    btn_Display.Enabled = true;                                //启用显示按钮<br>                    MessageBox.Show(“成功创建Word文档！”, “提示！”);                //弹出消息对话框<br>                }));<br>        });<br>}</p>
<h3 id="秘笈心法"><a href="#秘笈心法" class="headerlink" title="秘笈心法"></a>秘笈心法</h3><p>心法领悟016：使用XmlReader可以轻松读取XML文档的内容！ 使用XmlDocument可以通过节点和元素的方式轻松的读取XML文档中的信息，同样，也可以使用XmlReader通过游标的方式读取XML文档中的信息。XmlReader简单演示代码如下：</p>
<p>private void button2_Click(object sender, EventArgs e)<br>{<br>    XmlReader P_xr = XmlReader.Create(@”XML文档路径”);                        //创建XmlReader对象<br>    string P_str = string.Empty;                                            //创建空字符串对象<br>    while (P_xr.Read())                                                //读取下一个节点<br>    {<br>        if (P_xr.NodeType == XmlNodeType.Text)                                //判断节点类型<br>            P_str += P_xr.Value;                                        //添加字符串信息<br>    }<br>    MessageBox.Show(P_str,””);                                            //弹出消息对话框<br>}</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.fesugar.com/zh-CN/2019/08/27/e5-b0-86word-e4-b8-ad-e6-95-b0-e6-8d-ae-e5-88-86-e8-a7-a3-e5-88-b0-e5-a4-9a-e4-b8-aa-e6-96-87-e6-9c-ac-e6-96-87-e4-bb-b6-e4-b8-ad.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//cdn.fesugar.com/2019/04/2019-04-04-16060550-150x150.jpg">
      <meta itemprop="name" content="fesugar">
      <meta itemprop="description" content="个人博客，分享自己的实践脚印的互联网技术以及实际应用的日志<br/>|非专业人士；<br/>|三线小城市普通打工仔一名；<br/>|养家糊口不易~<br/>~~~~~">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="佛系糖果的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/zh-CN/2019/08/27/e5-b0-86word-e4-b8-ad-e6-95-b0-e6-8d-ae-e5-88-86-e8-a7-a3-e5-88-b0-e5-a4-9a-e4-b8-aa-e6-96-87-e6-9c-ac-e6-96-87-e4-bb-b6-e4-b8-ad.html" class="post-title-link" itemprop="url">将Word中数据分解到多个文本文件中</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-08-27 11:04:42" itemprop="dateCreated datePublished" datetime="2019-08-27T11:04:42+08:00">2019-08-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-05-10 03:27:05" itemprop="dateModified" datetime="2020-05-10T03:27:05+08:00">2020-05-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%B9%A6%E7%B1%8D%E6%96%87%E6%A1%A3/" itemprop="url" rel="index"><span itemprop="name">书籍文档</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan：</span>
    
    
      <a title="changyan" href="/zh-CN/2019/08/27/e5-b0-86word-e4-b8-ad-e6-95-b0-e6-8d-ae-e5-88-86-e8-a7-a3-e5-88-b0-e5-a4-9a-e4-b8-aa-e6-96-87-e6-9c-ac-e6-96-87-e4-bb-b6-e4-b8-ad.html#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://www.fesugar.com/zh-CN/2019/08/27/e5-b0-86word-e4-b8-ad-e6-95-b0-e6-8d-ae-e5-88-86-e8-a7-a3-e5-88-b0-e5-a4-9a-e4-b8-aa-e6-96-87-e6-9c-ac-e6-96-87-e4-bb-b6-e4-b8-ad.html" class="cy_cmt_count" data-xid="zh-CN/2019/08/27/e5-b0-86word-e4-b8-ad-e6-95-b0-e6-8d-ae-e5-88-86-e8-a7-a3-e5-88-b0-e5-a4-9a-e4-b8-aa-e6-96-87-e6-9c-ac-e6-96-87-e4-bb-b6-e4-b8-ad.html" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>2.7k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>2 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="将Word中数据分解到多个文本文件中"><a href="#将Word中数据分解到多个文本文件中" class="headerlink" title="将Word中数据分解到多个文本文件中"></a>将Word中数据分解到多个文本文件中</h2><h3 id="实例说明"><a href="#实例说明" class="headerlink" title="实例说明"></a>实例说明</h3><p>将Word中的数据分解到多个文本文件的实现方法非常简单，首先要读取Word文档中所有文本内容，然后根据用户选择分解Word文档的方式将Word文档分解为多个字符串，最后，使用StreamWriter将多个字符串分别写入到多个文本文件中，实例运行效果如图1所示。</p>
<p><img data-src="https://cdn.fesugar.com/2019/08/082719_0304_Word1.png" alt=""></p>
<p>图1 将Word中数据分解到多个文本文件中 实例运行中单击”开始分割”按钮，此时会读取Word文档中的文本内容并按照用户指定的方式分割到多个文本文件中，Word文档中的文本内容如图2所示。</p>
<p><img data-src="https://cdn.fesugar.com/2019/08/082719_0304_Word2.png" alt=""></p>
<p>图2 Word文档中的文本内容 实例运行中单击”开始分割”按钮，此时会读取Word文档中的文本内容并按照用户指定的方式分割到多个文本文件中，分割后的多个文本文件如图3、4、5和6所示。</p>
<p><img data-src="https://cdn.fesugar.com/2019/08/082719_0304_Word3.png" alt=""></p>
<p>图3 第一个文本文件中的文本内容</p>
<p><img data-src="https://cdn.fesugar.com/2019/08/082719_0304_Word4.png" alt=""></p>
<p>图4 第二个文本文件中的文本内容</p>
<p><img data-src="https://cdn.fesugar.com/2019/08/082719_0304_Word5.png" alt=""></p>
<p>图5 第3个文本文件中的文本内容</p>
<p><img data-src="https://cdn.fesugar.com/2019/08/082719_0304_Word6.png" alt=""></p>
<p>图6 第4个文本文件中的文本内容</p>
<h3 id="关键技术"><a href="#关键技术" class="headerlink" title="关键技术"></a>关键技术</h3><p>本实例重点在于向读者介绍怎样将Word中数据分解到多个文本文件中，下面对本实例用到的关键技术进行详细讲解。 如果将Word中的文本信息分解到多个文本文件中，首先应当根据用户指定的方式提取Word文档中的文本信息，并将文本信息保存到多个文本文件中。</p>
<h3 id="设计过程"><a href="#设计过程" class="headerlink" title="设计过程"></a>设计过程</h3><p>（1）打开Visual Studio 2008开发环境，新建一个Windows窗体应用程序，命名为WordToMulti-Txt。 （2）使用C#操作Word文档，需要引用相关的COM组件，引用COM组件的步骤请参照实例”创建Word文档”中的设计过程。 （3）更改默认窗体Form1的Name属性为Frm_Main，更改Text属性为”将Word中数据分解到多个文本文件中”，向窗体中添加两个TextBox控件，分别用于显示打开Word文档的路径和保存文本文件路径；向窗体中添加3个Button按钮，分别用于选择将要打开的Word文档、选择文本文件保存的路径和分解Word文档的内容到多个文本文件。 （4）程序主要代码如下：</p>
<p>private void btn_split_Click(object sender, EventArgs e)<br>{<br>    btn_split.Enabled = false;                                                //停用分解按钮<br>    ThreadPool.QueueUserWorkItem(                                            //开始线程池<br>        (pp) =&gt;                                                        //使用lambda表达式<br>        {<br>            G_wa = new Microsoft.Office.Interop.Word.Application();                        //创建应用程序对象<br>            object P_OpenFileDialog = G_OpenFileDialog.FileName;                         //创建object对象<br>            Word.Document P_Document = G_wa.Documents.Open(                        //打开Word文档<br>                ref P_OpenFileDialog, ref G_missing, ref G_missing, ref G_missing<br>                , ref G_missing, ref G_missing, ref G_missing, ref G_missing<br>                , ref G_missing, ref G_missing, ref G_missing, ref G_missing<br>                , ref G_missing, ref G_missing, ref G_missing, ref G_missing);<br>            bool P_bl = false;                                                //定义布尔变量<br>            this.Invoke(                                                    //调用窗体线程<br>                 (MethodInvoker)(() =&gt;                                        //使用lambda表达式<br>                 {<br>                     P_bl = cbox_Select.SelectedIndex == 0;<br>                 }));<br>            if (P_bl)                                                    //判断怎样分割文档<br>            {<br>                foreach (Word.Paragraph Paragraph in G_wa.ActiveDocument.Paragraphs)<br>                {<br>                    AddFile(Paragraph.Range.Text);                                //将文本写入文本文件<br>                }<br>            }<br>            else<br>            {<br>                Word.Range P_Range = G_wa.ActiveDocument.Content;                    //得到文档区域<br>                int P_int_count = P_Range.Text.Length;                                //得到文档字符总长度<br>                int P_int_i = P_int_count / 100;                                    //计算循环次数<br>                if (P_int_i &gt; 0)                                                //如果文字大于100个<br>                {<br>                    for (int i = 0; i &lt; P_int_i; i++)                                    //开始循环创建文档<br>                    {<br>                        object P_o1 = i == 0 ? 0 : i * 100 + 1;                            //复制范围的开始部份<br>                        object P_o2 = i * 100 + 101;                                //复制范围的结尾部份<br>                        Word.Range P_Range_temp =                                 //得到文档的范围<br>                            G_wa.ActiveDocument.Range(ref P_o1, ref P_o2);<br>                        AddFile(P_Range_temp.Text);                                //将文本写入文本文件<br>                    }<br>                    object P_o11 = P_int_i * 100 + 1;                                //复制范围的开始部份<br>                    Word.Range P_Range_temp1 =                                 //得到文档的范围<br>                        G_wa.ActiveDocument.Range(ref P_o11, ref G_missing);<br>                    AddFile(P_Range_temp1.Text);                                //将文本写入文本文件<br>                }<br>                else<br>                {<br>                    Word.Range P_Range2 = G_wa.ActiveDocument.Content;                    //得到文档区域<br>                    AddFile(P_Range2.Text);                                    //将文本写入文本文件<br>                }<br>            }<br>            ((Word._Application)G_wa.Application).Quit(                                //退出应用程序<br>                ref G_missing, ref G_missing, ref G_missing);<br>            this.Invoke(                                                    //调用窗体线程<br>                (MethodInvoker)(() =&gt;                                        //使用lambda表达式<br>                {<br>                    Clipboard.Clear();                                        //清空剪切板<br>                    MessageBox.Show(“成功分解Word文档！”, “提示！”);                    //弹出消息对话框<br>                    btn_split.Enabled = true;                                    //启用分解按钮<br>                }));<br>        });<br>}</p>
<h3 id="秘笈心法"><a href="#秘笈心法" class="headerlink" title="秘笈心法"></a>秘笈心法</h3><p>心法领悟018：使用DateTime.Now属性获取系统时间！ 使用DateTime.Now属性可以方便的获取系统时间，而且可以使用格式化方式方便的得到系统时间的字符串表示，代码如下：</p>
<p>string P_str = DateTime.Now.ToString(“yyyy年M月d日h时m分s秒fff毫秒”);</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.fesugar.com/zh-CN/2019/08/27/e5-ae-9e-e6-97-b6-e8-af-bb-e5-8f-96word-e6-96-87-e6-a1-a3-e4-b8-ad-e8-a1-a8-e6-a0-bc-e6-95-b0-e6-8d-ae-e5-88-b0sql-server-e6-95-b0-e6-8d-ae.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//cdn.fesugar.com/2019/04/2019-04-04-16060550-150x150.jpg">
      <meta itemprop="name" content="fesugar">
      <meta itemprop="description" content="个人博客，分享自己的实践脚印的互联网技术以及实际应用的日志<br/>|非专业人士；<br/>|三线小城市普通打工仔一名；<br/>|养家糊口不易~<br/>~~~~~">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="佛系糖果的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/zh-CN/2019/08/27/e5-ae-9e-e6-97-b6-e8-af-bb-e5-8f-96word-e6-96-87-e6-a1-a3-e4-b8-ad-e8-a1-a8-e6-a0-bc-e6-95-b0-e6-8d-ae-e5-88-b0sql-server-e6-95-b0-e6-8d-ae.html" class="post-title-link" itemprop="url">实时读取Word文档中表格数据到SQL Server数据</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-08-27 10:55:43" itemprop="dateCreated datePublished" datetime="2019-08-27T10:55:43+08:00">2019-08-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-05-10 03:27:05" itemprop="dateModified" datetime="2020-05-10T03:27:05+08:00">2020-05-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%B9%A6%E7%B1%8D%E6%96%87%E6%A1%A3/" itemprop="url" rel="index"><span itemprop="name">书籍文档</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan：</span>
    
    
      <a title="changyan" href="/zh-CN/2019/08/27/e5-ae-9e-e6-97-b6-e8-af-bb-e5-8f-96word-e6-96-87-e6-a1-a3-e4-b8-ad-e8-a1-a8-e6-a0-bc-e6-95-b0-e6-8d-ae-e5-88-b0sql-server-e6-95-b0-e6-8d-ae.html#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://www.fesugar.com/zh-CN/2019/08/27/e5-ae-9e-e6-97-b6-e8-af-bb-e5-8f-96word-e6-96-87-e6-a1-a3-e4-b8-ad-e8-a1-a8-e6-a0-bc-e6-95-b0-e6-8d-ae-e5-88-b0sql-server-e6-95-b0-e6-8d-ae.html" class="cy_cmt_count" data-xid="zh-CN/2019/08/27/e5-ae-9e-e6-97-b6-e8-af-bb-e5-8f-96word-e6-96-87-e6-a1-a3-e4-b8-ad-e8-a1-a8-e6-a0-bc-e6-95-b0-e6-8d-ae-e5-88-b0sql-server-e6-95-b0-e6-8d-ae.html" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.8k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>2 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="实时读取Word文档中表格数据到SQL-Server数据"><a href="#实时读取Word文档中表格数据到SQL-Server数据" class="headerlink" title="实时读取Word文档中表格数据到SQL Server数据"></a>实时读取Word文档中表格数据到SQL Server数据</h2><h3 id="实例说明"><a href="#实例说明" class="headerlink" title="实例说明"></a>实例说明</h3><p>在窗体编程中可以使用Timer组件按照指定的时间间隔重复执行相应的操作。实例中也可以使用Timer组件每隔一段时间检测Word文档表格中的数据是否与SQL Server数据库中的数据一致，如果不一致，则更新数据库中的数据。但是，Timer组件使用的是窗体线程，如果窗体线程频繁的进行文件操作可能会导致窗体无响应或卡机的现象，所以，在实例中使用了线程代替Timer组件，实时读取Word文档中表格数据到SQL Server数据库。实例运行效果如图1与2所示。 <img data-src="https://cdn.fesugar.com/2019/08/2019-08-27-02551413.png" alt=""> 图1 显示SQL中的数据 图2 实时读取Word文档中表格数据</p>
<h3 id="关键技术"><a href="#关键技术" class="headerlink" title="关键技术"></a>关键技术</h3><p>本实例重点在于向读者介绍使用多线程技术监控Word文档中表格的变化，并将表格中更新的信息同步到SQL Server数据库，下面对本实例用到的关键技术进行详细讲解。 说明：使用线程首先要引用命名空间：“using System.Threading”。下面再次涉及到线程的使用时，将不再提示。 实例中使用了多线程技术监控Word文档中表格的变化，多线程的使用方法如图3所示。 图3 多线程的使用方法 从图3中可以看到，创建线程非常简单，首先创建线程对象，线程对象的构造方法中接受一个方法做为参数，实例中使用了Lambda表达式来代替方法，然后设置线程为后台线程，这一句是可选的，默认创建的线程为前台线程。最后使用Start方法开始执行线程。 注意：如果线程执行中发现Word文档中表格内的数据与数据集合中的数据不一致，则会立即更新数据集合中的数据，然后将数据集合中的数据更新到SQL Server数据库，将数据集合中的数据更新到SQL Server数据库使用了非常简单的方法，首先“清空”数据库中指定数据表内的所有数据，然后将数据集合中的数据“全部添加”到数据表中。</p>
<h3 id="设计过程"><a href="#设计过程" class="headerlink" title="设计过程"></a>设计过程</h3><p>（1）打开Visual Studio 2008开发环境，新建一个Windows窗体应用程序，命名为Real-TimeToSQL。 （2）使用C#操作Word文档，需要引用相关的COM组件，引用COM组件的步骤请参照实例“创建Word文档”中的设计过程。 （3）更改默认窗体Form1的Name属性为Frm_Main，更改Text属性为“实时读取Word文档中表格数据到SQL Server数据库”，向窗体中添加4个TextBox控件，用于根据本地SQL设置填写SQL服务器连接信息；向窗体中添加一个Button按钮，用于跟踪Word文档的内容并将更新的内容同步到SQL数据库。 （4）程序主要代码如下：</p>
<p>private void btn_display_Click(object sender, EventArgs e)<br>{<br>    btn_display.Enabled = false;                                            //停用跟踪数据按钮<br>    ThreadPool.QueueUserWorkItem(                                        //开始线程池<br>        (pp) =&gt;                                                    //使用lambda表达式<br>        {<br>            G_wa = new Microsoft.Office.Interop.Word.Application();                    //创建应用程序对象<br>            G_wa.Visible = true;<br>            object P_Path = Directory.GetCurrentDirectory() + @”\Word.doc”;<br>            Word.Document P_Document = G_wa.Documents.Open(                    //打开Word文档<br>                ref P_Path, ref G_missing, ref G_missing, ref G_missing<br>                , ref G_missing, ref G_missing, ref G_missing, ref G_missing<br>                , ref G_missing, ref G_missing, ref G_missing, ref G_missing<br>                , ref G_missing, ref G_missing, ref G_missing, ref G_missing);<br>            TrackData();                                                //将Word数据更新到SQL<br>        });<br>}</p>
<h3 id="秘笈心法"><a href="#秘笈心法" class="headerlink" title="秘笈心法"></a>秘笈心法</h3><p>心法领悟021：使用线程代替Timer组件！ Timer组件可以按用户定义的时间间隔来引发Tick事件，Tick事件一般为周期性的，每隔若干秒或若干毫秒执行一次，Timer组件工作在窗体线程中，如果Timer组件中执行了较为耗时的操作，会增加窗体线程的负担，导致窗体中其它操作不能及时得到CPU资源，出现窗体长时间或短时间无响应的情况。在适当的情况下可以使用线程来代替Timer组件，这样会减少窗体线程的负担。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.fesugar.com/zh-CN/2019/08/25/e5-b0-86word-e6-96-87-e6-a1-a3-e8-bd-ac-e6-8d-a2-e4-b8-bahtml-e7-bd-91-e9-a1-b5.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//cdn.fesugar.com/2019/04/2019-04-04-16060550-150x150.jpg">
      <meta itemprop="name" content="fesugar">
      <meta itemprop="description" content="个人博客，分享自己的实践脚印的互联网技术以及实际应用的日志<br/>|非专业人士；<br/>|三线小城市普通打工仔一名；<br/>|养家糊口不易~<br/>~~~~~">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="佛系糖果的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/zh-CN/2019/08/25/e5-b0-86word-e6-96-87-e6-a1-a3-e8-bd-ac-e6-8d-a2-e4-b8-bahtml-e7-bd-91-e9-a1-b5.html" class="post-title-link" itemprop="url">将Word文档转换为HTML网页</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-08-25 09:33:47" itemprop="dateCreated datePublished" datetime="2019-08-25T09:33:47+08:00">2019-08-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-05-10 03:27:05" itemprop="dateModified" datetime="2020-05-10T03:27:05+08:00">2020-05-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%B9%A6%E7%B1%8D%E6%96%87%E6%A1%A3/" itemprop="url" rel="index"><span itemprop="name">书籍文档</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan：</span>
    
    
      <a title="changyan" href="/zh-CN/2019/08/25/e5-b0-86word-e6-96-87-e6-a1-a3-e8-bd-ac-e6-8d-a2-e4-b8-bahtml-e7-bd-91-e9-a1-b5.html#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://www.fesugar.com/zh-CN/2019/08/25/e5-b0-86word-e6-96-87-e6-a1-a3-e8-bd-ac-e6-8d-a2-e4-b8-bahtml-e7-bd-91-e9-a1-b5.html" class="cy_cmt_count" data-xid="zh-CN/2019/08/25/e5-b0-86word-e6-96-87-e6-a1-a3-e8-bd-ac-e6-8d-a2-e4-b8-bahtml-e7-bd-91-e9-a1-b5.html" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>3.7k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>3 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="将Word文档转换为HTML网页"><a href="#将Word文档转换为HTML网页" class="headerlink" title="将Word文档转换为HTML网页"></a>将Word文档转换为HTML网页</h2><h3 id="实例说明"><a href="#实例说明" class="headerlink" title="实例说明"></a>实例说明</h3><p>我们可以使用C#方便的读取Word文档中的文本内容，并将文本内容保存到文本文件，但是保存的文本内容是没有格式的，那么，有什么好的方法可以解决上面的问题吗？将Word文档的内容转换为HTML网页是一个不错的选择，本实例将介绍一种方法可以轻松的将Word文档转换为HTML网页。实例运行效果如图1所示。</p>
<p><img data-src="https://cdn.fesugar.com/2019/08/082519_0133_WordHTML1.png" alt=""></p>
<p>图1 将Word文档转换为HTML网页</p>
<p>实例运行中单击”打开Word文档”或”创建Word文档”按钮，此时会打开Word文档，用户可以手动向文档中添加文本信息如图2所示。单击”转换为HTML”按钮，可以将Word文档转换为HTML网页如图3所示。</p>
<p><img data-src="https://cdn.fesugar.com/2019/08/082519_0133_WordHTML2.png" alt=""></p>
<p>图2 Word文档中的文本内容</p>
<p><img data-src="https://cdn.fesugar.com/2019/08/082519_0133_WordHTML3.png" alt=""></p>
<p>图3 HTML网页中的文本内容</p>
<h3 id="关键技术"><a href="#关键技术" class="headerlink" title="关键技术"></a>关键技术</h3><p>本实例重点在于向读者介绍怎样使用Document对象的SaveAs方法将Word文档转换为HTML网页，下面对本实例用到的关键技术进行详细讲解。 在Word文档的操作过程中，我们经常可以使用SaveAs方法保存Word文档，实例中将会使用SaveAs方法将Word文档另存为HTML网页文件格式。SaveAs方法的语法格式如下：</p>
<p>public virtual void SaveAs(ref object FileName, ref object FileFormat, ref object LockComments, ref object Password, ref object AddToRecentFiles, ref object WritePassword, ref object ReadOnlyRecommended, ref object EmbedTrueTypeFonts, ref object SaveNativePictureFormat, ref object SaveFormsData, ref object SaveAsAOCELetter, ref object Encoding, ref object InsertLineBreaks, ref object AllowSubstitutions, ref object LineEnding, ref object AddBiDiMarks);</p>
<p>SaveAs方法中的参数说明如表1所示。 表1 SaveAs方法中的参数说明</p>
<p>参数</p>
<p>描述</p>
<p>FileName</p>
<p>代表文件名称及路径，如果已有FileName指定的文档，则覆盖此文档，而且在覆盖前不会提示</p>
<p>FileFormat</p>
<p>文档的保存格式。可以是WdSaveFormat枚举类型值</p>
<p>LockComments</p>
<p>如果为true，则锁定文档以进行注释。默认值为false</p>
<p>Password</p>
<p>打开文档的口令</p>
<p>AddToRecentFiles</p>
<p>如果为true，则将该文档添加到”文件”菜单上最近使用的文件列表中。默认值为true</p>
<p>WritePassword</p>
<p>如果为true，则将TrueType字体随文档一起保存</p>
<p>ReadOnlyRecommended</p>
<p>如果为true，则让Microsoft Office Word在打开文档时建议只读状态。默认值为false</p>
<p>EmbedTrueTypeFonts</p>
<p>如果为true，则将TrueType字体随文档一起保存</p>
<p>SaveNativePictureFormat</p>
<p>如果为true，则从其它系统平台（例如Macintosh）导入的图形仅保存其Windows版本</p>
<p>SaveFormsData</p>
<p>如果为true，则将用户在窗体中输入的数据另存为数据记录</p>
<p>SaveAsAOCELetter</p>
<p>如果文档包含一个附件，当此属性值为true时，将文档保存为一篇AOCE信函(同时保存邮件)</p>
<p>Encoding</p>
<p>要用于另存为编码文本文件的文档的代码页或字符集。默认值是系统代码页</p>
<p>InsertLineBreaks</p>
<p>如果文档另存为文本文件，则true表示在每行文本末尾插入分行符</p>
<p>AllowSubstitutions</p>
<p>如果文档另存为文本文件，则true允许Word将某些符号替换为外观与之类似的文本</p>
<p>LineEnding</p>
<p>参数为WdLineEndingType枚举类型值，Word在另存为文本文件的文档中标记分行符和换段符</p>
<p>AddBiDiMarks</p>
<p>如果为true，则向输出文件添加控制字符，以便保留原始文档中文本的双向布局</p>
<h3 id="设计过程"><a href="#设计过程" class="headerlink" title="设计过程"></a>设计过程</h3><p>（1）打开Visual Studio 2008开发环境，新建一个Windows窗体应用程序，命名为WordToHTML。 （2）使用C#操作Word文档，需要引用相关的COM组件，引用COM组件的步骤请参照实例”创建Word文档”中的设计过程。 （3）更改默认窗体Form1的Name属性为Frm_Main，更改Text属性为”将Word文档转换为HTML网页”，向窗体中添加3个Button按钮，分别用于打开Word文档、创建Word文档和将Word文档转换为HTML网页。 （4）程序主要代码如下：</p>
<p>private void btn_SaveAs_Click(object sender, EventArgs e)<br>{<br>    btn_SaveAs.Enabled = false;                                                //停用转换按钮<br>    try<br>    {<br>        G_wa.ActiveDocument.Save();                                            //保存文档<br>        ((Word._Application)G_wa.Application).Quit(                                //退出应用程序<br>          ref G_missing, ref G_missing, ref G_missing);<br>    }<br>    catch (Exception ex)<br>    {<br>        Console.WriteLine(ex.Message);<br>    }<br>    SaveFileDialog P_SaveFileDialog = new SaveFileDialog();                             //创建保存文件对话框<br>    P_SaveFileDialog.Filter = “<em>.html|</em>.html”;                                        //筛选文件扩展名<br>    DialogResult P_DialogResult = P_SaveFileDialog.ShowDialog();                         //打开保存文件对话框<br>    if (P_DialogResult == DialogResult.OK)                                        //判断是否保存文件<br>    {<br>        object P_str_path = P_SaveFileDialog.FileName;                                //创建object对象<br>        ThreadPool.QueueUserWorkItem(                                        //开始线程澉<br>            (pp) =&gt;                                                    //使用Lambda表达式<br>            {<br>                G_wa =                                                 //创建应用程序对象<br>                  new Microsoft.Office.Interop.Word.Application();<br>                G_wa.Visible = false;<br>                Word.Document P_wd = G_wa.Documents.Open(                        //打开Word文档<br>                   ref G_FilePath, ref G_missing, ref G_missing, ref G_missing, ref G_missing,<br>                   ref G_missing, ref G_missing, ref G_missing, ref G_missing, ref G_missing,<br>                   ref G_missing, ref G_missing, ref G_missing, ref G_missing, ref G_missing,<br>                   ref G_missing);<br>                object P_Format = Word.WdSaveFormat.wdFormatHTML;                    //创建保存文档参数<br>                P_wd.SaveAs(                                                //保存Word文件<br>                    ref P_str_path,<br>                    ref P_Format, ref G_missing, ref G_missing, ref G_missing,<br>                    ref G_missing, ref G_missing, ref G_missing, ref G_missing,<br>                    ref G_missing, ref G_missing, ref G_missing, ref G_missing,<br>                    ref G_missing, ref G_missing, ref G_missing);<br>                ((Word._Application)G_wa.Application).Quit(                            //退出应用程序<br>                    ref G_missing, ref G_missing, ref G_missing);<br>                this.Invoke(                                                //调用窗体线程<br>                    (MethodInvoker)(() =&gt;                                        //使用lambda表达式<br>                    {<br>                        btn_Open.Enabled = true;                                    //启用打开按钮<br>                        btn_New.Enabled = true;                                    //启用新建按钮<br>                        MessageBox.Show(“文件已经创建”, “提示！”);                    //提示已经创建Word<br>                    }));<br>            });<br>    }<br>}</p>
<h3 id="秘笈心法"><a href="#秘笈心法" class="headerlink" title="秘笈心法"></a>秘笈心法</h3><p>心法领悟023：将Word转换为rtf文档！ 实例中详细的介绍了怎样使用Dcoument对象的SaveAs方法，将Word文档转换为HTML网页。SaveAs方法还可以将Word文档轻松的转换为rtf文档。只要将实例中的代码：</p>
<p>object P_Format = Word.WdSaveFormat.wdFormatHTML;</p>
<p>替换为：</p>
<pre><code>object P_Format = Word.WdSaveFormat.wdFormatRTF;</code></pre><p>并相应的更改保存文件的扩展名即可！</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.fesugar.com/zh-CN/2019/08/25/e5-9c-a8-e6-89-93-e5-8d-b0-e9-a2-84-e8-a7-88-e4-b8-ad-e6-98-be-e7-a4-baword-e6-96-87-e6-a1-a3.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//cdn.fesugar.com/2019/04/2019-04-04-16060550-150x150.jpg">
      <meta itemprop="name" content="fesugar">
      <meta itemprop="description" content="个人博客，分享自己的实践脚印的互联网技术以及实际应用的日志<br/>|非专业人士；<br/>|三线小城市普通打工仔一名；<br/>|养家糊口不易~<br/>~~~~~">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="佛系糖果的博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/zh-CN/2019/08/25/e5-9c-a8-e6-89-93-e5-8d-b0-e9-a2-84-e8-a7-88-e4-b8-ad-e6-98-be-e7-a4-baword-e6-96-87-e6-a1-a3.html" class="post-title-link" itemprop="url">在打印预览中显示Word文档</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-08-25 09:32:36" itemprop="dateCreated datePublished" datetime="2019-08-25T09:32:36+08:00">2019-08-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-05-10 03:27:05" itemprop="dateModified" datetime="2020-05-10T03:27:05+08:00">2020-05-10</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%B9%A6%E7%B1%8D%E6%96%87%E6%A1%A3/" itemprop="url" rel="index"><span itemprop="name">书籍文档</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan：</span>
    
    
      <a title="changyan" href="/zh-CN/2019/08/25/e5-9c-a8-e6-89-93-e5-8d-b0-e9-a2-84-e8-a7-88-e4-b8-ad-e6-98-be-e7-a4-baword-e6-96-87-e6-a1-a3.html#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://www.fesugar.com/zh-CN/2019/08/25/e5-9c-a8-e6-89-93-e5-8d-b0-e9-a2-84-e8-a7-88-e4-b8-ad-e6-98-be-e7-a4-baword-e6-96-87-e6-a1-a3.html" class="cy_cmt_count" data-xid="zh-CN/2019/08/25/e5-9c-a8-e6-89-93-e5-8d-b0-e9-a2-84-e8-a7-88-e4-b8-ad-e6-98-be-e7-a4-baword-e6-96-87-e6-a1-a3.html" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.5k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="在打印预览中显示Word文档"><a href="#在打印预览中显示Word文档" class="headerlink" title="在打印预览中显示Word文档"></a>在打印预览中显示Word文档</h2><h3 id="实例说明"><a href="#实例说明" class="headerlink" title="实例说明"></a>实例说明</h3><p>在打印Word文档之前，我们经常会使用打印预览功能预览打印效果，实例中将会介绍一种方法，可以方便的打开Word文档，打开文档的同时也会打开文档的打印预览。实例运行效果如图1所示。 <img data-src="https://cdn.fesugar.com/2019/08/2019-08-25-01321219.png" alt=""> 图1 在打印预览中显示Word文档 实例运行中单击“打开Word文档并预览”按钮，此时会打开Word文档并启用预览功能，如图2所示。 图2 启用打印预览功能的Word文档</p>
<h3 id="关键技术"><a href="#关键技术" class="headerlink" title="关键技术"></a>关键技术</h3><p>本实例重点在于向读者介绍使用PrintPreview方法在打印预览窗体中显示Word文档，下面对本实例用到的关键技术进行详细讲解。 在打开Word文档后，我们可以使用Document文档对象的PrintPreview方法轻松的显示打印预览窗体。在打印预览窗体中，我们可以方便的调节显示比例，清晰直观的预览Word文档的打印信息。 说明：由于打印预览是在Word文档中运行的，所以在使用PrintPreview方法打开打印预览窗口前，首先要使用Document对象的Open方法打开Word文档。</p>
<h3 id="设计过程"><a href="#设计过程" class="headerlink" title="设计过程"></a>设计过程</h3><p>（1）打开Visual Studio 2008开发环境，新建一个Windows窗体应用程序，命名为WordPreView。 （2）使用C#操作Word文档，需要引用相关的COM组件，引用COM组件的步骤请参照实例426中的设计过程。 （3）更改默认窗体Form1的Name属性为Frm_Main，更改Text属性为“在打印预览中显示Word文档”，向窗体中添加一个TextBox控件，用于显示打开Word文档的路径；向窗体中添加两个Button按钮，分别用于浏览Word文档和打开并预览Word文档。 （4）程序主要代码如下：</p>
<p>private void btn_Open_Click(object sender, EventArgs e)<br>{<br>    btn_Open.Enabled = false;                                            //停用打开按钮<br>    ThreadPool.QueueUserWorkItem(                                        //开始线程池<br>        (pp) =&gt;                                                    //使用lambda表达式<br>        {<br>            G_wa = new Microsoft.Office.Interop.Word.Application();                     //创建应用程序对象<br>            G_wa.Visible = true;                                        //将文档设置为可见<br>            object P_FileName = G_OpenFileDialog.FileName;                        //设置打开文档参数<br>            Word.Document P_Document = G_wa.Documents.Open(                    //打开Word文档<br>                ref P_FileName, ref G_missing, ref G_missing, ref G_missing, ref G_missing,<br>                ref G_missing, ref G_missing, ref G_missing, ref G_missing, ref G_missing,<br>                ref G_missing, ref G_missing, ref G_missing, ref G_missing, ref G_missing,<br>                ref G_missing);<br>            P_Document.PrintPreview();                                    //打开预览窗口<br>        });<br>}</p>
<h3 id="秘笈心法"><a href="#秘笈心法" class="headerlink" title="秘笈心法"></a>秘笈心法</h3><p>心法领悟024：方便的使用Word文档的打印预览功能！ 在Word文档的操作过程中，我们可以使用Document文档对象的PrintPreview方法轻松的显示打印预览页面，由于打印预览是在Word文档中运行的，所以在使用PrintPreview方法打开打印预览窗口前，首先要使用Document对象的Open方法打开Word文档。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/14/">14</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="fesugar"
      src="//cdn.fesugar.com/2019/04/2019-04-04-16060550-150x150.jpg">
  <p class="site-author-name" itemprop="name">fesugar</p>
  <div class="site-description" itemprop="description">个人博客，分享自己的实践脚印的互联网技术以及实际应用的日志<br/>|非专业人士；<br/>|三线小城市普通打工仔一名；<br/>|养家糊口不易~<br/>~~~~~</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">139</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">13</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/fesugar" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;fesugar" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:fesugar@fesugar.com" title="E-Mail → mailto:fesugar@fesugar.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="//weibo.com/u/1756351303" target="_blank" rel="noopener" title="Weibo → &#x2F;&#x2F;weibo.com&#x2F;u&#x2F;1756351303"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      友情链接
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="http://www.fesugar.com/" title="http:&#x2F;&#x2F;www.fesugar.com&#x2F;">甜甜糖博客</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://www.allenlan.com/" title="http:&#x2F;&#x2F;www.allenlan.com&#x2F;" rel="noopener" target="_blank">不忘初心</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://my.oschina.net/u/2955242" title="https:&#x2F;&#x2F;my.oschina.net&#x2F;u&#x2F;2955242" rel="noopener" target="_blank">fesugar</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://www.mxxia.com/" title="http:&#x2F;&#x2F;www.mxxia.com" rel="noopener" target="_blank">梦想霞博客</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        
  <div class="beian"><a href="http://www.beian.miit.gov.cn/" rel="noopener" target="_blank">苏ICP备15051349号-1 </a>
  </div>

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">fesugar</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">站点总字数：</span>
    <span title="站点总字数">380k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">5:45</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> 强力驱动
  </div>

        
<div class="busuanzi-count">
  <script data-pjax async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="//cdn.jsdelivr.net/npm/animejs@3.1.0/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/theme-next/theme-next-pjax@0/pjax.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/velocity-animate@1/velocity.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/velocity-animate@1/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>

  <script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[data-pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.dataset.pjax !== undefined) {
      script.dataset.pjax = '';
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});
</script>




  
  <script data-pjax>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>




  
<script src="/js/local-search.js"></script>











<script data-pjax>
if (document.querySelectorAll('pre.mermaid').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js', () => {
    mermaid.initialize({
      theme    : 'forest',
      logLevel : 3,
      flowchart: { curve     : 'linear' },
      gantt    : { axisFormat: '%m/%d/%Y' },
      sequence : { actorMargin: 50 }
    });
  }, window.mermaid);
}
</script>


    <div id="pjax">
  

  

  <script id="cy_cmt_num" src="https://changyan.sohu.com/upload/plugins/plugins.list.count.js?clientId=cys44eS01"></script>


    </div>
</body>
</html>
